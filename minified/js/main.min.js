angular.module("starter.directives",[]).directive("rjHoldActive",["$ionicGesture","$timeout","$ionicBackdrop",function(e,t,i){return{scope:!1,restrict:"A",replace:!1,link:function(i,r,a,n){e.on("hold",function(){r.addClass("active"),t(function(){r.removeClass("active")},300)},r)}}}]).directive("rjCloseBackDrop",[function(){return{scope:!1,restrict:"A",replace:!1,link:function(e,t,i,r){var a=angular.element(document.querySelector("html"));a.on("click",function(t){"HTML"===t.target.nodeName&&e.popup.optionsPopup&&e.popup.isPopup&&(e.popup.optionsPopup.close(),e.popup.isPopup=!1)})}}}]).directive("resizeFootBar",["$ionicScrollDelegate",function(e){return{replace:!1,link:function(t,i,r,a){t.$on("taResize",function(t,r){if(r){var a=document.body.querySelector("#message-detail-content"),n=e.$getByHandle("messageDetailsScroll"),o=r[0].offsetHeight,s=o+10;s=s>44?s:44,i[0].style.height=s+"px",a.style.bottom=s+"px",n.scrollBottom()}})}}}]).directive("rjPositionMiddle",["$window",function(e){return{replace:!1,link:function(t,i,r,a){var n=e.innerHeight-44-49-i[0].offsetHeight;n>=0?i[0].style.top=n/2+44+"px":i[0].style.top="44px"}}}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="monospaced.elastic"),angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,i){"use strict";return{require:"ngModel",restrict:"A, C",link:function(r,a,n,o){function s(){var e=v;m=u,y=getComputedStyle(u),angular.forEach(U,function(t){e+=t+":"+y.getPropertyValue(t)+";"}),w.setAttribute("style",e)}function c(){var t,i,a,n,o;m!==u&&s(),f||(f=!0,w.value=u.value+g,w.style.overflowY=u.style.overflowY,t=""===u.style.height?"auto":parseInt(u.style.height,10),i=getComputedStyle(u).getPropertyValue("width"),"px"===i.substr(i.length-2,2)&&(n=parseInt(i,10)-x.width,w.style.width=n+"px"),a=w.scrollHeight,a>C?(a=C,o="scroll"):a<D&&(a=D),a+=x.height,u.style.overflowY=o||"hidden",t!==a&&(r.$emit("elastic:resize",d,t,a),u.style.height=a+"px"),r.$emit("taResize",d),e(function(){f=!1},1,!1))}function l(){f=!1,c()}var u=a[0],d=a;if("TEXTAREA"===u.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var p=u.value;u.value="",u.value=p;var m,f,g=n.msdElastic?n.msdElastic.replace(/\\n/g,"\n"):i.append,h=angular.element(t),v="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",b=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+v+'"/>').data("elastic",!0),w=b[0],y=getComputedStyle(u),I=y.getPropertyValue("resize"),k="border-box"===y.getPropertyValue("box-sizing")||"border-box"===y.getPropertyValue("-moz-box-sizing")||"border-box"===y.getPropertyValue("-webkit-box-sizing"),x=k?{width:parseInt(y.getPropertyValue("border-right-width"),10)+parseInt(y.getPropertyValue("padding-right"),10)+parseInt(y.getPropertyValue("padding-left"),10)+parseInt(y.getPropertyValue("border-left-width"),10),height:parseInt(y.getPropertyValue("border-top-width"),10)+parseInt(y.getPropertyValue("padding-top"),10)+parseInt(y.getPropertyValue("padding-bottom"),10)+parseInt(y.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},T=parseInt(y.getPropertyValue("min-height"),10),S=parseInt(y.getPropertyValue("height"),10),D=Math.max(T,S)-x.height,C=parseInt(y.getPropertyValue("max-height"),10),U=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(C=C&&C>0?C:9e4,w.parentNode!==document.body&&angular.element(document.body).append(w),d.css({resize:"none"===I||"vertical"===I?"none":"horizontal"}).data("elastic",!0),"onpropertychange"in u&&"oninput"in u?u.oninput=u.onkeyup=c:u.oninput=c,h.bind("resize",l),r.$watch(function(){return o.$modelValue},function(e){l()}),r.$on("elastic:adjust",function(){s(),l()}),e(c,0,!1),r.$on("$destroy",function(){b.remove(),h.unbind("resize",l)}))}}}}]),angular.module("starter.chatControllers",[]).controller("chat",function(e,t,i,r,a,n,o,s){n.fromTemplateUrl("button-options.html",{scope:e}).then(function(t){e.popover=t}),r.openPopover=function(t){e.popover.show(t)},e.friends=function(){i.go("tab.user-addressList")},e.markMessage=function(){var t=e.popup.index,i=e.messages[t];i.showHints?(i.showHints=!1,i.noReadMessages=0):(i.showHints=!0,i.noReadMessages=1),e.popup.optionsPopup.close(),e.popup.isPopup=!1,s.updateMessage(i)},e.deleteMessage=function(t,i){var i=e.messages.indexOf(t);alert(i),e.messages.splice(i,1),s.deleteMessageId(t.id,t.noReadMessages).then(function(e){})},e.topMessage=function(){var t=e.popup.index,i=e.messages[t];i.isTop?i.isTop=0:i.isTop=(new Date).getTime(),e.popup.optionsPopup.close(),e.popup.isPopup=!1,s.updateMessage(i)},e.messageDetils=function(e){r.messageBadge=r.messageBadge||0-e.noReadMessages||0,r.messageBadge<0&&(r.messageBadge=e.noReadMessages||0),t(function(){i.go("tab.message_detail",{messageId:e.id,noReadMessages:e.noReadMessages})},200)},e.$on("$ionicView.beforeEnter",function(){s.getAllMessages("toPerson").then(function(t){e.messages=t.data.messages}),e.popup={isPopup:!1,index:0}})}).controller("chatUserOtherInfo",function(e,t,i,r,a,n){i.userInfo={},n.getFellowInfo(r.id).then(function(e){i.userInfo=e.data||{}}),i.newsSend=function(){return i.userInfo.userId==window.userId?void alert("不能给自己发私信"):void a.getToPersonMessage(i.userInfo).then(function(r){i.messageDetails=r.data.message||[],e.checkUserAuthority()&&t.go("tab.message_detail",{messageId:r.data.id,isFromMe:r.data[window.userId]},!0)})}}).controller("chatNewCircle",function(e,t,i,r,a,n){n.getAllSysNotice("circleInvitation").then(function(t){e.circleInvitation=t.data}),e.agreeCircleInvitation=function(t,i,r){n.agreeCircleInvitation(i,1).then(function(i){200==i.status&&(e.circleInvitation[t].status=1),r.stopPropagation()})}}).controller("sysNoticeCtrl",["$rootScope","$scope","messageService","$q","$state",function(e,t,i,r,a){t.deleteSysNotice=function(e,r){var r=t.sysNotice.indexOf(e);t.sysNotice.splice(r,1);var a;e.status||(a=1),i.deleteSysNotice(e.id,a).then(function(e){})},t.dealWithNotice=function(r,n,o){if(1==r.status||r.status==-1)n.preventDefault();else switch(r.status||(i.updateASysNotice(r.id).then(),t.sysNotice[o].status=2,e.allSysNotice-=1),r.type){case"circleInvitation":a.go("tab.chat-newCircle");break;case"agreeCircleInvitation":break;case"applyCircle":a.go("tab.notice-circle-examineAndVerify",{id:r.circleId});break;case"userApplyFriend":a.go("tab.chat-newFriend");break;case"agreeFriendApply":break;case"applyActivity":a.go("tab.notice-user-examineAndVerify",{id:r.item.id,activityName:r.item.activityName});break;case"activityApplyVerify":break;case"startActivitySignIn":a.go("tab.chat-signUp-detailed",{id:r.activityId,source:"discover"});break;case"applyHire":console.log(r),a.go("tab.notice-candidatesUserInfo",{id:r.from.userId})}},i.getAllSysNotice().then(function(e){t.sysNotice=e.data,t.sysNotice.map(function(e){e.unread=e.status?"messageRead":"messageUnread"})})}]).controller("MessageDetailCtrl",["$rootScope","$interval","$scope","$stateParams","messageService","$ionicScrollDelegate","$timeout","pickPic","$q",function(e,t,i,r,a,n,o,s,c){function l(){console.log("done")}function u(){console.log("error")}function d(){console.log("每次都更新")}function p(e){var t=[];t[0]=e,s.upLoad(t,i.doSend)}function m(){a.refreshMessage(i.messageNum,r.messageId).then(function(e){i.calculateTime?"UM"!=e.data.statusUM&&(console.log(i.calculateTime),i.messageHead=e.data,i.messageHead.members.map(function(e){e.userId!=window.userId&&(i.message=e)}),i.messageDetails=e.data.message||[]):(i.messageHead=e.data,i.messageHead.members.map(function(e){e.userId!=window.userId&&(i.message=e)}),i.messageDetails=e.data.message||[]),i.calculateTime++})}i.messageNum=-10,i.calculateTime=0;var f=t(m,2e3);f.then(l,u,d),i.$on("$ionicView.leave",function(){f&&t.cancel(f)}),i.send_content={},i.send_content.text="";var g=n.$getByHandle("messageDetailsScroll");i.doRefresh=function(){i.messageNum-=5,a.refreshMessage(i.messageNum,r.messageId).then(function(e){i.messageHead=e.data,i.messageHead.members.map(function(e){e.userId!=window.userId&&(i.message=e)}),i.messageDetails=e.data.message||[],i.$broadcast("scroll.refreshComplete")})};var h={};i.addMulti=function(){s.getPic(h,p)},i.doSend=function(e){var t={};t.id=(new Date).getTime(),t.content=i.send_content,t.name=window.userInfo.nickname,t.face=window.userInfo.headUrl,t.isFromMe=i.message.isFromMe,t.pic=e.tsrc,t.time=new Date,t.praise=0,t.replycount=0,i.messageDetails.splice(i.messageDetails.length,0,t),a.pushToPersonMessage(t,i.message.id),i.send_content="",o(function(){m()},200)},i.$on("$ionicView.beforeEnter",function(){e.messageBadge=e.messageBadge||0-r.noReadMessages||0,e.messageBadge<0&&(e.messageBadge=0),i.message={},m(),o(function(){g.scrollBottom()},200)}),window.addEventListener("native.keyboardshow",function(e){g.scrollBottom()})}]),angular.module("starter.chatServices",[]).factory("dateService",[function(){return{handleMessageDate:function(e){var t=0,i=0,r={},a={},n=["周日","周一","周二","周三","周四","周五","周六"],o=0;if(!e)return console.log("messages is null"),null;for(a=this.getNowDate(),i=e.length,t=0;t<i;t++){if(r=this.getMessageDate(e[t]),!r)return null;a.year-r.year>0?e[t].lastMessage.time=r.year+"":a.month-r.month>=0||a.day-r.day>a.week?e[t].lastMessage.time=r.month+"月"+r.day+"日":a.day-r.day<=a.week&&a.day-r.day>1?(o=a.week-(a.day-r.day),e[t].lastMessage.time=n[o]):a.day-r.day!==1?a.day-r.day!==0||(e[t].lastMessage.time=r.hour+":"+r.minute):e[t].lastMessage.time="昨天"}},getNowDate:function(){var e={},t=new Date;return e.year=t.getFullYear(),e.month=t.getMonth(),e.day=t.getDate(),e.week=t.getDay(),e.hour=t.getHours(),e.minute=t.getMinutes(),e.second=t.getSeconds(),e},getMessageDate:function(e){var t={},i="",r=/(^\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{1,2}):(\d{1,2})/g,a=new Array;return e?(i=e.lastMessage.originalTime,(a=r.exec(i))?(t.year=parseInt(a[1]),t.month=parseInt(a[2]),t.day=parseInt(a[3]),t.hour=parseInt(a[4]),t.minute=parseInt(a[5]),t.second=parseInt(a[6]),t):(console.log("result is null"),null)):(console.log("message is null"),null)}}}]).factory("messageService",["$rootScope","DataHand","localStorageService","dateService",function(e,t,i,r){var a={};return a.init=function(){},a.deleteSysNotice=function(e,i){return t.Sdata("get","delete_sysNotice",{userId:userId,number:-1},{id:e})},a.agreeCircleInvitation=function(e,i){var r=e.from.userId;return t.Sdata("get","new_sysNotice",{type:"agreeCircleInvitation",from:{userId:window.userId,nickname:window.userInfo.nickname},to:{userId:r,nickname:""},time:new Date,message:window.userInfo.nickname+" 加入了圈子!"},{type:"agreeCircleInvitation","from.userId":window.userId,"to.userId":r}),t.Sdata("get","update_a_sysNotice",{status:i,type:"agreeCircleInvitation"},{id:e.id,userId:window.userId}),t.Sdata("get","add_circle_members",{"members.common":window.userId},{circleId:e.circleId})},a.updateASysNotice=function(e){return t.Sdata("get","update_a_sysNotice",{status:2},{id:e,userId:userId})},a.getAllMessages=function(e){return t.Sdata("get","get_all_pMessage",{},{userId:window.userId||"undefinedUserFromTina"})},a.getAllpSysNotice=function(e){return t.Sdata("get","get_all_psysNotice",{"sysNotice.$":1},{userId:window.userId||"undefinedUserFromTina","sysNotice.type":e})},a.getAllSysNotice=function(e){return t.Sdata("get","get_all_sysNotice",{},{"to.userId":window.userId||"undefinedUserFromTina",type:e})},a.deleteMessageId=function(e,i){isNaN(parseInt(i))?0:parseInt(i);return t.Sdata("get","update_message_delete",{"messages.$.status":"-1","messages.$.noReadMessages":0},{userId:window.userId,"messages.id":e,noReadMessages:i})},a.refreshMessage=function(e,i){return t.Sdata("get","refresh_message",{userId:window.userId,"messages.id":i},{id:i,num:e})},a.getToPersonMessage=function(e){return t.Sdata("get","get_toPerson_message",e,userInfo)},a.pushToPersonMessage=function(e,i){return t.Sdata("get","update_user_message",e,{userId:window.userId,id:i})},a}]),angular.module("starter.circleControllers",[]).controller("circle",function(e,t,i,r,a,n){t.checkLogin=function(){i.checkUserAuthority()&&e.go("tab.circle-addCircle",{id:"new"})},t.popover=r.fromTemplateUrl("templates/circle/my-popover.html",{scope:t}),r.fromTemplateUrl("templates/circle/my-popover.html",{scope:t}).then(function(e){t.popover=e}),t.onHold=function(e,i){document.body.classList.remove("platform-iOS"),document.body.classList.remove("platform-Android"),document.body.classList.add("platform-ios"),t.circleDataPreview=i,t.popover.show(e,i)},t.closePopover=function(){t.popover.hide()},t.$on("$destroy",function(){t.popover.remove()}),t.$on("popover.hidden",function(){}),t.$on("popover.removed",function(){}),i.pageMarking="circle",t.$on("$ionicView.beforeEnter",function(){n.getCircleIndexData().then(function(e){t.circleData=e.data,t.tmpData=e.data})}),t.searchData=[],t.circleUrl="#/tab/"+i.pageMarking+"-enterTheCircle",t.servicesSearch=function(e){n.getCircleIndexData(e).then(function(i){t.circles=i.data.myCircle.concat(i.data.hotCircle),t.circles.map(function(e,i){t.circles.map(function(i,r){e.title==i.title&&t.circles.splice(r,1)})}),e||(t.circles=[],t.circleData=t.tmpData)})}}).controller("myCircle",function(e,t,i){e.circles=[],e.title="我的圈子",e.circleUrl="#/tab/"+t.pageMarking+"-enterTheCircle",i.getMyCircle("myCircle").then(function(t){e.searchData=t.data,e.circles=t.data}),e.servicesSearch=function(t){i.getMyCircle("myCircle",t).then(function(i){e.circles=i.data,e.searchText=t,t||(e.circles=e.searchData)})}}).controller("hotCircle",function(e,t,i){e.circles=[],e.title="热门圈子",e.circleUrl="#/tab/circle-enterTheCircle",t.circleEphemeralData=t.circleEphemeralData||{};var r=t.circleMoreArea?t.circleMoreArea:void 0,a=t.circleEphemeralData["选择类型"]||[];i.getCircle("hotCircle",r,a).then(function(t){e.searchData=t.data,e.circles=t.data}),e.servicesSearch=function(t){i.getCircle("hotCircle",r,a,t).then(function(i){e.circles=i.data,e.searchText=t,t||(e.circles=e.searchData)})}}).controller("myParticipateCircle",function(e,t){e.circles=[],e.title="我加入的圈子",e.circleUrl="#/tab/circle-enterTheCircle",t.getParticipateCircle().then(function(t){e.searchData=t.data,e.circles=t.data}),e.servicesSearch=function(i){t.getParticipateCircle(i).then(function(t){e.circles=t.data,e.searchText=i,i||(e.circles=e.searchData)})}}).controller("circleUserInfo",function(e,t,i,r,a,n,o,s,c){c.getIssuerUserInfo(s.id).then(function(e){r.userInfo=e.data,r.info={id:r.userInfo.userId}},function(){a.alert({title:"信息获取失败",okText:"确认"})}),r.newsSend=function(){return r.userInfo.userId==window.userId?void alert("不能给自己发私信"):void t.getToPersonMessage(r.userInfo).then(function(t){r.messageDetails=t.data.message,e.checkUserAuthority()&&o.go("tab.member-message",{messageId:t.data.id,isFromMe:t.data[window.userId]},!0)})}}).controller("addCircle",function(e,t,i,r,a,n,o,s){t.data={},"new"!=r.id?n.getCircleInfo(r.id).then(function(e){i.correspondingKey(n.infoTransform,e.data,!0),a.circleEphemeralData=e.data instanceof Object?e.data:{},a.circleEphemeralData["圈子描述"]||(a.circleEphemeralData["圈子描述"]={}),a.circleEphemeralData["圈子海报"]?t.data=a.circleEphemeralData["圈子海报"]:a.circleEphemeralData["圈子海报"]=t.data}):(a.circleEphemeralData={},a.circleEphemeralData["圈子描述"]={},a.circleEphemeralData["圈子海报"]=t.data),t.publishCircle=function(){var e="";return a.circleEphemeralData["选择类型"]||(e+="没有选择类型<br>"),a.circleEphemeralData["圈子名称"]?a.circleEphemeralData["圈子名称"]=a.circleEphemeralData["圈子名称"].replace(/[\/]/g,"|"):e+="没有填写圈子名称<br>",a.circleEphemeralData["地区"]||(e+="没有填写圈子地区<br>"),e?(o.alert({title:"信息不完整",template:e,okText:"确认"}),!1):(n.publishCircleInfo(i.newObject(a.circleEphemeralData),r.id).then(function(){o.alert({title:"发布成功",okText:"确认"}),a.backClick(),i.delObj(a.circleEphemeralData)}),void console.log(a.circleEphemeralData))},i.bindNavTool({rightText:"保存",toolClick:function(){n.saveCircleRough(i.newObject(a.circleEphemeralData)).then(function(e){o.alert({title:"保存成功",okText:"确认"})})}},t)}).controller("circleSelectType",function(e,t,i,r){e.title="选择圈子类型",e.selectTypeText="选择类型";var a="选择类型";e.selectData=i.circleEphemeralData[a]||[],e.elementShow={},e.maxSurplus=2;var n=t.circleSelectType();n.success(function(t){e.typeDatas=t}),r.bindNavTool({rightText:"保存",toolClick:function(){i.circleEphemeralData[a]=e.selectData,i.backClick()}},e)}).controller("circleTermsForEntry",function(e,t,i){e.title="加入条件",e.heardTitle="加入条件设置",i.circleEphemeralData["加入条件"]?e.lists=i.circleEphemeralData["加入条件"]:e.lists=[{icon:"ion-person",text:"姓名",checkBox:!0},{icon:"ion-iphone",text:"手机",checkBox:!0},{icon:"ion-android-happy",text:"公司"},{icon:"ion-android-happy",text:"邮箱"},{icon:"ion-android-happy",text:"是否需要上传认证"}];var r="加入条件";t.bindNavTool({rightText:"保存",toolClick:function(){i.circleEphemeralData[r]=e.lists,i.backClick()}},e)}).controller("circleEnterTheCircle",function(e,t,i,r,a,t,n,o,s,c,l,u,d){console.log(n),a.initImagesRand=function(){var e=["./img/init/background_02.png","./img/init/background_04.png","./img/init/background_05.png","./img/init/background_06.png"];return e[Math.floor(Math.random()*e.length)]},e.fromTemplateUrl("./templates/circle/circle-noticeDetail.html",{scope:a,animation:"slide-in-up",backdropClickToClose:!1}).then(function(e){a.modal=e}),a.showNotice=function(e){a.modal.show(),console.log(e),a.noticeDetail=e},a.deleteNotice=function(e){a.nowData.splice(a.nowData.indexOf(e),1),l.deleteNotice(n.id,e.id).then(function(e){})},a.initImageUrl=a.initImagesRand(),window.$ionicNavBarDelegate=s,a.id=n.id,a.circleId=n.id,a.circleName=n.name,r.circleStateParams=n,a.nowData=[],r.closeCricleLayerShow=!1,l.getCircleHeard(a.id).then(function(e){a.heardData=e.data,window.userInfo.userId==a.heardData.userId,a.navRightIonicClass="ion-more size-24",a.toolClick=function(){t.go("tab."+r.pageMarking+"-manage",{name:n.name,id:n.id})},d.update()});var p;a.heardClick=function(e){a.heardIndex=e,a.allDataEnd=!1;var t,i;switch(e){case 0:t=l.getNoticePage,a.tmpUrl="./templates/circle/circle-noticePage-tmp.html",i="notice";break;case 1:t=l.getDynamicState,a.tmpUrl="./templates/discover/discover-cateforyTab-information-tmp.html",i="information";break;case 2:t=l.getCircleActivity,a.tmpUrl="./templates/discover/discover-cateforyTab-activity-tmp.html",i="activity";break;case 3:t=l.getCircleToHire,a.tmpUrl="./templates/discover/discover-cateforyTab-toHire-tmp.html",i="hire";break;case 4:t=l.getCircleInvestigate,a.tmpUrl="./templates/discover/discover-cateforyTab-investigate-tmp.html",i="investigate"}(p=function(e){t(n.id,e).then(function(e){a.nowData=e.data[i]||e.data,console.log(i,a.nowData),console.log(e.data),console.log(a.nowData),a.allDataEnd=!0,a.$broadcast("scroll.infiniteScrollComplete")},function(){})})(0)},a.heardClick(0),a.loadMore=function(){a.nowData&&(p?p(a.nowData.length):u(function(){a.$broadcast("scroll.infiniteScrollComplete"),a.allDataEnd=!0},1e3))},a.entrPublish=function(){r.publishLayerEs=!1,a.closeCricleLayer=!1},a.closeCircleLayer=function(){a.closeCricleLayer=!a.closeCricleLayer,r.publishLayerEs=a.closeCricleLayer},a.circleName=n.name,a.id=n.id,c.bindNavTool({navRightIonicClass:"ion-more size-24",toolClick:function(){t.go("tab."+r.pageMarking+"-manage",{name:n.name,id:n.id})}},a),a.$on("$ionicView.beforeEnter",function(){})}).controller("circleCircleMembers",function(e,t,i,r){e.id=r.id,console.log(r.id),i.getCircleMembers(r.id).then(function(t){e.membersData=t.data})}).controller("circleMember",function(e,t,i,r,a,n,o,s){t.show={part:1},console.log(a.id),r.getAllMember(a.id).then(function(e){var i=e.data.members.authority,r=e.data.members.common,a=i.length||0,n=r.length||0;t.manager=0,t.isMember=0;for(var o=0;o<a;o++)if(i[o].userId==window.userId){t.manager=1;break}for(var o=0;o<n;o++)if(r[o].userId==window.userId){t.isMember=1;break}t.allUser=e.data.members,t.creator=e.data.userId,t.searchData=t.allUser.authority.concat(t.allUser.common),t.searchMarking="nickname"}),t.unsetManager=function(i,n){r.unsetManager(a.id,n.userId).then(function(r){200==r.status?(e.alert({title:"设置成功",okText:"确认"}),t.allUser.authority.splice(i,1)):e.alert({title:"设置失败",okText:"确认"})})},t.deleteMember=function(i,n){var o=e.confirm({title:"确认删除?",template:"确认要删除该成员?",buttons:[{text:"取消",onTap:function(e){return"cancle"}},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){return"yes"}}]});o.then(function(o){"cancle"==o||r.deleteMember(a.id,n.userId).then(function(r){200==r.status?(e.alert({title:"删除成功",okText:"确认"}),t.allUser.common.splice(i,1)):e.alert({title:"删除失败",okText:"确认"})})})},t.setManager=function(i){r.setManager(a.id,i.userId).then(function(r){200==r.status?(e.alert({title:"设置成功",okText:"确认"}),t.allUser.authority.splice(0,0,i)):e.alert({title:"设置失败",okText:"确认"})})}}).controller("circleAddressList",function(e,t,i,r,a,n,o,s){t.info={},t.userFriends={},t.allUsers={},s.fromTemplateUrl("./templates/circle/circle-hailFellow.html",{scope:t,animation:"slide-in-up",backdropClickToClose:!1}).then(function(e){t.modal=e}),t.searchMarking="nickname",t.searchData=[],i.getFriends().then(function(e){t.userFriends=e.data;for(var i in t.userFriends)t.searchData=t.searchData.concat(t.userFriends[i])}),t.inviteMany=function(){var r=[];t.userFriends.map(function(e){if(e.checked){var t={};t.userId=e.userId,t.nickname=e.nickname,r.push(t)}}),i.inviteMany({circleId:e.id,circleName:e.name},r).then(function(e){200==e.status?a.alert({title:"邀请发送成功",okText:"确认"}):a.alert({title:"发送失败",okText:"确认"})})},t.searchCallBack=function(e){i.getAllUser(e).then(function(e){console.log(e.data),t.userList=e.data})},t.inviteToCircle=function(t){t.originalObject&&(t=t.originalObject),i.sendNotification({circleId:e.id,circleName:e.name},t).then(function(e){e?a.alert({title:"发送成功",subTitle:"请等待对方确认",okText:"确认"}):a.alert({title:"发送失败",subTitle:"请重新添加",okText:"确认"})})},i.getFriendsUrl instanceof Function&&i.getFriendsUrl().then(function(e){t.lists=e.data}),r.bindNavTool({navRightIonicClass:"icon ion-person-add",toolClick:function(){t.modal.show(),i.getAllUser().then(function(e){t.userList=e.data})}},t);var c=i.getFriends();c.then(function(e){t.userFriends=e.data},function(){}),t.deleteFriend=function(e){var r=i.deleteFriend(e.userId);r.then(function(){a.alert({title:"删除成功",okText:"确认"});var i=t.userFriends;i.splice(i.indexOf(e),1)},function(){a.alert({title:"删除失败",okText:"确认"})})},t.defriend=function(e){i.defriend(e.userId).then(function(i){a.alert({title:"拉黑成功",okText:"确认"});var r=t.userFriends;r.splice(r.indexOf(e),1)})}}).controller("circleSelectContacts",function(e,t,i){e.searchMarking="nickname",e.searchData=[],i.getFriends().then(function(t){e.userFriends=t.data;for(var i in e.userFriends)e.searchData=e.searchData.concat(e.userFriends[i])}),e.checkBox={}}).controller("circleNotice",function(e,t,i,r,a,n,o){t.notice="",t.noticeTitle="",t.submit=function(){!t.notice&&t.noticeTitle&&o.alert({title:"请输入标题和通知内容",okText:"确认"}),a.subNotice(r.id,{notice:t.notice,noticeTitle:t.noticeTitle,time:new Date}).then(function(){t.notice="",t.noticeTitle="",o.alert({title:"成功",okText:"确认"}),e.goBack(-2)})}}).controller("circleReport",function(e,t,i,r,a){t.submit=function(){i.submitReport(r.id,t.phone,t.text).then(function(){a.alert({title:"成功",okText:"确认"})})}}).controller("circleNoticePage",function(e,t,i,r){e.notice=[],i.getNotice(r.id).then(function(t){e.notice=t.data})}).controller("circleActivity",function(e,t,i){i.getCircleActivity().then(function(t){e.nowData=t.activity})}).controller("circleChat",function(e,t,i,r){e.heard={rightText:"",leftText:"返回",title:i.name,toolClick:function(){r.go("tab."+t.pageMarking+"-circleMembers",{id:i.id})}}}).controller("circleManage",function(e,t,i,r,a,n){n.getAllMember(a.id).then(function(e){var t=e.data.members.authority,i=e.data.members.common,a=t.length||0,n=i.length||0;r.manager=0,r.isMember=0;for(var o=0;o<a;o++)if(t[o].userId==window.userId){r.manager=1;break}for(var o=0;o<n;o++)if(i[o].userId==window.userId){r.isMember=1;break}}),r.leaveCircle=function(){var t=i.confirm({title:"确认退出?",template:"确认要退出该圈子?",buttons:[{text:"取消",onTap:function(e){return"cancle"}},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){return"yes"}}]});t.then(function(t){"cancle"==t||n.leaveCircle(a.id).then(function(t){e.go("tab.circle-index")})})},r.deleteCircle=function(){var t=i.confirm({title:"确认删除?",template:"确认要删除该圈子?",buttons:[{text:"取消",onTap:function(e){return"cancle"}},{text:"<b>确认</b>",type:"button-positive",onTap:function(e){return"yes"}}]});t.then(function(t){"cancle"==t||(console.log("Yes"),n.deleteCircle(a.id).then(function(t){e.go("tab.circle-index")}))})},r.changeRole=function(e,t){},r.id=a.id,r.name=a.name}).controller("circleExamineAndVerify",function(e,t,i){e.heardClick=function(r){e.heardIndex=r,e.lists=[],i.getExamineAndVerify(t.id,r).then(function(t){e.lists=t},function(){})},e.heardClick(0),e.agree=function(e){i.ask("1",e.userId,e.nickname,t.id).then(function(){e.text="已同意"})},e.refuse=function(e){i.ask("-1",e.userId,e.nickname,t.id).then(function(){e.text="已拒绝"})}}).controller("circleAddAContact",function(e,t,i,r,a,n,o,s){a.id=o.id,a.name=o.name,a.info={},a.shareWeChatFriend=function(){t.sharelink(0,"才商连联","您的好友:"+window.userInfo.nickname+"邀请您加入圈子"+a.name,window.company.logo,window.baseUrl.url+"#/tab/circle-addCircleInput/"+a.id)},a.shareWeChatFriendCircle=function(){t.sharelink(1,"才商连联","您的好友:"+window.userInfo.nickname+"邀请您加入圈子"+a.name,window.company.logo,window.baseUrl.url+"#/tab/circle-addCircleInput/"+a.id)},a.addFriends=function(){n.show({title:"添加好友",scope:a,template:"<div class='promptText' style='display: block'><p style='border:1px solid #bfbfbf;border-radius: 5px;box-sizing:border-box;height: 24px;line-height: 24px;padding:0 5px;'><input class='init' ng-model='info.id' placeholder='请输入账号和昵称' style='height: 24px'></p><p style='border:1px solid #bfbfbf;border-radius: 5px;box-sizing: border-box;height: 48px;margin-top: 10px;padding: 5px;'><textarea ng-model='info.extraMessage' maxlength='20'  placeholder='请输入不超过20字的附加信息'  class='init'></textarea></p></div>",buttons:[{text:"添加好友",type:"button-positive",onTap:function(e){var t=s.addFriends(a.info,o.id);t&&t.then(function(e){+e.data.result?n.alert({title:"请求发送成功",okText:"确认"}):n.alert({title:"没有找到该用户",subTitle:"请重新添加",okText:"确认"})},function(){n.alert({title:"请求发送失败",okText:"确认"})}),a.info={}}},{text:"取消",type:"button-default",onTap:function(e){a.info={}}}]})}}).controller("circleAddCircleInput",function(e,t,i,r,i,a,n,o,s,c,l,u){function d(e,t){a.myURL="",a.Snumber="";for(var n=0;n<6;n++)a.Snumber+=Math.floor(10*Math.random());var o="http://106.ihuyi.cn/webservice/sms.php?method=Submit&account=cf_zhongwei&password=amec123456&mobile="+t+"&content=您的验证码是：【"+a.Snumber+"】。请不要把验证码泄露给其他人。";a.myURL=r.trustAsResourceUrl(o),a.wait=60,a.time=function(){return 0==a.wait?void(a.obj.resend=!0):(a.wait--,void i(function(){a.time()},1e3))},a.time()}function p(t){return a.Snumber==t&&a.Snumber>"0"||void e.showAlert("验证码错误","您输入的短信验证码有误，请检查。")}a.registrationAdditional=[],a.userInfo=window.userInfo||{},a.sverifyHide=0,a.verifyShow=0,a.verifyNumber="",a.data={},s.getCircleInput(u.id).then(function(e){a.registrationAdditional=e.data instanceof Array?e.data:[],a.registrationAdditional.map(function(e){"是否需要上传认证"==e.text&&(e.value={images:[]},a.data=e.value)})},function(){}),a.initData=function(e){"姓名"==e.text&&(e.value=userInfo.nickname),"手机"==e.text&&(e.value=userInfo.phone,e.value&&(a.phoneDisable="disabled",a.sverifyHide=1,a.checkPass=1))},a.sendMS=function(e){a.userInfo.phone=e,a.phoneDisable="disabled",a.sverifyHide=1,a.verifyShow=1,d(3,e)};var m;a.checkPass=0,a.checkVerify=function(e){i.cancel(m),m=i(function(){var t=p(e);t&&(a.checkPass=1,a.registrationAdditional.map(function(e){"姓名"==e.text&&(a.userInfo.nickname=e.value),"手机"==e.text&&(a.userInfo.phone=e.value)}))},1e3)},a.submitSignUp=function(){var e="";return a.registrationAdditional.map(function(t){a.checkPass||(e+="请验证手机号码<br>"),"是否需要上传认证"!=t.text?t.value||(e+=t.text+"信息未填写<br>"):t.value.images[0]||(e+="未上传证件<br>"),"姓名"==t.text&&(a.userInfo.nickname=t.value),"手机"==t.text&&(a.userInfo.phone=t.value)}),e?(c.alert({title:"信息未填写",template:e,okText:"确认"}),!1):void s.checkAddUser(a.userInfo).then(function(e){a.userInfo=e.data,s.submitCircleInput(a.userInfo,u.id,a.registrationAdditional,a.data.images).then(function(){c.alert({title:"提交成功",okText:"确认"}),n.backView()?l.backClick():o.go("tab.discover-index")},function(){c.alert({title:"提交失败",okText:"确认"})})})}}).controller("circleMessage",function(e,t,i,r,a,n,o,s){function c(){console.log("done")}function l(){console.log("error")}function u(){console.log("每次都更新")}function d(e){var t=[];t[0]=e,s.upLoad(t,i.doSend)}function p(){n.getMessage(i.messageNum,a.id).then(function(e){i.circle.messages=e.data.messages})}i.messageNum=-10;var m=t(p,7e3);m.then(c,l,u),i.$on("$ionicView.leave",function(){t.cancel(m),console.log(m)}),e(function(){o.$getByHandle("messageDetailsScroll").scrollBottom()},200),i.circle={},i.circle.messages={},i.circle.messages.data=[];var f={};p(),i.addMulti=function(){s.getPic(f,d)},i.doRefresh=function(){i.messageNum-=5,n.getMessage(i.messageNum,a.messageId).then(function(e){i.messages=e.data.messages||[],i.$broadcast("scroll.refreshComplete")})},i.doSend=function(t){var r={};r.id=(new Date).getTime(),r.content=i.send_content,r.name=window.userInfo.nickname,r.img=window.userInfo.headUrl,r.pic=t.tsrc,r.time=new Date,r.praise=0,r.replycount=0,i.circle.messages.splice(i.circle.messages.length,0,{data:r}),n.pushMessage(r,a.id),e(function(){p()},200),e(function(){o.$getByHandle("messageDetailsScroll").scrollBottom()},200),i.send_content=""}}).controller("circleSelectArea",function(e,t,i,r,a){a.circleEphemeralData=a.circleEphemeralData?a.circleEphemeralData:{},e.config=t.selectTmpServices.config.area,e.selectData=a.circleEphemeralData["地区"]?[a.circleEphemeralData["地区"]]:[],e.maxSurplus=1,r.bindNavTool({rightText:"保存",toolClick:function(){var t;e.selectData.length?(t=e.selectData[0].city+"-"+e.selectData[0].county,a.circleEphemeralData["地区"]=e.selectData[0].city+"-"+e.selectData[0].county):(t=null,a.circleEphemeralData["地区"]=t),a.circleMoreArea=t,a.backClick()}},e)}),angular.module("starter.circleServices",[]).factory("circleServices",function(e,t,i,r,a,n){var o={};return o.infoTransform={"加入条件":"requirement","圈子名称":"title","地区":"area","圈子描述":"describe","圈子海报":"photoUrl","选择类型":"type","是否公开":"open"},o.checkAddUser=function(e){return a.Sdata("get","check_add_user",e,{phone:e.phone})},o.circleSelectType=function(){return i.httpGet("./data/circleSelectTypeData.json")},o.applyCircle=function(e,t,i){var r=window.userInfo;return r.notice=e,r.status="0",a.Sdata("get","apply_circle",r,{circleId:t})},o.deleteNotice=function(e,t){return a.Sdata("get","unset_circle_manager",{notice:{id:t}},{circleId:e})},o.getCircleInfo=function(e){return a.Sdata("get","get_circle_edit",{area:1,requirement:1,title:1,describe:1,photoUrl:1,type:1,open:1,_id:0},{circleId:e})},o.deleteCircle=function(e){return a.Sdata("get","delete_circle",{},{circleId:e})},o.leaveCircle=function(e){return a.Sdata("get","leave_circle",{},{circleId:e,userId:window.userId})},o.pushMessage=function(e,t){return a.Sdata("get","update_circle_rRecord",{type:"messages",data:e},{circleId:t})},o.getMessage=function(e,t){return a.Sdata("get","get_circle_items",{messages:{$slice:e}},{circleId:t})},o.getCircleIndexData=function(e){return a.Sdata("get","get_circle_index",{},{draflag:"1",userId:window.userId||"notexist",title:{$regex:e?e:"",$options:"i"}})},o.searchCircle=function(e,t){function i(t,i){return a.Sdata("get","get_circle_index",{},{draflag:"1",userId:window.userId||"notexist",title:{$regex:e?e:"",
$options:"i"}}).then(function(e){var r;return r=i?e:e.data[t]})}switch(t){case"my":return i("myCircle");case"hot":return i("hotCircle");case"all":return i("myCircle","hotCircle")}},o.saveCircleRough=function(e){return i.correspondingKey(o.infoTransform,e),t.upLoad(e.photoUrl||e.images||[]),e?(e.draflag="0",e.userId=window.userId,e.creator=window.userInfo,a.Sdata("get","add_circle",e,{})):{error:"Empty Input!"}},o.publishCircleInfo=function(e,r){return i.correspondingKey(o.infoTransform,e),t.upLoad(e.photoUrl||e.photoUrl.images||[]),e.userId=window.userId,e.creator=window.userInfo,"new"==r?(e.draflag="1",a.Sdata("get","add_circle",e,{})):a.Sdata("get","update_circle_item",e,{circleId:r})},o.getCircle=function(e,t,i,r){var n={draflag:"1",userId:userId,title:{$regex:r?r:"",$options:"i"}};if(i&&i.length&&(n.type={$in:i}),t){var t=t.split("-")[0];n.area={$regex:t,$options:"i"}}return a.Sdata("get","get_circle",{type:e},n)},o.getMyCircle=function(e,t){return a.Sdata("get","get_circle",{type:e},{draflag:"1",userId:userId,title:{$regex:t?t:"",$options:"i"}})},o.getParticipateCircle=function(e){return a.Sdata("get","get_participate_circle",{},{draflag:"1",userId:userId,title:{$regex:e?e:"",$options:"i"}})},o.getCircleActivity=function(e,t){return a.Sdata("get","get_circle_item",{type:"activities"},{circleId:e})},o.getCircleMembers=function(e,t){return a.Sdata("get","get_circle_members",{members:1,"describe.text":1},{circleId:e})},o.getAllMember=function(e,t){return a.Sdata("get","get_circle_members",{members:1},{circleId:e})},o.subNotice=function(e,t){return a.Sdata("get","update_circle_rRecord",{type:"notice",data:t,userId:window.userId,creator:window.userInfo},{circleId:e})},o.getDynamicState=function(e){return a.Sdata("get","get_circle_item",{type:"informations"},{circleId:e})},o.getCircleToHire=function(e){return a.Sdata("get","get_circle_item",{type:"hires"},{circleId:e})},o.getCircleInvestigate=function(e){return a.Sdata("get","get_circle_item",{type:"investigations"},{circleId:e})},o.getCircleHeard=function(t){return e.isMembers=0,a.Sdata("get","get_circle_items",{members:1,userId:1,circleId:1,photoUrl:1,introduction:1,title:1},{circleId:t}).then(function(t){if(console.log("res:",t),t&&t.data.members){var i=t.data.members.common||[];console.log(" members:",i),i.map(function(t){t.userId!=window.userId&&t!=window.userId||(e.isMembers=1)})}return t})},o.getExamineAndVerify=function(e,t){function i(t){var i=[];return a.Sdata("get","get_circle_items",{applicant:1},{circleId:e}).then(function(e){for(var r=e.data.applicant,a=r.length||0,n=0;n<a;n++)r[n].status==t&&i.push(r[n]);return i})}switch(t){case 0:return i("0");case 1:return i("-1");case 2:return i("-2")}},o.ask=function(e,t,i,r,n){return a.Sdata("get","add_circle_members",{"members.common":t},{circleId:r}),a.Sdata("get","new_sysNotice",{type:"circleApplyVerify",circleId:r,from:{userId:window.userId,nickname:window.userInfo.nickname},to:{userId:t,nickname:i},time:new Date,message:"圈子管理员:"+window.userInfo.nickname+(e?"同意":"拒绝")+" 你的申请!"},{type:"circleApplyVerify",circleId:r,"from.userId":window.userId,"to.userId":t}),a.Sdata("get","update_a_sysNotice",{status:e,type:"agreeCircleApply"},{id:t,userId:window.userId}),a.Sdata("get","update_circle_item",{"applicant.$.status":e},{circleId:r,"applicant.userId":t})},o.setManager=function(e,t){return a.Sdata("get","update_circle_members",{"members.authority":t},{circleId:e})},o.unsetManager=function(e,t){return a.Sdata("get","unset_circle_manager",{"members.authority":t},{circleId:e})},o.deleteMember=function(e,t){return a.Sdata("get","unset_circle_manager",{"members.common":t},{circleId:e})},o.addFriends=function(e,t){return a.Sdata("get","find_add_circle_member",{"members.common":e.id},{circleId:t})},o.getNoticePage=function(e){return a.Sdata("get","get_circle_items",{notice:1},{circleId:e})},o.getCircleInput=function(e){return a.Sdata("get","get_circle_items",{requirement:1},{circleId:e}).then(function(e){var t=e.data.requirement||[],i=[];return t.map(function(e){e.checkBox&&i.push(e)}),e.data=i,e})},o.submitCircleInput=function(e,i,r,n){if(n){var o=angular.copy(n);t.upLoad(o||[]),n.map(function(e){e.src=e.tsrc}),r.map(function(e){"是否需要上传验证"==e.text&&(e.value.images=n)})}var s={};return s.registrationAdditional=r,s.userId=e.userId,s.nickname=e.nickname,s.headUrl=e.headUrl,s.status="0",a.Sdata("get","new_circle_sysNotice",{type:"applyCircle",circleId:i,to:{userId:""},from:{userId:s.userId,nickname:s.nickname},time:new Date,message:s.nickname+" apply to join circle!"},{type:"applyCircle",circleId:i,"from.userId":s.userId}),a.Sdata("get","apply_circle",s,{circleId:i})},o}),angular.module("starter.discoverControllers",[]).controller("discover",function(e,t,i,r,a){t.pageMarking="discover",e.heardPhoto=["./img/banner/banner_background_1.png","./img/banner/banner_background_2.png","./img/banner/banner_background_3.png"],e.doRefresh=function(){var t=i.getDiscoverIndexData();e.discoverData=!1,t.then(function(t){e.$broadcast("scroll.refreshComplete"),e.discoverData=t.data,a.update()},function(){e.$broadcast("scroll.refreshComplete")})},e.$on("$ionicView.beforeEnter",function(){e.doRefresh()})}).controller("activityApplyVerify",function(e,t,i){e.heardClick=function(r){e.heardIndex=r,e.lists=[],i.getExamineAndVerify(t.id,r).then(function(t){t.data.signUpRecord.map(function(e){e.status&&(e.text="1"==e.status?"已同意":"已拒绝")}),e.lists=t.data.signUpRecord},function(){})},e.heardClick(0),e.agree=function(e){i.ask("1",t.id,e.userId).then(function(){e.text="已同意"})},e.refuse=function(e){i.ask("-1",t.id,e.userId).then(function(){e.text="已拒绝"})}}).controller("discoverActivity",function(e,t,i,r,a,n){e.activityEphemeralData=e.activityEphemeralData?e.activityEphemeralData:{},t.$watch("activityMoreArea",function(i,r){n.getAllActivities(i,e.activityEphemeralData["选择类型"]||[]).then(function(e){200==e.status&&(t.activities=e.data)})}),t.$watch("activityEphemeralData['选择类型']",function(i,r){var a=e.activityMoreArea?e.activityMoreArea:void 0;n.getAllActivities(a,i).then(function(e){200==e.status&&(t.activities=e.data)})},!0)}).controller("discoverSpecialist",function(e,t,i,r,a){i.title="擅长技能",i.selectTypeText="选择技能",i.selectData=[],i.typeDatas=[],i.maxSurplus=3;var n=t.getBeGoodAt();n.then(function(e){i.typeDatas=e.data}),r.bindNavTool({rightText:"下一步",toolClick:function(){a.searchSpecilist=i.selectData,e.go("tab.discover-addressList")}},i)}).controller("discoverAddressList",function(e,t,i,r,a,n,o,s,c){i.info={},i.userFriends={},i.allUsers={},e.searchSpecialist(o.searchSpecilist).then(function(e){console.log(e.data),i.userFriends=e.data}),c.fromTemplateUrl("./templates/user/user-hailFellow.html",{scope:i,animation:"slide-in-up",backdropClickToClose:!1}).then(function(e){i.modal=e}),i.searchMarking="nickname",i.searchData=[],i.searchCallBack=function(e){r.getAllUser(e).then(function(e){i.userList=e.data})}}).controller("discoverSelectArea",function(e,t,i,r,a,n,o,s){e.config=t.selectTmpServices.config.area,e.selectData=[],e.maxSurplus=1,r.bindNavTool({rightText:"保存",toolClick:function(){var t;t=e.selectData.length?e.selectData[0].city+"-"+e.selectData[0].county:null,i.activityMoreArea=t,i.backClick()}},e)}).controller("discoverSignUpDetailed",function(e,t,i,r,a,n,o,s,c,l,u,d,p,m,f){function g(){o.activityEphemeralData?c.delObj(o.activityEphemeralData):(o.activityEphemeralData={},s.data={},o.activityEphemeralData["活动详情"]=s.data)}function h(t){e.fromTemplateUrl(t,{scope:s,animation:"slide-in-up"}).then(function(e){s.modal=e,s.modal.show()})}var v;s.$on("$ionicView.beforeEnter",function(){p.parev_$scope=s;var e=p.getItemActivityDetailed(s.id,l.source);e.then(function(e){e.data;v=angular.copy(l),s.signUpDetailed=e.data,v.activityName=s.signUpDetailed.title,v.creatorId=s.signUpDetailed.creator.userId,s.signUpDetailed.eventDetails.images=e.data.images,s.map={},s.map.address=s.signUpDetailed.address||s.signUpDetailed.location,m.update(),o.__partake||"user"==o.pageMarking&&window.userInfo.userId==e.data.userId&&c.bindNavTool({navRightIonicClass:"ion-more size-24",toolClick:function(){console.log(i),i.hide=i.show({buttons:[{text:"编辑页面"},{text:"查看报名"},{text:"查看签到"},{text:"查看评价"}],titleText:"选择需要的操作",destructiveText:"删除活动",cancelText:"取消",buttonClicked:function(e){switch(e){case 0:l.source=o.pageMarking,d.go("tab."+o.pageMarking+"-activity",l);break;case 1:d.go("tab."+o.pageMarking+"-examineAndVerify",{id:l.id,activityName:v.activityName});break;case 2:d.go("tab."+o.pageMarking+"-signIn",{id:l.id});break;case 3:d.go("tab."+o.pageMarking+"-evaluate",{id:l.id})}i.hide()},destructiveButtonClicked:function(){i.hide(),r.show({title:"确认删除",buttons:[{text:"确认",onTap:function(e){f.delActivity(l).then(function(){r.alert({title:"删除成功",okText:"确认"}),o.backClick()})}},{text:"取消",type:"button-positive"}]})}})}},s)},function(){g()})}),s.location=function(){h("templates/modal/mapModal.html"),s.mapIni()},s.mapIni=function(){t.map(s)},s.closeModal=function(){s.modal.remove()},s.id=l.id,s.initUrl="./img/banner/banner_background_1.png";o.prevNavText;s.signIn=function(){p.activitySignIn(s.id,l.source).then(function(){r.alert({title:"签到成功",okText:"确认"}),s.signUpDetailed.alreadySignIn=1},function(){r.alert({title:"签到失败",okText:"确认"})})},s.isUser=window.userInfo&&window.userInfo.userId,s.activitySignUp=function(){o.checkUserAuthority()&&d.go("tab."+o.pageMarking+"-signUp-input",v)}}).controller("discoverSignUpInput",function(e,t,i,r,a,n){e.registrationAdditional=[],e.userInfo=window.userInfo,n.getRegistrationAdditional(r.id).then(function(t){e.registrationAdditional=t.data instanceof Array?t.data:[]},function(){}),e.initData=function(e){"姓名"==e.text?e.value=userInfo.nickname:"","手机"==e.text?e.value=userInfo.phone:""},e.submitSignUp=function(){var i="";return e.registrationAdditional.map(function(e){e.value||(i+=e.text+"信息未填写<br>")}),i?(a.alert({title:"信息未填写",template:i,okText:"确认"}),!1):void n.submitSignUp(r,e.registrationAdditional).then(function(){a.alert({title:"提交成功",okText:"确认"}),t.backClick()},function(){a.alert({title:"提交失败",okText:"确认"})})}}).controller("discoverActivityEvaluation",function(e,t,i,r,a){e.giveLessonsIndex=0,e.activityIndex=0,e.evaluationData=function(){var e=t.parev_$scope.signUpDetailed,i={activity:[],giveLessons:[]};e.activitySatisfaction=e.activitySatisfaction||[],e.courseSatisfaction=e.courseSatisfaction||[];try{e.activitySatisfaction.map(function(e){e.checkBox&&i.activity.push(e)}),e.courseSatisfaction.map(function(e){e.checkBox&&i.giveLessons.push(e)})}catch(r){console.log(r)}return i}(),console.log(e.evaluationData),e.submitEvaluation=function(){t.submitEvaluation(i.id,e.evaluationData).then(function(){a.alert({title:"提交成功",okText:"确认"}),t.parev_$scope.signUpDetailed.alreadyEvaluate=1,r.backClick()},function(){a.alert({title:"提交失败",okText:"确认"})})}}).controller("discoverToHireMore",function(e,t,i,r,a){t.servicesSearch=function(e,i){r.searchHire(e).then(function(e){t.nowData=e.data,i.searchData=e.data})},t.url="tab.discover-toHire-more",t.getData=function(e){r.getToHireMore(a.id,e).then(function(e){t.nowData=e.data,t.searchData=e.data})};var n="";t.$on("$ionicView.beforeEnter",function(){r.parev_$scope=t,t.getData(n)})}).controller("discoverToHireDetailed",function(e,t,i,r,a,n,o,s,c,l){l.getItemToHireDetailed(o.id,o.source).then(function(i){n.toHireDetailed=i.data,n.id=n.toHireDetailed.userId,t.__partake||"user"==t.pageMarking&&window.userInfo.userId==i.data.userId&&s.bindNavTool({navRightIonicClass:"ion-more size-24",toolClick:function(){e.hide=e.show({buttons:[{text:"编辑页面"},{text:"查看应聘人"}],titleText:"选择需要的操作",destructiveText:"删除才聘",cancelText:"取消",buttonClicked:function(i){switch(i){case 0:o.source=t.pageMarking,a.go("tab."+t.pageMarking+"-toHire",o);break;case 1:t.ephemeralData=n.toHireDetailed,t.ephemeralData.swap=!0,a.go("tab."+t.pageMarking+"-candidates",o)}e.hide()},destructiveButtonClicked:function(){e.hide(),c.show({title:"确认删除",buttons:[{text:"确认",onTap:function(i){r.delToHire(o).then(function(){c.alert({title:"删除成功",okText:"确认"}),t.backClick()}),e.hide()}},{text:"取消",type:"button-positive"}]})}})}},n)}),n.acceptAnOfferOfEmployment=function(){window.userId?l.acceptAnOfferOfEmployment(o.id,n.toHireDetailed.jobDescription,n.toHireDetailed.creator).then(function(){n.toHireDetailed.alreadyApply=!0,c.alert({title:"应聘成功",okText:"确认"})},function(){c.alert({title:"提交失败",okText:"确认"})}):a.go("login")}}).controller("discoverUserIfo",function(e,t,i,r,a,n,o,s,c){c.getIssuerUserInfo(s.id).then(function(e){r.userInfo=e.data,r.info={id:r.userInfo.userId}},function(){a.alert({title:"信息获取失败",okText:"确认"})}),r.newsSend=function(){return r.userInfo.userId==window.userId?void alert("不能给自己发私信"):void t.getToPersonMessage(r.userInfo).then(function(t){r.messageDetails=t.data.message,e.checkUserAuthority()&&o.go("tab.discover-message",{messageId:t.data.id,isFromMe:t.data[window.userId]},!0)})}}).controller("discoverQuestionnaire",function(e,t,i,r,a,n,o){function s(){r.show({title:"信息拉取失败",buttons:[{text:"重新拉取",onTap:function(t){e.nowTab.click()}},{text:"取消",type:"button-positive"}]})}void 0!==t.id&&(i.showNavBar=!1);var c=o,l="";e.url="tab.discover-questionnaire",e.tabClick=function(t,i){e.heardTabs.map(function(e){e.hover=""}),t.hover="hover",e.$parent.$parent.nowTab=t,e.nowData&&(e.nowData.length=0),t.click&&t.click()},e.title="调查",e.heardTabs=[],e.nowData=[],e.getData=function(i){console.log("获取"+i);var r=c.getInvestByType(t.id,i);r.then(function(t){e.heardTabs=[],t.data.map(function(t,i){e.heardTabs.push({type:t.type,tmpUrl:"./templates/discover/discover-cateforyTab-investigate-tmp.html",click:function(){e.nowData=JSON.parse(JSON.stringify(t.data))}})}),e.tabClick(e.heardTabs[0],0)},s)},e.$on("$ionicView.beforeEnter",function(){c.parev_$scope=e,e.getData(l)})}).controller("discoverQuestionnaireSurvey",function(e,t,i,r,a,n,o,s,c,l){e.top=window.innerHeight-90-46,e.footerShow=e.$on("$ionicView.beforeEnter",function(){n.getQuestionnaireSurvey(r.id,r.source).then(function(u){n.discoverQuestionnaireSurveyData=u.data,n.discoverQuestionnaireSurveyData.id=r.id,e.data=n.discoverQuestionnaireSurveyData,a.update(),e.url=e.data.isRespondent?"#/tab/"+t.pageMarking+"-answerDetails/"+r.id:"#/tab/"+t.pageMarking+"-question/"+t.pageMarking,t.__partake||"user"==t.pageMarking&&window.userInfo.userId==u.data.userId&&s.bindNavTool({navRightIonicClass:"ion-more size-24",toolClick:function(){c.hide=c.show({buttons:[{text:"编辑页面"},{text:"答卷详情"}],titleText:"选择需要的操作",destructiveText:"删除调查",cancelText:"取消",buttonClicked:function(a){switch(a){case 0:console.log(e.data),e.data.alreadyPortion?l.alert({title:"有人答题的问卷不允许编辑!",okText:"确认"}):(r.source=t.pageMarking,i.go("tab."+t.pageMarking+"-investigate",r));break;case 1:i.go("tab."+t.pageMarking+"-answerDetails",r)}c.hide()},destructiveButtonClicked:function(){c.hide(),l.show({title:"确认删除",buttons:[{text:"确认",onTap:function(e){o.delInvestigate(r).then(function(){l.alert({title:"删除成功",okText:"确认"}),t.backClick()}),c.hide()}},{text:"取消",type:"button-positive"}]})}})}},e)},function(){})})}).controller("discoverQuestion",function(e,t,i,r,a,n,o,s){e.top=window.innerHeight-90-32,e.questions=t.discoverQuestionnaireSurveyData.questions,console.log(e.questions),e.num=t.discoverQuestionnaireSurveyData.questions.length-1,e.questions.map(function(e){var t=[];e.option instanceof Array&&"string"==typeof e.option[0]&&(e.option.map(function(e){t.push({text:e,pitchOn:!1})}),e.option=t),"单选"==e.type&&(e.noClass="ion-ios-circle-filled",e.offClass="ion-ios-circle-outline"),"多选"==e.type&&(e.noClass="ion-android-checkbox-outline",e.offClass="ion-android-checkbox-outline-blank")}),e.listClick=function(e,t){var i=e,r=i.option;"单选"==i.type&&(r.map(function(e){e.pitchOn=!1}),r[t].pitchOn=!0),"多选"==i.type&&(r[t].pitchOn=!r[t].pitchOn)},e.submittedQuestionnaire=function(){console.log("提交");var a=0,n=[];return e.questions.map(function(e,t){var i=0;if("问答"!=e.type)for(var r=0;r<e.option.length;r++){var o=e.option[r];if(o.pitchOn){i++;break}}else e.text&&(i=1);i?a++:n.push(t+1)}),console.log(a),a!=e.questions.length?void r.alert({title:"请把信息填写完整~",subTitle:"未填写的题目"+n.join(","),okText:"确认"}):void t.submittedQuestionnaire(t.discoverQuestionnaireSurveyData.id,e.questions).then(function(){r.alert({title:"提交成功",okText:"确认"}),i.backClick()},function(){r.alert({title:"提交失败",okText:"确认"})})}}).controller("discoverAnswerDetails",function(e,t,i){var r=i.discoverQuestionnaireSurveyData;console.log(r),i.getQuestionnaireSurveyResult(t.id).then(function(t){e.maxLength=r.respondents.length,e.questions=r.questions,e.res=t.data,console.log(t,r)})}).controller("discoverInformation",function(e,t,i,r,a,n,o){function s(){r.show({title:"信息拉取失败",buttons:[{text:"重新拉取",onTap:function(t){e.nowTab.click()}},{text:"取消",type:"button-positive"}]})}void 0!==i.id&&(t.showNavBar=!1);var c=o;e.url="tab.discover-activity",e.tabClick=function(t,i){e.heardTabs.map(function(e){e.hover=""}),t.hover="hover",e.$parent.$parent.nowTab=t,e.nowData&&(e.nowData.length=0),t.click&&t.click()},e.title="信息",e.heardTabs=[],e.nowData=[],e.getData=function(t){var i=c.getInformationSelectType();i.then(function(t){e.heardTabs=[],t.data.map(function(t,i){e.heardTabs.push({type:t,tmpUrl:"./templates/discover/discover-cateforyTab-information-tmp.html",click:function(){function i(t){var i=[];return e._typeDatas.map(function(e){e.type==t&&(i=JSON.parse(JSON.stringify(e.data)))}),i}e._typeDatas?(e.nowData=i(t),console.log(e.nowData,e._typeDatas,t)):c.getInformationByType(t).then(function(r){e._typeDatas=r.data,console.log(e._typeDatas,"111"),e.nowData=i(t)})}},function(){alert("失败")})}),e.tabClick(e.heardTabs[0],0)},s)},e.$on("$ionicView.beforeEnter",function(){var t="上海";c.parev_$scope=e,e.getData(t)})}).controller("discoverInformationDetailed",function(e,t,i,r,a,n,o,s,c,l){c.getItemInformationDetailed(s.id,s.source).then(function(c){e.data=c.data,e.userId=c.data.userId,console.log(e.userId),"user"==r.pageMarking&&window.userInfo.userId==c.data.userId&&n.bindNavTool({navRightIonicClass:"ion-more size-24",toolClick:function(){a.hide=a.show({buttons:[{text:"编辑页面"}],titleText:"选择需要的操作",destructiveText:"删除信息",cancelText:"取消",buttonClicked:function(e){switch(e){case 0:s.source=r.pageMarking,o.go("tab."+r.pageMarking+"-information",s)}a.hide()},destructiveButtonClicked:function(){a.hide(),t.show({title:"确认删除",buttons:[{text:"确认",onTap:function(e){i.delInformation(s).then(function(){t.alert({title:"删除成功",okText:"确认"}),r.backClick()})}},{text:"取消",type:"button-positive"}]})}})}},e),e.data.commentInfo&&e.data.commentInfo.map(function(t,i){t||(e.data.commentInfo[i]={})})},function(){});document.getElementById("inputComment");e.emojis=[],e.commentText="",e.commentShow=!1,e.clickALike=function(){c.submitClickALike(s.id,s.source).then(function(){e.data.alikeNumber++,t.alert({title:"点赞成功",okText:"确认"})})},e.$on("$ionicView.beforeEnter",function(){c.submitBrowse(s.id,s.source)});var u=l.$getByHandle("messageDetailsScroll");e.submitComment=function(){if(window.userId){var i={text:e.commentText,name:window.userInfo.nickname,heardPhoto:window.userInfo.headUrl,date:new Date};c.submitComment(s.id,i,s.source).then(function(){window.userInfo||(window.userInfo={}),e.data.commentInfo||(e.data.commentInfo=[]),e.data.commentInfo.push(i),e.commentText="",u.scrollBottom()},function(){t.alert({title:"评论失败",okText:"确认"})})}else alert("尚未登录,不能发表评论!")}}).controller("discoverMap",function(e,t,i,r){t.address=r.address,console.log(t.address),e.getgps()}),angular.module("starter.discoverServices",[]).factory("discoverServices",function(e,t,i,r,a){var n={};return n.selectTmpServices={},n.get=e.httpGet,n.activityType=function(){return n.get("./data/activitySelectType.json",{cache:!0})},n.userGlobal=function(){},n.searchSpecialist=function(e){return console.log(e),r.Sdata("get","search_specialist",{},{param:e})},n.getDiscoverIndexData=function(){return r.Sdata("get","get_index_detail",{},{})},n.getAreaActivity=function(e){return r.Sdata("get","get_activity_area",{},{})},n.getInvestByType=function(e,t){return e?r.Sdata("get","get_circle_item",{investigtion:1},{circleId:e}):r.Sdata("get","get_invest_byType",{},{draflag:"1"})},n.getAllActivities=function(e,t,i){e=e?e:void 0;var a={};return t&&t.length?a.type={$in:t}:a.type=void 0,e&&(e=e.split("-")[0],a.location={$regex:e,$options:"i"}),r.Sdata("get","get_all_activities",{},a)},n.getItemActivityDetailed=function(e,t){return r.Sdata("get","get_activity_detail",{registrationAdditional:0},{id:e,userId:window.userId}).then(function(e){if(e.data){console.log(window.userId);var t=e.data.verifiedApplicant||[],i=e.data.signUpRecord||[],r=e.data.signInRecord||[],a=e.data.evaluationRecord||[];e.data.participator=0,e.data.alreadySignUp=0,e.data.alreadySignIn=0,e.data.timeAvr=0,e.data.applyAvr=0,e.data.checkInAvr=0,e.data.commentAvr=0,e.data.numberAvr=0,e.data.alreadyEnd=0,e.data.signUpCount>i.length&&(e.data.numberAvr=1),i&&i.map(function(t){t.userId==window.userId&&(e.data.alreadySignUp=1)}),t&&t.map(function(t){t==window.userId&&(e.data.participator=1)}),r&&r.map(function(t){t.userId==window.userId&&(e.data.alreadySignIn=1)}),a&&a.map(function(t){t.userId==window.userId&&(e.data.alreadyEvaluate=1)}),(new Date(e.data.activityStartTime).getTime()||0<=(new Date).getTime())&&((new Date).getTime()<=new Date(e.data.activityEndTime).getTime(),!0)&&(e.data.timeAvr=1),(new Date).getTime()>=new Date(e.data.activityEndTime).getTime(),e.data.alreadyEnd=1,e.data.signIn=e.data.signIn||{},e.data.checkInAvr=e.data.signIn.startSignIn&&e.data.participator&&!e.data.alreadySignIn,(new Date).getTime()<=new Date(e.data.applyEndTime).getTime()&&!e.data.alreadySignUp&&e.data.numberAvr&&(e.data.applyAvr=1),e.data.alreadyEnd&&e.data.alreadySignIn&&!e.data.alreadyEvaluate&&(e.data.evaluateAvr=1)}return e})},n.getActivityEvaluation=function(e){return r.Sdata("get","get_activity_evaluationModel",{},{id:e})},n.submitEvaluation=function(e,t){return r.Sdata("get","submit_activity_rRecord",{data:t,type:"evaluation",userId:window.userId,creator:window.userInfo},{id:e})},n.getRegistrationAdditional=function(e){return r.Sdata("get","get_activity_registrationAdditionalModel",{},{id:e})},n.submitSignUp=function(e,t){for(var i=t.length,a=0;a<i;a++)delete t[a].$$hashKey;return r.Sdata("get","new_sysNotice",{type:"applyActivity",item:e,from:{userId:userId,nickname:userInfo.nickname},to:{userId:e.creatorId,nickname:""},time:new Date,message:userInfo.nickname+" 报名了活动 '"+e.activityName+"'!"},{type:"applyActivity","item.id":e.id,"from.userId":userId,"to.userId":e.creatorId}),r.Sdata("get","submit_activity_rRecord",{data:t,type:"signUp",userId:window.userId,creator:window.userInfo},{id:e.id})},n.getToHireMore=function(e,t){return r.Sdata("get","get_hire_byParam",{},{})},n.getItemToHireDetailed=function(e,t){return r.Sdata("get","get_hire",{},{id:e}).then(function(e){var t=e.data.applicant||[];e.data.alreadyApply=0,t.map(function(t){t.userId==window.userId&&(e.data.alreadyApply=1)});var i=e.data.userId;return i==window.userId?e.data.applyAvr=0:e.data.applyAvr=1,e})},n.acceptAnOfferOfEmployment=function(e,t,i){return r.Sdata("get","new_sysNotice",{type:"applyHire",from:{userId:userId,nickname:userInfo.nickname},to:{userId:i.userId,nickname:i.nickname},time:new Date,message:userInfo.nickname+" 应聘了 '"+t+"'!"},{type:"applyHire","from.userId":userId,"to.userId":i.userId}),r.Sdata("get","apply_hire",window.userInfo,{id:e})},n.getIssuerUserInfo=function(e){return r.Sdata("get","get_user_basic",{},{userId:e})},n.getQuestionnaireSurvey=function(e,t){return r.Sdata("get","get_invest_model",{},{id:e,userId:window.userId})},n.submittedQuestionnaire=function(e,t){for(var i=t.length,a=[],n=0;n<i;n++){var o=t[n].option,s=o.length,c=[];if("问答"==t[n].type)c=t[n].text;else for(var l=0;l<s;l++)o[l].pitchOn?c.push(1):c.push(0);a.push(c)}return t=a,t.userId=window.userId,t.userInfo=window.userInfo,r.Sdata("get","submit_invest_rRecord",{data:t,type:"investRecord",userId:window.userId,creator:window.userInfo},{id:e})},n.getInformationByType=function(e){return r.Sdata("get","get_info_byType",{},{})},n.getInformationSelectType=function(){return e.httpGet("./data/informationSelectTypeData.json")},n.getItemInformationDetailed=function(e,t){return r.Sdata("get","get_info_detail",{},{id:e})},n.submitClickALike=function(e,t){return r.Sdata("get","submit_info_rRecord",{type:"alike",creator:window.userInfo},{id:e})},n.submitComment=function(e,t,i){return t.type="comment",t.creator=window.userInfo,r.Sdata("get","submit_info_rRecord",t,{id:e})},n.submitBrowse=function(e,t){return r.Sdata("get","submit_info_rRecord",{type:"browse",creator:window.userInfo},{id:e})},n.discoverMap=function(e,t){},n.activitySignIn=function(e,t){return r.Sdata("get","update_activity_signIn",{"signUpRecord.$.signInStatus":1},{id:e,"signUpRecord.userInfo":window.userInfo})},n.searchHire=function(e){return param={$or:[{address:{$regex:e,$options:"i"}},{company:{$regex:e,$options:"i"}},{industry:{$regex:e,$options:"i"}},{profession:{$regex:e,$options:"i"}}]},r.Sdata("get","get_hire_byParam",{},param)},n.getQuestionnaireSurveyResult=function(e,t){return console.log(e,t),r.Sdata("get","get_invest_statistics",{},{id:e})},n}),angular.module("starter.enrollControllers",[]).controller("enrollLoginCtrl",function(e,t,i,r,a,n,o,s,c,l,u){function d(e){o.WeChatOk=e}o.getPreviousTitle=function(){return e.backTitle()},o.goBack=function(){e.goBack()},o.user={phone:"",password:""},o.WeChatOk=!1,o.guestView=function(){s.go("tab.discover-index")},o.$on("$ionicView.beforeEnter",function(){try{u.check(d)}catch(e){}}),o.Checkin=function(){function e(){function e(){console.log("done")}function a(){console.log("error")}function n(){console.log("每次都更新")}function o(){t.Sdata("get","get_user_basic",{},{userId:l.get("userId")}).then(function(e){""!=e&&(e=e.data,r.messageBadge=e.messageBadge)})}window.sysTimer=i(o,2e3),sysTimer.then(e,a,n)}console.log("$scope.user",o.user.password,o.user.phone),c.findUser({password:o.user.password,phone:(o.user.phone||"").toString()}).then(function(t){""!=t?(window.userInfo={},window.userInfo.nickname=t.nickname,window.userInfo.phone=t.phone,window.userInfo.userId=t.userId,window.userInfo.headUrl=t.headUrl,window.userInfo.heardPhoto=t.headUrl,window.userInfo.currentCompany=t.currentCompany,window.userInfo.config=t.config,window.userInfo.sysSetting=t.sysSetting,window.token=t.token||"",window.userId=t.userId,r.messageBadge=t.messageBadge,l.update("userInfo",window.userInfo),l.update("userId",window.userId),l.update("token",window.token),o.user=window.userInfo,console.log(t.userId),s.go("tab.user-index",{userId:t.userId}),t.nickname>" "&&s.go("tab.user-index",{userId:t.userId}),e()):alert("密码或手机号码错误","您输入的密码或手机号码有误，请检查。")})},o.WeChatSSO=function(){function e(e){e.openid&&c.findUser({openId:e.openid}).then(function(t){if(t)console.log(e.openid),window.userInfo={},window.userInfo.nickname=t.nickname,window.userInfo.userId=t.userId,window.userInfo.headUrl=t.headUrl,window.userInfo.heardPhoto=t.headUrl,window.userInfo.config=t.config,window.userInfo.sysSetting=t.sysSetting,r.messageBadge=t.messageBadge,window.token=t.token||"",window.userId=t.userId,l.update("userId",window.userId),l.update("userInfo",window.userInfo),l.update("token",window.token),o.user=t,console.log(t.nickname),t.nickname>" "&&s.go("tab.user-index",{userId:t.userId}),setSysTimer();else{var i=new Date;window.userInfo={},window.userInfo.userId=i.getTime().toString(),window.userInfo.openId=e.openid,window.userInfo.nickname=e.nickname,window.userInfo.headUrl=e.headimgurl,2==e.sex?window.userInfo.sex="女":1==e.sex?window.userInfo.sex="男":window.userInfo.sex="",window.userInfo.config={"手机号码可见":!1,"基本信息可见":!1,"扩展信息可见":!1},window.userInfo.sysSetting={sysSetting:!1},window.userId=window.userInfo.userId,c.addUser(window.userInfo).then(function(e){e.result.ok>0?(l.update("userId",window.userId),l.update("userInfo",window.userInfo),s.go("tab.user-index")):ShowM.showAlert("创建用户失败","创建用户失败，请检查网路！")})}})}u.auth(e)}}).controller("erollfetchPasswordCtrl",function(e,t,i,r,a,n,o,s,c,l,u){r.user={},r.Tosubmit=function(){if(r.user.password==r.obj.confirm){var e=new Date;r.user.userId=e.getTime().toString(),c.addUser(r.user).then(function(e){e.result.ok>0?(u.update("userId",r.user.userId),u.update("userInfo",r.user),window.userInfo=r.user,window.userId=r.user.userId,o.go("tab.user-index")):l.showAlert("创建用户失败","创建用户失败，请检查网路！")})}else l.showAlert("密码错误","您两次输入的密码不一致！")},r.Rsend=function(e,t){if(r.myURL="",2!=e||r.obj.resend){r.user.phone||(r.user.phone=t),r.obj.resend=!1,r.Snumber="";for(var i=0;i<6;i++)r.Snumber+=Math.floor(10*Math.random());var o="http://106.ihuyi.cn/webservice/sms.php?method=Submit&account=cf_zhongwei&password=amec123456&mobile="+r.user.phone+"&content=您的验证码是：【"+r.Snumber+"】。请不要把验证码泄露给其他人。";r.myURL=a.trustAsResourceUrl(o),r.wait=60,r.time=function(){return 0==r.wait?void(r.obj.resend=!0):(r.wait--,void n(function(){r.time()},1e3))},r.time()}},r.checkPhoneNumber=function(){console.log(r.user.phone),c.findUser({phone:r.user.phone.toString()}).then(function(e){console.log(e),e.length<1?l.showConfirm("账号不存在","该账号不存在,请前往注册").then(function(e){e&&o.go("register_new")}):o.go("resetPassword_verify",{verify:r.user.phone})})},r.DoVerify=function(){r.Snumber==r.obj.Vnumber&&r.Snumber>"0"?o.go("reset_password",{submit:r.user.phone}):l.showAlert("验证码错误","您输入的短信验证码有误，请检查。")},r.resetPassword=function(){t.Sdata("get","update_user_info",{password:r.user.password},{phone:s.submit}).then(function(t){t?(e.alert({title:"密码修改成功",okText:"确认"}),o.go("tab.user-index")):e.alert({title:"修改失败",okText:"确认"})})},s.verify?(r.Snumber="",r.obj={Vnumber:"",confirm:"",resend:!1},r.Rsend(1,s.verify)):s.submit&&(r.obj={confirm:""},r.user.phone=s.submit)}).controller("enrollAddCircleInput",function(e,t,i,r,a,n){t.registrationAdditional=[],t.userInfo=window.userInfo,i.getCircleInput(n.id).then(function(e){t.registrationAdditional=e.data instanceof Array?e.data:[],console.log(t.registrationAdditional)},function(){}),t.initData=function(e){"姓名"==e.text?e.value=userInfo.nickname:"","手机"==e.text?e.value=userInfo.phone:""},t.submitSignUp=function(){var a="";return t.registrationAdditional.map(function(e){e.value||(a+=e.text+"信息未填写<br>")}),a?(r.alert({title:"信息未填写",template:a,okText:"确认"}),!1):void i.submitCircleInput(n.id,t.registrationAdditional).then(function(){r.alert({title:"提交成功",okText:"确认"}),e.go("tab.circle-enterTheCircle",{name:"上海后MBA|EMBA报名群",id:"1461659549401_circle"},!0)},function(){r.alert({title:"提交失败",okText:"确认"})})}}).controller("EnrollCtrl",function(e,t,i,r,a,n,o,s,c,l,u,d){a.mobileVerify=c.mobileVerify,e.pageMarking="circle",a.user={},a.getPreviousTitle=function(){return i.backTitle()},a.goBack=function(){i.goBack()},a.Tosubmit=function(){if(a.user.password==a.obj.confirm){var e=new Date;a.user.userId=e.getTime().toString(),l.addUser(a.user).then(function(e){e.result.ok>0?(d.update("userId",a.user.userId),d.update("userInfo",a.user),window.userInfo=a.user,window.userId=a.user.userId,s.go("enroll-addCircleInput",{id:"1461659549401_circle"},!0)):u.showAlert("创建用户失败","创建用户失败，请检查网路！")})}else u.showAlert("密码错误","您两次输入的密码不一致！")},a.Rsend=function(e,t){if(a.myURL="",2!=e||a.obj.resend){a.user.phone||(a.user.phone=t),a.obj.resend=!1,a.Snumber="";for(var i=0;i<6;i++)a.Snumber+=Math.floor(10*Math.random());var r="http://106.ihuyi.cn/webservice/sms.php?method=Submit&account=cf_zhongwei&password=amec123456&mobile="+a.user.phone+"&content=您的验证码是：【"+a.Snumber+"】。请不要把验证码泄露给其他人。";a.myURL=n.trustAsResourceUrl(r),a.wait=60,a.time=function(){return 0==a.wait?void(a.obj.resend=!0):(a.wait--,void o(function(){a.time()},1e3))},a.time()}},a.CheckbyPhoneNuber=function(e){a.mobileVerify=c.mobileVerify,l.findUser({phone:a.user.phone.toString()}).then(function(e){console.log(e),e.length<1?s.go("enroll_verify",{verify:a.user.phone,mobileVerify:a.mobileVerify}):(window.userId=e.userId,window.userInfo={},window.userInfo.phone=e.phone,window.userInfo.nickname=e.nickname,d.update("userId",window.userId),u.showConfirm("手机号已注册","您输入的手机号已经注册!").then(function(e){
e&&s.go("enroll-addCircleInput",{id:"1461659549401_circle"},!0)}))})},a.DoVerify=function(){a.Snumber==a.obj.Vnumber&&a.Snumber>"0"?c.mobileVerify?l.updateUserInfo("phone",a.user.phone).then(function(e){200==e.status&&t.show({title:"绑定成功",buttons:[{text:"确认",type:"button-positive"}]}).then(function(){i.goBack(-4)})}):s.go("enroll_submit",{submit:a.user.phone}):u.showAlert("验证码错误","您输入的短信验证码有误，请检查。")},c.verify?(a.Snumber="",a.obj={Vnumber:"",confirm:"",resend:!1},a.Rsend(1,c.verify)):c.submit&&(a.obj={confirm:""},a.user.phone=c.submit)}),angular.module("starter.enrollServices",[]).factory("enrollServices",["$q","rDataHand","ShowM",function(e,t){return{findUser:function(e){var i=t.Sdata("get","get_user_basic",{},e).then(function(e){return e});return i},addUser:function(e){var i=t.Sdata("get","add_user",e,{}).then(function(e){return e});return i}}}]).factory("ShowM",["$q","$ionicPopup",function(e,t){return{showAlert:function(e,i){var r=t.alert({title:e,template:i});r.then(function(e){})},showConfirm:function(e,i){var r=t.confirm({title:e,template:i});return r.then(function(e){return!!e}),r}}}]),angular.module("starter.loginControllers",[]).controller("LoginCtrl",function(e,t,i,r,a,n,o,s,c,l,u){function d(e){o.WeChatOk=e}o.getPreviousTitle=function(){return e.backTitle()},o.goBack=function(){e.goBack()},o.user={phone:"",password:""},o.WeChatOk=!1,o.guestView=function(){s.go("tab.discover-index")},o.$on("$ionicView.beforeEnter",function(){try{u.check(d)}catch(e){}}),o.Checkin=function(){function e(){function e(){console.log("done")}function a(){console.log("error")}function n(){console.log("每次都更新")}function o(){t.Sdata("get","refresh_sysNotice",{},{userId:l.get("userId")}).then(function(e){""!=e&&(e=e.data,r.messageBadge=!e.messageBadge||e.messageBadge<0?0:e.messageBadge,r.sysNoticeBadge=!e.allSysNotice||e.allSysNotice<0?0:e.allSysNotice,r.sysBadge=r.messageBadge||0+r.sysNoticeBadge||0)})}window.sysTimer=i(o,2e3),sysTimer.then(e,a,n)}console.log("$scope.user",o.user.password,o.user.phone),c.findUser({password:o.user.password,phone:(o.user.phone||"").toString()}).then(function(t){""!=t?(window.userInfo={},window.userInfo.nickname=t.nickname,window.userInfo.phone=t.phone,window.userInfo.userId=t.userId,window.userInfo.headUrl=t.headUrl,window.userInfo.heardPhoto=t.headUrl,window.userInfo.currentCompany=t.currentCompany,window.userInfo.config=t.config,window.userInfo.sysSetting=t.sysSetting,window.token=t.token||"",window.userId=t.userId,r.messageBadge=t.messageBadge,l.update("userInfo",window.userInfo),l.update("userId",window.userId),l.update("token",window.token),o.user=window.userInfo,s.go("tab.user-index",{userId:t.userId}),t.nickname>" "&&s.go("tab.user-index",{userId:t.userId}),e()):alert("密码或手机号码错误","您输入的密码或手机号码有误，请检查。")})},o.WeChatSSO=function(){function e(e){e.openid&&c.findUser({openId:e.openid}).then(function(t){if(t)window.userInfo={},window.userInfo.nickname=t.nickname,window.userInfo.userId=t.userId,window.userInfo.headUrl=t.headUrl,window.userInfo.heardPhoto=t.headUrl,window.userInfo.config=t.config,window.userInfo.sysSetting=t.sysSetting,r.messageBadge=t.messageBadge,window.token=t.token||"",window.userId=t.userId,l.update("userId",window.userId),l.update("userInfo",window.userInfo),l.update("token",window.token),o.user=t,t.nickname>" "&&s.go("tab.user-index",{userId:t.userId}),setSysTimer();else{var i=new Date;window.userInfo={},window.userInfo.userId=i.getTime().toString(),window.userInfo.openId=e.openid,window.userInfo.nickname=e.nickname,window.userInfo.headUrl=e.headimgurl,2==e.sex?window.userInfo.sex="女":1==e.sex?window.userInfo.sex="男":window.userInfo.sex="",window.userInfo.config={"手机号码可见":!1,"基本信息可见":!1,"扩展信息可见":!1},window.userInfo.sysSetting={sysSetting:!1},window.userId=window.userInfo.userId,c.addUser(window.userInfo).then(function(e){console.log(e.result),e.result.ok>0?(console.log(window.userId),l.update("userId",window.userId),l.update("userInfo",window.userInfo),s.go("tab.user-index")):ShowM.showAlert("创建用户失败","创建用户失败，请检查网路！")})}})}u.auth(e)}}).controller("fetchPasswordCtrl",function(e,t,i,r,a,n,o,s,c,l,u){r.user={},r.Tosubmit=function(){if(r.user.password==r.obj.confirm){var e=new Date;r.user.userId=e.getTime().toString(),c.addUser(r.user).then(function(e){e.result.ok>0?(u.update("userId",r.user.userId),u.update("userInfo",r.user),window.userInfo=r.user,window.userId=r.user.userId,o.go("tab.user-index")):l.showAlert("创建用户失败","创建用户失败，请检查网络！")})}else l.showAlert("密码错误","您两次输入的密码不一致！")},r.Rsend=function(e,t){if(r.myURL="",2!=e||r.obj.resend){r.user.phone||(r.user.phone=t),r.obj.resend=!1,r.Snumber="";for(var i=0;i<6;i++)r.Snumber+=Math.floor(10*Math.random());var o="http://106.ihuyi.cn/webservice/sms.php?method=Submit&account=cf_zhongwei&password=amec123456&mobile="+r.user.phone+"&content=您的验证码是：【"+r.Snumber+"】。请不要把验证码泄露给其他人。";r.myURL=a.trustAsResourceUrl(o),r.wait=60,r.time=function(){return 0==r.wait?void(r.obj.resend=!0):(r.wait--,void n(function(){r.time()},1e3))},r.time()}},r.checkPhoneNumber=function(){console.log(r.user.phone),c.findUser({phone:r.user.phone.toString()}).then(function(e){console.log(e),e.length<1?l.showConfirm("账号不存在","该账号不存在,请前往注册").then(function(e){e&&o.go("register_new")}):o.go("resetPassword_verify",{verify:r.user.phone})})},r.DoVerify=function(){r.Snumber==r.obj.Vnumber&&r.Snumber>"0"?o.go("reset_password",{submit:r.user.phone}):l.showAlert("验证码错误","您输入的短信验证码有误，请检查。")},r.resetPassword=function(){t.Sdata("get","update_user_info",{password:r.user.password},{phone:s.submit}).then(function(t){t?(e.alert({title:"密码修改成功",okText:"确认"}),o.go("login")):e.alert({title:"修改失败",okText:"确认"})})},s.verify?(r.Snumber="",r.obj={Vnumber:"",confirm:"",resend:!1},r.Rsend(1,s.verify)):s.submit&&(r.obj={confirm:""},r.user.phone=s.submit)}).controller("RegisterCtrl",function(e,t,i,r,a,n,o,s,c,l,u){r.mobileVerify=s.mobileVerify,r.user={},r.getPreviousTitle=function(){return t.backTitle()},r.goBack=function(){t.goBack()},r.Tosubmit=function(){if(r.user.password==r.obj.confirm){var e=new Date;r.user.userId=e.getTime().toString(),c.addUser(r.user).then(function(e){e.result.ok>0?(u.update("userId",r.user.userId),u.update("userInfo",r.user),window.userInfo=r.user,window.userId=r.user.userId,o.go("tab.user-index")):l.showAlert("创建用户失败","创建用户失败，请检查网路！")})}else l.showAlert("密码错误","您两次输入的密码不一致！")},r.Rsend=function(e,t){if(r.myURL="",2!=e||r.obj.resend){r.user.phone||(r.user.phone=t),r.obj.resend=!1,r.Snumber="";for(var i=0;i<6;i++)r.Snumber+=Math.floor(10*Math.random());var o="http://106.ihuyi.cn/webservice/sms.php?method=Submit&account=cf_zhongwei&password=amec123456&mobile="+r.user.phone+"&content=您的验证码是：【"+r.Snumber+"】。请不要把验证码泄露给其他人。";r.myURL=a.trustAsResourceUrl(o),r.wait=60,r.time=function(){return 0==r.wait?void(r.obj.resend=!0):(r.wait--,void n(function(){r.time()},1e3))},r.time()}},r.CheckbyPhoneNuber=function(e){r.mobileVerify=s.mobileVerify,c.findUser({phone:r.user.phone.toString()}).then(function(e){console.log(e),e.length<1?o.go("register_verify",{verify:r.user.phone,mobileVerify:r.mobileVerify}):l.showConfirm("手机号已注册","您输入的手机号已经注册!")})},r.DoVerify=function(){r.Snumber==r.obj.Vnumber&&r.Snumber>"0"?s.mobileVerify?c.updateUserInfo("phone",r.user.phone).then(function(i){200==i.status&&e.show({title:"绑定成功",buttons:[{text:"确认",type:"button-positive"}]}).then(function(){t.goBack(-4)})}):o.go("register_submit",{submit:r.user.phone}):l.showAlert("验证码错误","您输入的短信验证码有误，请检查。")},s.verify?(r.Snumber="",r.obj={Vnumber:"",confirm:"",resend:!1},r.Rsend(1,s.verify)):s.submit&&(r.obj={confirm:""},r.user.phone=s.submit)}),angular.module("starter.loginServices",[]).factory("loginServices",["$q","rDataHand","ShowM",function(e,t){return{findUser:function(e){var i=t.Sdata("get","get_user_basic",{},e).then(function(e){return e});return i},addUser:function(e){var i=t.Sdata("get","add_user",e,{}).then(function(e){return e});return i}}}]).factory("ShowM",["$q","$ionicPopup",function(e,t){return{showAlert:function(e,i){var r=t.alert({title:e,template:i});r.then(function(e){})},showConfirm:function(e,i){var r=t.confirm({title:e,template:i});return r.then(function(e){return!!e}),r}}}]),angular.module("angucomplete",[]).directive("angucomplete",function(e,t,i,r){return{restrict:"EA",scope:{id:"@id",userId:"@userId",placeholder:"@placeholder",selectedObject:"=selectedobject",url:"@url",dataField:"@datafield",titleField:"@titlefield",descriptionField:"@descriptionfield",imageField:"@imagefield",imageUri:"@imageuri",inputClass:"@inputclass",userPause:"@pause",localData:"=localdata",searchFields:"@searchfields",minLengthUser:"@minlength",matchClass:"@matchclass",searchStr:"=ngModel",resultsHide:"=resultshide",results:"=results",inputChange:"=searchBack"},template:'<div class="angucomplete-holder"><input id="{{id}}_value" ng-model="searchStr" type="text" placeholder="{{placeholder}}" class="{{inputClass}}" onmouseup="this.select();" ng-focus="resetHideResults()" ng-blur="hideResults()" /><div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-if="showDropdown&&!resultsHide"><div class="angucomplete-searching" ng-show="searching">Searching...</div><div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)">No results found</div><div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseover="hoverRow()" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}"><div ng-if="imageField" class="angucomplete-image-holder"><img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="angucomplete-image"/><div ng-if="!result.image && result.image != \'\'" class="angucomplete-image-default"></div></div><div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div><div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div><div ng-if="result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div></div></div></div>',link:function(e,a,n){e.lastSearchTerm=null,e.currentIndex=null,e.justChanged=!1,e.searchTimer=null,e.hideTimer=null,e.searching=!1,e.pause=500,e.minLength=3,e.keydown=e.keydown||function(){},e.minLengthUser&&""!=e.minLengthUser&&(e.minLength=e.minLengthUser),e.userPause&&(e.pause=e.userPause),isNewSearchNeeded=function(t,i){return t.length>=e.minLength&&t!=i},e.processResults=function(t,r){if(t&&t.length>0){e.results=[];var a=[];e.titleField&&""!=e.titleField&&(a=e.titleField.split(","));for(var n=0;n<t.length;n++){for(var o=[],s=0;s<a.length;s++)o.push(t[n][a[s]]);var c="";e.descriptionField&&(c=t[n][e.descriptionField]);var l="";e.id&&(l=t[n][e.id]),console.log(l);var u="";e.imageUri&&(u=e.imageUri);var d="";e.imageField&&(d=u+t[n][e.imageField]);var p=o.join(" ");if(console.log(p),e.matchClass){var m=new RegExp(r,"i"),f=p.match(m)?p.match(m)[0]:"";p=i.trustAsHtml(p.replace(m,'<span class="'+e.matchClass+'">'+f+"</span>"))}var g={userId:userId,title:p,description:c,image:d,originalObject:t[n]};e.results[e.results.length]=g}}else e.results=[]},e.searchTimerComplete=function(i){if(i.length>=e.minLength)if(e.localData){for(var r=e.searchFields.split(","),a=[],n=0;n<e.localData.length;n++){for(var o=!1,s=0;s<r.length;s++)o=o||"string"==typeof e.localData[n][r[s]]&&"string"==typeof i&&e.localData[n][r[s]].toLowerCase().indexOf(i.toLowerCase())>=0;o&&(a[a.length]=e.localData[n])}e.searching=!1,e.processResults(a,i)}else e.url?t.get(e.url+i,{}).success(function(t,r,a,n){e.searching=!1,e.processResults(e.dataField?t[e.dataField]:t,i)}).error(function(e,t,i,r){console.log("error")}):e.inputChange&&e.inputChange(i)},e.hideResults=function(){e.hideTimer=r(function(){e.showDropdown=!1},e.pause)},e.resetHideResults=function(){e.hideTimer&&r.cancel(e.hideTimer)},e.hoverRow=function(t){e.currentIndex=t},e.keyPressed=function(t){38!=t.which&&40!=t.which&&13!=t.which?e.searchStr&&""!=e.searchStr?isNewSearchNeeded(e.searchStr,e.lastSearchTerm)&&(e.lastSearchTerm=e.searchStr,e.showDropdown=!0,e.currentIndex=-1,e.results=[],e.searchTimer&&r.cancel(e.searchTimer),e.searching=!0,e.searchTimer=r(function(){e.searchTimerComplete(e.searchStr)},e.pause)):(e.showDropdown=!1,e.lastSearchTerm=null):t.preventDefault()},e.selectResult=function(t){e.matchClass&&(t.title=t.title.toString().replace(/(<([^>]+)>)/gi,"")),e.searchStr=e.lastSearchTerm=t.title,e.selectedObject=t,e.showDropdown=!1,e.results=[]};var o=a.find("input");o.on("keyup",e.keyPressed),a.on("keyup",function(t){e.keydown(e.searchStr),40===t.which?(e.results&&e.currentIndex+1<e.results.length&&(e.currentIndex++,e.$apply(),t.preventDefault,t.stopPropagation()),e.$apply()):38==t.which?e.currentIndex>=1&&(e.currentIndex--,e.$apply(),t.preventDefault,t.stopPropagation()):13==t.which?e.results&&e.currentIndex>=0&&e.currentIndex<e.results.length?(e.selectResult(e.results[e.currentIndex]),e.$apply(),t.preventDefault,t.stopPropagation()):(e.results=[],e.$apply(),t.preventDefault,t.stopPropagation()):27==t.which?(e.results=[],e.showDropdown=!1,e.$apply()):8==t.which&&(e.selectedObject=null,e.$apply())})}}}),window.href=function(e){window.location.href=window.location.href.replace(/#.*/,"")+e,console.log(window.location.href)},window.formatDate=function(e){var t=new Date(e);return t.toLocaleString()},window.processTheFile=function(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){t(e.target.result)},i.onerror=function(e){alert("文件读取失败"+JSON.stringify(e))}};var app=angular.module("starter",["ionic","ngCordova","angucomplete","starter.routes","starter.Services","starter.publicDirective","starter.publicFilter","starter.enrollControllers","starter.enrollServices","starter.loginControllers","starter.loginServices","starter.publishToHireControllers","starter.publishToHireServices","starter.publishToHireDirective","starter.publishActivityControllers","starter.publishActivityServices","starter.publishActivityDirective","starter.publishInformationControllers","starter.publishInformationServices","starter.publishInformationDirective","starter.publishInvestigateControllers","starter.publishInvestigateServices","starter.publishInvestigateDirective","starter.userControllers","starter.userServices","starter.discoverControllers","starter.discoverServices","starter.circleControllers","starter.circleServices","monospaced.elastic","starter.directives","starter.chatControllers","starter.chatServices"]);app.run(function(e,t,i,r,a,n,o,s,c,l){a.TAB={},a._n=/\n/gi;var u="";ionic.Platform.isAndroid()&&(u="/android_asset/www/"),r.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleLightContent(),localStorage.getItem("firstStart")?a.starterShow=!0:(a.starterShow=!1,e.go("preview"))}),a.$on("$stateChangeStart",function(e,t,i,r,n){a.prevNavText=a.navRightButtonText,o.bindNavTool(),a.showNavBar=!0})}),app.factory("system",function(e,t,i,r,a,n,o,s,c){function l(){console.log("done")}function u(){console.log("error")}function d(){console.log("每次都更新")}function p(){r.Sdata("get","refresh_sysNotice",{},{userId:i.get("userId")}).then(function(e){""!=e&&(e=e.data,s.messageBadge=!e.messageBadge||e.messageBadge<0?0:e.messageBadge,s.sysNoticeBadge=e.allSysNotice<0?0:e.allSysNotice,s.sysBadge=s.messageBadge||0+s.sysNoticeBadge||0)})}window.userInfo=i.get("userInfo")||{userId:"",nickname:"",headUrl:""},window.userId=window.userInfo.userId,console.log("window.userinfo",window.userInfo),window.baseUrl={url:"http://192.168.27.148:8081/"},s.default_femaleImg="./img/default/default_female.png",s.default_maleImg="./img/default/default_male.png",s.default_logo="./img/logoT.png",window.company={logo:"./img/logoT.png"},r.Sdata("get","get_user_basic",{},{userId:i.get("userId")}).then(function(e){""!=e&&(e=e.data,window.userInfo={},window.userInfo.nickname=e.nickname,window.userInfo.phone=e.phone,window.userInfo.userId=e.userId,window.userInfo.headUrl=e.headUrl,window.userInfo.heardPhoto=e.headUrl,window.userInfo.currentCompany=e.currentCompany,window.token=e.token||"",window.userId=e.userId,s.sysNoticeBadge=e.allSysNotice<0?0:e.allSysNotice,s.messageBadge=e.messageBadge,s.sysBadge=s.messageBadge||0+s.sysNoticeBadge||0,i.update("userInfo",window.userInfo),i.update("userId",window.userId),i.update("token",window.token))}),i.get("userId")&&(p(),window.sysTimer=e(p,5e3),sysTimer.then(l,u,d));var m={};return m.httpGet=function(e,t){return a.show(),o.get(e,t).success(function(){a.hide()}).error(function(){a.hide()})},m.loadingHttp=function(e,t){return t=t||{},e=e||{},a.show({content:t.loadText||"Loading",animation:t.animateTpe||"fade-in",showBackdrop:t.showBackdrop,maxWidth:t.maxWidth||200,showDelay:t.showDelay||0}),o(e).success(function(){a.hide()}).error(function(){a.hide()})},m.bindNavTool=function(e,t){function i(){e=e||{},r.navRightIonicClass=e.navRightIonicClass||"",r.navRightButtonText=e.rightText||"",r.toolClick=e.toolClick||function(){},r.showNav=e.showNav}var r=s;t?(t.$on("$ionicView.beforeEnter",i),i()):(console.log("scope没有传递"),i())},m.correspondingKey=function(e,t,i){if(i)for(var r in e)t[r]=t[e[r]],delete t[e[r]];else for(var r in e)t[e[r]]=t[r],delete t[r]},m.delObj=function(e){if(e==window.userInfo)return void console.log("当前对象是window.userInfo");for(var t in e)if(e[t]instanceof Array)e[t].length=0;else if(e[t]instanceof Object){if(e[t]instanceof Date){e[t]=void 0;continue}m.delObj(e[t])}else switch(typeof e[t]){case"number":e[t]=0;break;case"string":e[t]="";break;case"boolean":e[t]=!1;break;default:e[t]=void 0}},m.newObject=function(e){return JSON.parse(JSON.stringify(e))},m}),app.controller("overstory",function(e,t,i,r,a,n,o,s,c){Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},i.newDate=function(e){return new Date(e)},i.checkUserAuthority=function(){var e=o.get("userId");return!!e||(n.go("login"),!1)}}).controller("AppCtrl",function(e,t,i,r,a,n,o,s,c){function l(t,i){i||(i=e),n.fromTemplateUrl(t,{scope:i,animation:"slide-in-up"}).then(function(t){e.modal=t,e.modal.show()})}r.enroll=function(){s.go("enroll_register")},r.pageMarking="discover",r.startApp=function(){i.update("firstStart",1),r.starterShow=!0,r.go("tab.discover-index","discover")},r.backClick=function(e){e&&(r.pageMarking=r.pageMarkingOld),t.goBack()},r.setTab=function(e){e?r.pageMarking=e:r.pageMarking=r.pageMarkingOld},r.go=function(e,t){r.hideTabs=!1,r.pageMarkingOld=t,r.pageMarking=t,"user"!=t&&"chat"!=t||window.userInfo.userId?s.go(e):s.go("login")},e.closeModal=function(t){e.modal.remove(),t&&(r.pageMarking=r.pageMarkingOld)},e.openModel=function(e,t){if(window.userInfo.userId)if(t&&(r.pageMarkingOld=r.pageMarking,r.pageMarking=t),window.userInfo.phone){var i=["ephemeralData","activityEphemeralData","informationEphemeralData","investigateEphemeralData"];i.map(function(e){try{r[e]&&system.delObj(r[e])}catch(t){}}),l(e)}else a.confirm({title:"是否验证用户?",subTitle:"没有验证手机号码，不能使用发布功能!现在就去验证?",cancelText:"取消",okText:"确认"}).then(function(e){e&&s.go("mobile_verify")});else a.confirm({title:"是否登录或注册用户?",subTitle:"没有登录系统，不能使用发布功能!现在就去注册或登录?",cancelText:"取消",okText:"确认"}).then(function(e){e&&s.go("login")})}}).controller("selectType",function(e){e.removeNoe=function(t){e.selectData.splice(e.selectData.indexOf(t),1),e.elementShow[t]=!1,e.surplus--},e.addNoe=function(t){e.surplus>=e.maxSurplus&&e.selectData.indexOf(t)==-1||(e.elementShow[t]=!e.elementShow[t],1==e.maxSurplus&&e.selectData.length&&e.removeNoe(e.selectData[0]),e.elementShow[t]?e.selectData.push(t):e.removeNoe(t),e.surplus=e.selectData.length)},e.surplus=0,e.title||console.log("父级未指定title"),e.selectTypeText||(e.$parent.selectTypeText="父级未指定selectTypeText"),e.elementShow||(e.$parent.elementShow={}),e.selectData?e.selectData.map(function(t){e.elementShow[t]=!0,e.surplus=e.selectData.length}):e.$parent.selectData=[],e.typeDatas||console.log("父级没有typeDatas数据"),e.maxSurplus||(e.$parent.maxSurplus=1)}).controller("selectArea",function(e){if(!e.config)return void console.log("$scope.config不存在");var t=e.config.getData();t.then(function(t){if(e.citys=t.data,e.selectData){var i=e.selectData;e.$parent.selectData=[],e.selectData.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t].county==e||this[t].city==e)return t;return-1},i.map(function(t,i){if(t instanceof Object)return!1;if(t)var r=t.split("-");else var r="";var a=r[0],n=r[1];e.countyShow[a+n]=!0,e.selectData.push({county:n,city:a})}),e.surplus=e.selectData.length}},function(e){console.log("请求失败！"+e)}),e.maxSurplus||(e.$parent.maxSurplus=3),e.surplus=0,e.countyShow={},e.selectData.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t].county==e||this[t].city==e)return t;return-1},e.removeNoe=function(t,i){var r=e.selectData.indexOf(i);e.selectData.splice(r,1),e.countyShow[t+i]=!1,e.surplus=e.selectData.length},e.cityClick=function(t,i){e.cityIndex=t,e.nowKey=i,e.countys=e.citys[e.nowKey]},e.countyClick=function(t,i){1==e.maxSurplus&&e.selectData.length&&e.removeNoe(e.selectData[0].city,e.selectData[0].county),e.countyIndex=t,e.surplus>=e.maxSurplus&&e.selectData.indexOf(i)==-1||(e.countyShow[e.nowKey+i]=!e.countyShow[e.nowKey+i],e.countyShow[e.nowKey+i]?e.selectData.push({county:i,city:e.nowKey}):e.removeNoe(e.nowKey,i),e.surplus=e.selectData.length)}}).controller("categoryTab",function(e){return e.nowIndex=0,e.heardTabs?(e.title||console.log("父级不存在title属性!"),e.tabClick=function(t,i){return i!=e.nowIndex&&(e.nowIndex=i,e.heardTabs.map(function(e){e.hover=""}),t.hover="hover",e.$parent.$parent.nowTab=t,e.nowData&&(e.nowData.length=0),void(t.click&&t.click()))},void(e.heardTabs.length&&e.tabClick(e.heardTabs[0]))):(console.log("父级不存在heardTabs数据"),!1)}).controller("attachInfo",function(e){e.lists||console.log("父级$scope.lists不存在!"),e.noeType={icon:"ion-android-happy",text:""},e.removeFn=function(e){e&&e.remove&&(e.removeDom=!0)},e.addFn=function(){e.lists.push({icon:"ion-android-happy",text:e.noeType.text,remove:!0,checkBox:!0}),e.noeType.text="",e.addItemShow=!1}}).controller("shareController",function(e,t,i,r,a,n,o){r.shareWeChatFriend=function(){a.sharelink(0,"才商连联","您的好友:"+window.userInfo.nickname+"分享的信息","www/img/logoT.png",window.baseUrl.url+"#"+i.$$url)},r.shareWeChatFriendCircle=function(){a.sharelink(1,"才商连联","您的好友:"+window.userInfo.nickname+"分享的信息","www/img/logoT.png",window.baseUrl.url+"#"+i.$$url)},r.shareCoupleBack=function(){e.go("user-coupleBack")},r.shareEnroll=function(){a.sharelink(0,"后MBA|EMBA报名","后MBA|EMBA报名","www/img/slither/csllenroll_01.png",window.baseUrl.url+"#/previewEnroll")},n.fromTemplateUrl("templates/public/shareLayer.html",{scope:r}).then(function(e){r.modal=e;var t=r.modal.show,i=r.modal.hide;r.modal.hide=function(){r.modalHide=!0;var e=this;o(function(){i.apply(e)},400)},r.modal.show=function(){r.modalHide=!1,t.apply(this)}})}).controller("informationDisplay",function(e){e.phone=function(e){if(e)return e.substr(0,3)+"****"+e.substr(7,10)}}).directive("search",function(){return{restrict:"A",templateUrl:"./templates/public/search.html",replace:!0,controller:function(e,t,i,r){e.initText=t.attr("init-text"),e.searchKeyDown=function(){return e.servicesSearch?void e.servicesSearch(e.searchText,e):void r(function(){e.searchData.map(function(t){return t instanceof Object&&(new RegExp(e.searchText,"ig").test(t[e.searchMarking||"searchText"])?t.hide=!1:t.hide=!0,void(e.searchText||(t.hide=!1)))})},20)},e.searchData||console.log("$scope.searchData不存在")}}}).directive("ngAnimationEnd",function(){return{replace:!0,restrict:"A",link:function(e,t,i){t[0].addEventListener("webkitAnimationEnd",function(){i.ngAnimationEnd.split(";").map(function(t){var i=t.replace(/\(|\)+/gi,"");e[i]&&e[i]()})},!1)}}}).directive("input",function(){return{restrict:"E",controller:function($scope,$element,$attrs,$rootScope,$timeout){"datetime-local"!=$attrs.type&&"date"!=$attrs.type||$scope.$watch($attrs.ngModel,function(val){if(val){try{var date=eval("$rootScope."+$attrs.ngModel)}catch(e){return!1}if("datetime-local"==$attrs.type,!(date instanceof Date))switch($attrs.type){case"datetime-local":eval("$rootScope."+$attrs.ngModel+"=new Date('"+val+"')");break;case"date":eval("$rootScope."+$attrs.ngModel+"="+new Date(val).Format("yyyy-MM-dd"))}}})}}}).directive("ionHeaderBar",function(){return{restrict:"E",link:function(e,t,i){t.hasClass("bar-positive")||t.addClass("bar-positive")}}}).directive("imgAuto",function(){return{restrict:"A",link:function(e,t,i){t.on("load",function(){var e=angular.element(this).parent()[0],t=angular.element(this),i=this;t.css({opacity:0}),i.width/i.height>e.clientWidth/e.clientHeight?(t.css({width:"auto",height:"100%",display:"block"}),setTimeout(function(){t.css({marginLeft:-(i.width-e.clientWidth)/2+"px",opacity:1})},100)):(t.css({width:"100%",height:"auto",display:"block"}),setTimeout(function(){t.css({marginTop:-(i.height-e.clientHeight)/2+"px",opacity:1})},100))})}}}).directive("hideTabs",function(e){return{restrict:"A",link:function(t,i,r){t.$on("$ionicView.beforeEnter",function(){t.$watch(r.hideTabs,function(t){e.hideTabs=t})}),t.$on("$ionicView.beforeLeave",function(){e.hideTabs=!1,e.showNavBar=!1})}}}),angular.module("starter.publicDirective",[]).directive("textImages",function(){var e='      <div >        <div class="button-bar">          <a class="button">First</a>          <button class="button" ng-click="pickPicture()">            <i class="icon ion-images"></i>          </button>        </div>        <div class="row">          <textarea cols="100%" rows="10"></textarea>        </div>        <div class="row">          <div class="noeImage" ng-repeat="image in dataImages" ng-click="removeFn(image)" name="{{image.name}}">            <p class="imageBox"><img src="{{image.src}}"></p>            <i class="ion-android-close close"></i>            </div>          </div>      </div>    ';return{restrict:"E",scope:{},link:function(e,t,i){},controller:function(e,t,i,r,a,n,o,s){t.dataImages=[],t.pickPicture=function(){e.getPic(function(e){e&&t.$apply(function(){t.dataImages=o.Takeimages})})}},template:e}}).directive("fortest",function(){function e(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){t(e.target.result)}}var t,i='<div class="noeImage" ng-repeat="image in data.images" ng-click="removeFn(image)" name="{{image.name}}"><p class="imageBox"><img src="{{image.src}}"></p><i class="ion-android-close close"></i></div>',r='<div class="upload-photo-control">'+i+'<div class="noeImage"><p class="imageBox" ><img src="./img/othere/addIcon.jpg"></p><input type="file" class="init" id="addImage"></div></div>';return{restrict:"AE",template:r,replace:!0,scope:!0,controller:function(i,r,a,n,o,s,c){t=i.data||{},t.maxlength=t.maxlength||3,t.images=[];var l=document.getElementById("addImage");console.log(l);var u=angular.element(l);i.removeFn=function(e){var i=e.src,r=o.confirm({title:"确认删除这张图片吗？",template:'<p class="center">你将删除这张图片!</p><br><p class="center"><img src="'+i+'"  style="width:64px"></p>'});r.then(function(i){if(i){var r=e.name,a=-1;t.images.map(function(e,t){e.name==r&&(a=t)}),a!=-1&&t.images.splice(a,1)}})},i.addImageFn=function(r,a){var n={name:r.name};e(r,function(e){n.src=e,i.$apply(function(){return t.images.length>=t.maxlength?(o.alert({title:"已经超过图片上传张数",okText:"确认"}),!1):void t.images.push(n)}),console.log("更新了")})},i.change=function(){var e=this;if(!e.files||!e.files.length)return!1;var t=e.files[0];return/(\.jpg$|\.png$|\.jpeg|\.gif$)/gi.test(t.name)?(e.files=[],u.val(""),void i.addImageFn(t)):(o.alert({title:"您选择的不是图片！",template:'<p class="center">请重新选择！</p>'}),u.val(""),!1)},u.on("change",i.change),i.success=function(e){var r={name:file.name,src:e};i.$apply(function(){alert("成功"),alert(e),t.images.push(r)})},i.error=function(){alert("选择失败!")},i.selectImage=function(){c.show({buttons:[{text:"拍照"},{text:"图库"}],titleText:"请选择您的照片",cancelText:"取消",buttonClicked:function(e){switch(console.log(e),e){case 0:navigator.camera.getPicture(i.success,i.error,{quality:15,destinationType:0,sourceType:1,allowEdit:!0,encodingType:0,mediaType:0,saveToPhotoAlbum:!0});break;case 1:navigator.camera.getPicture(i.success,i.error,{quality:15,destinationType:0,sourceType:0,allowEdit:!0,encodingType:0,mediaType:0,saveToPhotoAlbum:!0})}}})}}}}).directive("attachInfo",function(){return{restrict:"A",templateUrl:"./templates/public/attachInfo-directive.html",replace:!1,scope:!0,controller:function(e){e.noeType={icon:"ion-android-happy",text:""},e.removeFn=function(e){e&&e.remove&&(e.removeDom=!0)},e.addFn=function(){e.lists.push({icon:"ion-android-happy",text:e.noeType.text,remove:!0,checkBox:!0}),e.noeType.text="",e.addItemShow=!1}}}}),angular.module("starter.publicFilter",[]).filter("noDuplicate",function(){return function(e,t){e=e||[];var i=[],r=[];return e.forEach(function(e){i.indexOf(e[t])==-1&&(i.push(e[t]),r.push(e))}),r}})(function(){RongIMLib.RongIMEmoji.init()})(),angular.module("starter.routes",[]).config(function(e,t,i){i.tabs.style("standard"),i.tabs.position("bottom"),i.navBar.alignTitle("center"),i.navBar.positionPrimaryButtons("left"),i.navBar.positionSecondaryButtons("right"),i.views.maxCache(10),e.state("tab",{url:"/tab","abstract":!0,templateUrl:"templates/tabs.html",controller:"AppCtrl"}).state("preview",{url:"/preview",templateUrl:"templates/public/slither.html",controller:"AppCtrl"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"LoginCtrl"}).state("fetch_password",{url:"/fetch_password",templateUrl:"templates/account/fetch_password.html",controller:"fetchPasswordCtrl"}).state("reset_password",{url:"/reset_password/:submit",templateUrl:"templates/account/reset_password.html",controller:"fetchPasswordCtrl"}).state("resetPassword_verify",{url:"/resetPassword_verify/:verify",templateUrl:"templates/account/register_verify.html",controller:"fetchPasswordCtrl"}).state("mobile_verify",{url:"/mobile_verify/:mobileVerify",templateUrl:"templates/account/mobile_verify.html",controller:"RegisterCtrl"}).state("register_new",{url:"/register_new",templateUrl:"templates/account/register_new.html",controller:"RegisterCtrl"}).state("register_verify",{url:"/register_verify/:verify/:mobileVerify",templateUrl:"templates/account/register_verify.html",controller:"RegisterCtrl"}).state("register_submit",{url:"/register_submit/:submit",templateUrl:"templates/account/register_submit.html",controller:"RegisterCtrl"}).state("previewEnroll",{url:"/previewEnroll",templateUrl:"templates/public/enroll.html",controller:"AppCtrl"}).state("enroll_register",{url:"/enroll_register",templateUrl:"templates/enroll/enroll_register.html",controller:"EnrollCtrl"}).state("enroll_verify",{url:"/enroll_verify/:verify/:mobileVerify",templateUrl:"templates/enroll/enroll_verify.html",controller:"EnrollCtrl"}).state("enroll_submit",{url:"/enroll_submit/:submit",templateUrl:"templates/enroll/enroll_submit.html",controller:"EnrollCtrl"}).state("enroll-addCircleInput",{url:"/enroll-addCircleInput/:id",templateUrl:"templates/enroll/enroll-addCircleInput.html",controller:"enrollAddCircleInput"}).state("tab.publish-saveInfoOk",{url:"/publish/saveInfoOk/:title-url_:url",views:{"tab-publish":{templateUrl:"templates/public/savePrompt.html",controller:"saveInfoOk"}}}).state("tab.publish-toHire",{url:"/publish-toHire-:source-:id",views:{"tab-publish":{templateUrl:"templates/publish/toHire-index.html",controller:"toHire"}}}).state("tab.publish-toHire-JobDescription",{url:"/publish-toHire/JobDescription/:type",views:{"tab-publish":{templateUrl:"templates/publish/toHire-JobDescription.html",controller:"jobDescription"}}}).state("tab.publish-toHire-selectTmp",{
url:"/publish-toHire/selectTmp/:type",views:{"tab-publish":{templateUrl:"templates/public/selectTmp.html",controller:"selectTmp"}}}).state("tab.publish-toHire-selectTrade",{url:"/publish-toHire/selectTrade",views:{"tab-publish":{templateUrl:"templates/public/selectTrade.html",controller:"selectTrade"}}}).state("tab.publish-toHire-technicalAbility",{url:"/publish-toHire/technicalAbility",views:{"tab-publish":{templateUrl:"templates/publish/toHire-technicalAbility.html",controller:"technicalAbility"}}}).state("tab.publish-toHire-yearlySalary",{url:"/publish-toHire/yearlySalary",views:{"tab-publish":{templateUrl:"templates/publish/toHire-yearlySalary.html",controller:"yearlySalary"}}}).state("tab.publish-toHire-jobCharacteristics",{url:"/publish-toHire/jobCharacteristics",views:{"tab-publish":{templateUrl:"templates/publish/toHire-jobCharacteristics.html",controller:"jobCharacteristics"}}}).state("tab.publish-toHire-preview",{url:"/publish-toHire/preview/:source/:id",views:{"tab-publish":{templateUrl:"templates/publish/toHire-preview.html",controller:"toHirePreview"}}}),e.state("tab.publish-activity",{url:"/publish-activity-:source-:id",views:{"tab-publish":{templateUrl:"templates/publish/activity-index.html",controller:"activity"}}}).state("tab.publish-activity-selectType",{url:"/publish-activity/selectType",views:{"tab-publish":{templateUrl:"templates/public/selectType.html",controller:"activitySelectType"}}}).state("tab.publish-activity-additionalRegistration",{url:"/publish-activity/additionalRegistration",views:{"tab-publish":{templateUrl:"templates/public/attachInfo.html",controller:"activityAdditionalRegistration"}}}).state("tab.publish-activity-teachingSatisfaction",{url:"/publish-activity/teachingSatisfaction",views:{"tab-publish":{templateUrl:"templates/public/attachInfo.html",controller:"activityTeachingSatisfaction"}}}).state("tab.publish-activity-satisfaction",{url:"/publish-activity/satisfaction",views:{"tab-publish":{templateUrl:"templates/public/attachInfo.html",controller:"activitySatisfaction"}}}).state("tab.publish-activity-saveInfoOk",{url:"/publish-activity/saveInfoOk",views:{"tab-publish":{templateUrl:"templates/public/savePrompt.html",controller:"activitySaveInfoOk"}}}).state("tab.publish-activity-preview",{url:"/publish-activity/preview/:source/:id",views:{"tab-publish":{templateUrl:"templates/publish/activity-preview.html",controller:"activityPreview"}}}),e.state("tab.publish-information",{url:"/publish-information-:source-:id",views:{"tab-publish":{templateUrl:"templates/publish/information-index.html",controller:"information"}}}).state("tab.publish-information-selectType",{url:"/publish-information/selectType",views:{"tab-publish":{templateUrl:"templates/public/selectType.html",controller:"informationSelectType"}}}).state("tab.publish-information-preview",{url:"/publish-information/preview/:source/:id",views:{"tab-publish":{templateUrl:"templates/publish/information-preview.html",controller:"informationPreview"}}}),e.state("tab.publish-investigate",{url:"/publish-investigate-:source-:id",views:{"tab-publish":{templateUrl:"templates/publish/investigate-index.html",controller:"investigate"}}}).state("tab.publish-investigate-selectType",{url:"/publish-investigate/selectType",views:{"tab-publish":{templateUrl:"templates/public/selectType.html",controller:"investigateSelectType"}}}).state("tab.publish-investigate-subject",{url:"/publish-investigate/subject/:sub",views:{"tab-publish":{templateUrl:"templates/publish/investigate-subject.html",controller:"investigateSubject"}}}),e.state("tab.user-index",{url:"/user/index",views:{"tab-user":{templateUrl:"templates/user/user-index.html",controller:"user"}}}).state("tab.user-info",{url:"/user/info",cache:!1,views:{"tab-user":{templateUrl:"templates/user/user-info.html",controller:"userInfo"}}}).state("tab.user-selectArea",{url:"/user/user-selectArea",views:{"tab-user":{templateUrl:"templates/public/selectTmp.html",controller:"userSelectArea"}}}).state("tab.reset_password",{url:"/user/reset_password/:submit",views:{"tab-user":{templateUrl:"templates/account/reset_password.html",controller:"fetchPasswordCtrl"}}}).state("tab.user-beGoodAt",{url:"/user/user-beGoodAt",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"userBeGoodAtSelectType"}}}).state("tab.user-interest",{url:"/user/user-interest",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"userInterestSelectType"}}}).state("tab.user-trade",{url:"/user/user-trade",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"userTradeSelectType"}}}).state("tab.user-occupation",{url:"/user/user-occupation",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"userOccupationSelectType"}}}).state("tab.user-language",{url:"/user/user-language",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"userLanguageSelectType"}}}).state("tab.user-projectExperience",{url:"/user/user-projectExperience/:sub",views:{"tab-user":{templateUrl:"templates/user/user-projectExperience.html",controller:"userProjectExperience"}}}).state("tab.user-workExperience",{url:"/user/user-workExperience/:sub",views:{"tab-user":{templateUrl:"templates/user/user-workExperience.html",controller:"userWorkExperience"}}}).state("tab.user-educationalBackground",{url:"/user/user-educationalBackground/:sub",views:{"tab-user":{templateUrl:"templates/user/user-educationalBackground.html",controller:"userEducationalBackground"}}}).state("tab.user-addressList",{url:"/user/user-addressList",views:{"tab-user":{templateUrl:"templates/user/user-addressList.html",controller:"userAddressList"}}}).state("tab.user-userOtherInfo",{url:"/user/user-userOtherInfo/:id",views:{"tab-user":{templateUrl:"templates/user/user-userOtherInfo.html",controller:"userOtherInfo"}}}).state("tab.user-partake",{url:"/user/user-partake",views:{"tab-user":{templateUrl:"templates/public/categoryTab.html",controller:"userPartake"}}}).state("tab.user-publish",{url:"/user/user-publish",cache:!1,views:{"tab-user":{templateUrl:"templates/public/categoryTab.html",controller:"userPublish"}}}).state("user-coupleBack",{url:"/user/user-coupleBack",cache:!1,templateUrl:"templates/user/user-coupleBack.html",controller:"userCoupleBack"}).state("tab.user-undergo",{url:"/user/user-undergo/:type",views:{"tab-user":{templateUrl:"templates/user/user-undergo.html",controller:"userUndergo"}}}).state("tab.user-moreInfo",{url:"/user/user-moreInfo",cache:!1,views:{"tab-user":{templateUrl:"templates/user/user-moreInfo.html",controller:"userMoreInfo"}}}).state("tab.user-signUp-detailed",{url:"/user/user-signUp-detailed/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-signUp-detailed.html",controller:"discoverSignUpDetailed"}}}).state("tab.user-signUp-input",{url:"/user/user-signUp-input/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-signUp-input.html",controller:"discoverSignUpInput"}}}).state("tab.user-signUp-activityEvaluation",{url:"/user/user-activityEvaluation/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-activityEvaluation.html",controller:"discoverActivityEvaluation"}}}).state("tab.user-toHire-more",{url:"/user/user-toHire/:id/:source",views:{"tab-user":{templateUrl:"templates/circle/circle-toHire.html",controller:"discoverToHireMore"}}}).state("tab.user-toHire-detailed",{url:"/user/user-toHire-detailed/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-toHire-detailed.html",controller:"discoverToHireDetailed"}}}).state("tab.user-user-userIfo",{url:"/user/user-toHire-userIfo/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-userInfo.html",controller:"discoverUserIfo"}}}).state("tab.user-questionnaire",{url:"/user-questionnaire/:id/:source",views:{"tab-user":{templateUrl:"templates/circle/circle-investigate.html",controller:"discoverQuestionnaire"}}}).state("tab.user-questionnaireSurvey",{url:"/user-questionnaireSurvey/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-questionnaireSurvey.html",controller:"discoverQuestionnaireSurvey"}}}).state("tab.user-question",{url:"/user-question/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-question.html",controller:"discoverQuestion"}}}).state("tab.user-answerDetails",{url:"/user-answerDetails/:id",views:{"tab-user":{templateUrl:"templates/discover/discover-answerDetails.html",controller:"discoverAnswerDetails"}}}).state("tab.user-information-more",{url:"/user-information/:id/:source",views:{"tab-user":{templateUrl:"templates/circle/circle-information.html",controller:"discoverInformation"}}}).state("tab.user-information-detailed",{url:"/user-information-detailed/:id/:source",views:{"tab-user":{templateUrl:"templates/discover/discover-information-detailed.html",controller:"discoverInformationDetailed"}}}).state("tab.user-map",{url:"/user-map/:id/:source/:address",views:{"tab-user":{templateUrl:"templates/discover/discover-map.html",controller:"discoverMap"}}}).state("tab.user-circle",{url:"/user/user-circle",views:{"tab-user":{templateUrl:"templates/public/circle.html",controller:"myCircle"}}}).state("tab.user-addCircle",{url:"/user-addCircle/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-addCircle.html",controller:"addCircle"}}}).state("tab.user-editCircle",{url:"/user-editCircle/:id/:type",views:{"tab-user":{templateUrl:"templates/circle/circle-addCircle.html",controller:"addCircle"}}}).state("tab.user-selectType",{url:"/user-selectType",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"circleSelectType"}}}).state("tab.user-termsForEntry",{url:"/user-termsForEntry",views:{"tab-user":{templateUrl:"templates/public/attachInfo.html",controller:"circleTermsForEntry"}}}).state("tab.user-enterTheCircle",{url:"/user-enterTheCircle/:name/:id",cache:!1,views:{"tab-user":{templateUrl:"templates/circle/circle-enterTheCircle.html",controller:"circleEnterTheCircle"}}}).state("tab.user-chat",{url:"/user-chat/:name/:id",views:{"tab-user":{templateUrl:"templates/public/chat.html",controller:"circleChat"}}}).state("tab.user-circleMembers",{url:"/user-circleMembers/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-circleMembers.html",controller:"circleCircleMembers"}}}).state("tab.user-member",{url:"/user-member/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-member.html",controller:"circleMember"}}}).state("tab.user-userInfo",{url:"/user-userInfo/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-userInfo.html",controller:"discoverUserIfo"}}}).state("tab.user-selectContacts",{url:"/user-selectContacts",views:{"tab-user":{templateUrl:"templates/circle/circle-selectContacts.html",controller:"circleSelectContacts"}}}).state("tab.user-notice",{url:"/user-notice/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-notice.html",controller:"circleNotice"}}}).state("tab.user-report",{url:"/user-report/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-circleReport.html",controller:"circleReport"}}}).state("tab.user-noticePage",{url:"/user-noticePage/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-noticePage.html",controller:"circleNoticePage"}}}).state("tab.user-manage",{url:"/user-manage/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-manage.html",controller:"circleManage"}}}).state("tab.user-examineAndVerify",{url:"/user-examineAndVerify/:id/:activityName",views:{"tab-user":{templateUrl:"templates/user/user-examineAndVerify.html",controller:"userExamineAndVerify"}}}).state("tab.activityApply-examineAndVerify",{url:"/activityApply-examineAndVerify/:id",views:{"tab-user":{templateUrl:"templates/user/user-examineAndVerify.html",controller:"activityApplyVerify"}}}).state("tab.user-addAContact",{url:"/user-addAContact/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-addAContact.html",controller:"circleAddAContact"}}}).state("tab.user-addCircleInput",{url:"/user-addCircleInput/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-addCircleInput.html",controller:"circleAddCircleInput",params:{id:"0"}}}}).state("tab.user-saveInfoOk",{url:"/user/saveInfoOk/:title-url_:url",views:{"tab-user":{templateUrl:"templates/public/savePrompt.html",controller:"saveInfoOk"}}}).state("tab.user-toHire",{url:"/user-toHire-:source-:id",views:{"tab-user":{templateUrl:"templates/publish/toHire-index.html",controller:"toHire"}}}).state("tab.user-toHire-JobDescription",{url:"/user-toHire/JobDescription/:type",views:{"tab-user":{templateUrl:"templates/publish/toHire-JobDescription.html",controller:"jobDescription"}}}).state("tab.user-toHire-selectTmp",{url:"/user-toHire/selectTmp/:type",views:{"tab-user":{templateUrl:"templates/public/selectTmp.html",controller:"selectTmp"}}}).state("tab.user-toHire-selectTrade",{url:"/user-toHire/selectTrade",views:{"tab-user":{templateUrl:"templates/public/selectTrade.html",controller:"selectTrade"}}}).state("tab.user-toHire-technicalAbility",{url:"/user-toHire/technicalAbility",views:{"tab-user":{templateUrl:"templates/publish/toHire-technicalAbility.html",controller:"technicalAbility"}}}).state("tab.user-toHire-yearlySalary",{url:"/user-toHire/yearlySalary",views:{"tab-user":{templateUrl:"templates/publish/toHire-yearlySalary.html",controller:"yearlySalary"}}}).state("tab.user-toHire-jobCharacteristics",{url:"/user-toHire/jobCharacteristics",views:{"tab-user":{templateUrl:"templates/publish/toHire-jobCharacteristics.html",controller:"jobCharacteristics"}}}).state("tab.user-toHire-preview",{url:"/user-toHire/preview/:source/:id",views:{"tab-user":{templateUrl:"templates/publish/toHire-preview.html",controller:"toHirePreview"}}}),e.state("tab.user-activity",{url:"/user-activity-:source-:id",views:{"tab-user":{templateUrl:"templates/publish/activity-index.html",controller:"activity"}}}).state("tab.user-activity-selectType",{url:"/user-activity/selectType",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"activitySelectType"}}}).state("tab.user-activity-selectTmp",{url:"/user-activity/selectTmp/:type",views:{"tab-user":{templateUrl:"templates/public/selectTmp.html",controller:"activitySelectTmp"}}}).state("tab.user-activity-additionalRegistration",{url:"/user-activity/additionalRegistration",views:{"tab-user":{templateUrl:"templates/public/attachInfo.html",controller:"activityAdditionalRegistration"}}}).state("tab.user-activity-teachingSatisfaction",{url:"/user-activity/teachingSatisfaction",views:{"tab-user":{templateUrl:"templates/public/attachInfo.html",controller:"activityTeachingSatisfaction"}}}).state("tab.user-activity-satisfaction",{url:"/user-activity/satisfaction",views:{"tab-user":{templateUrl:"templates/public/attachInfo.html",controller:"activitySatisfaction"}}}).state("tab.user-activity-saveInfoOk",{url:"/user-activity/saveInfoOk",views:{"tab-user":{templateUrl:"templates/public/savePrompt.html",controller:"activitySaveInfoOk"}}}).state("tab.user-activity-preview",{url:"/user-activity/preview/:source/:id",cache:!1,views:{"tab-user":{templateUrl:"templates/publish/activity-preview.html",controller:"activityPreview"}}}),e.state("tab.user-information",{url:"/user-information-:source-:id",views:{"tab-user":{templateUrl:"templates/publish/information-index.html",controller:"information"}}}).state("tab.user-information-selectType",{url:"/user-information/selectType",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"informationSelectType"}}}).state("tab.user-information-preview",{url:"/user-information/preview/:source/:id",views:{"tab-user":{templateUrl:"templates/publish/information-preview.html",controller:"informationPreview"}}}),e.state("tab.user-investigate",{url:"/user-investigate-:source-:id",views:{"tab-user":{templateUrl:"templates/publish/investigate-index.html",controller:"investigate"}}}).state("tab.user-investigate-selectType",{url:"/user-investigate/selectType",views:{"tab-user":{templateUrl:"templates/public/selectType.html",controller:"investigateSelectType"}}}).state("tab.user-investigate-subject",{url:"/user-investigate/subject/:sub",views:{"tab-user":{templateUrl:"templates/publish/investigate-subject.html",controller:"investigateSubject"}}}).state("tab.user-candidates",{url:"/user-candidates/:id",views:{"tab-user":{templateUrl:"templates/user/user-candidates.html",controller:"userCandidates"}}}).state("tab.user-candidatesUserInfo",{url:"/user-candidatesUserInfo/:id",views:{"tab-user":{templateUrl:"templates/user/user-candidatesUserInfo.html",controller:"userCandidatesUserInfo"}}}).state("tab.user-selectTmp",{url:"/user-selectDuty",views:{"tab-user":{templateUrl:"templates/public/selectTmp.html",controller:"userSelectDuty"}}}).state("tab.user-selectTrade",{url:"/user-selectTrade",views:{"tab-user":{templateUrl:"templates/public/selectTrade.html",controller:"userSelectTrade"}}}).state("tab.user-signIn",{url:"/user-signIn/:id",views:{"tab-user":{templateUrl:"templates/user/user-signIn.html",controller:"userSignIn"}}}).state("tab.user-newFriend",{url:"/user-newFriend",views:{"tab-user":{templateUrl:"templates/user/user-newFriend.html",controller:"userNewFriend"}}}).state("tab.user-evaluate",{url:"/user-evaluate/:id",views:{"tab-user":{templateUrl:"templates/user/user-evaluate.html",controller:"userActivityEvaluate"}}}),e.state("tab.discover-specilist",{url:"/discover/discover-specilist",views:{"tab-discover":{templateUrl:"templates/public/selectType.html",controller:"discoverSpecialist"}}}).state("tab.discover-addressList",{url:"/discover/discover-addressList",views:{"tab-discover":{templateUrl:"templates/discover/discover-members.html",controller:"discoverAddressList"}}}).state("tab.discover-index",{url:"/discover/index",views:{"tab-discover":{templateUrl:"templates/discover/discover-index.html",controller:"discover"}}}).state("tab.discover-activity",{url:"/discover-activity",views:{"tab-discover":{templateUrl:"templates/discover/discover-activity-more.html",controller:"discoverActivity"}}}).state("tab.discover-selectArea",{url:"/discover/discover-selectArea",views:{"tab-discover":{templateUrl:"templates/public/selectTmp.html",controller:"discoverSelectArea"}}}).state("tab.discover-signUp-detailed",{url:"/discover/discover-signUp-detailed/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-signUp-detailed.html",controller:"discoverSignUpDetailed"}}}).state("tab.discover-signUp-input",{url:"/discover/discover-signUp-input/:id/:source/:activityName/:creatorId",views:{"tab-discover":{templateUrl:"templates/discover/discover-signUp-input.html",controller:"discoverSignUpInput"}}}).state("tab.discover-signUp-activityEvaluation",{url:"/discover/discover-activityEvaluation/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-activityEvaluation.html",controller:"discoverActivityEvaluation"}}}).state("tab.discover-toHire-more",{url:"/discover/discover-toHire-more",views:{"tab-discover":{templateUrl:"templates/discover/discover-toHire-more.html",controller:"discoverToHireMore"}}}).state("tab.discover-toHire-detailed",{url:"/discover/discover-toHire-detailed/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-toHire-detailed.html",controller:"discoverToHireDetailed"}}}).state("tab.discover-user-userIfo",{url:"/discover/discover-toHire-userIfo/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-userInfo.html",controller:"discoverUserIfo"}}}).state("tab.discover-questionnaire",{url:"/discover-questionnaire",views:{"tab-discover":{templateUrl:"templates/public/categoryTab.html",controller:"discoverQuestionnaire"}}}).state("tab.discover-questionnaireSurvey",{url:"/discover-questionnaireSurvey/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-questionnaireSurvey.html",controller:"discoverQuestionnaireSurvey"}}}).state("tab.discover-question",{url:"/discover-question/:sub",views:{"tab-discover":{templateUrl:"templates/discover/discover-question.html",controller:"discoverQuestion"}}}).state("tab.discover-answerDetails",{url:"/discover-answerDetails/:id",views:{"tab-discover":{templateUrl:"templates/discover/discover-answerDetails.html",controller:"discoverAnswerDetails"}}}).state("tab.discover-information-more",{url:"/discover-information-more",views:{"tab-discover":{templateUrl:"templates/public/categoryTab.html",controller:"discoverInformation"}}}).state("tab.discover-information-detailed",{url:"/discover-information-detailed/:id/:source",views:{"tab-discover":{templateUrl:"templates/discover/discover-information-detailed.html",controller:"discoverInformationDetailed"}}}).state("tab.discover-map",{url:"/discover-map/:id/:source/:address",views:{"tab-discover":{templateUrl:"templates/discover/discover-map.html",controller:"discoverMap"}}}).state("tab.discover-activity-selectType",{url:"/discover-activity/selectType",views:{"tab-discover":{templateUrl:"templates/public/selectType.html",controller:"activitySelectType"}}}),e.state("tab.circle-index",{url:"/circle/index",views:{"tab-circle":{templateUrl:"templates/circle/circle-index.html",controller:"circle"}}}).state("tab.circle-myCircle",{url:"/circle-myCircle",views:{"tab-circle":{templateUrl:"templates/public/circle.html",controller:"myCircle"}}}).state("tab.circle-participateCircle",{url:"/circle-participateCircle",views:{"tab-circle":{templateUrl:"templates/public/circle.html",controller:"myParticipateCircle"}}}).state("tab.circle-hotCircle",{url:"/circle-hotCircle",cache:!1,views:{"tab-circle":{templateUrl:"templates/public/circle.html",controller:"hotCircle"}}}).state("tab.circle-addCircle",{url:"/circle-addCircle/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-addCircle.html",controller:"addCircle"}}}).state("tab.circle-noticeDetail",{url:"/circle-noticeDetail/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-noticeDetail.html",controller:"circleNoticeDetail"}}}).state("tab.circle-circleArea",{url:"/circle-circleArea",views:{"tab-circle":{templateUrl:"templates/public/selectTmp.html",controller:"circleSelectArea"}}}).state("tab.circle-selectType",{url:"/circle-selectType",views:{"tab-circle":{templateUrl:"templates/public/selectType.html",controller:"circleSelectType"}}}).state("tab.circle-termsForEntry",{url:"/circle-termsForEntry",views:{"tab-circle":{templateUrl:"templates/public/attachInfo.html",controller:"circleTermsForEntry"}}}).state("tab.circle-addCircleInput",{url:"/circle-addCircleInput/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-addCircleInput.html",controller:"circleAddCircleInput"}}}).state("tab.circle-enterTheCircle",{url:"/circle-enterTheCircle/:name/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-enterTheCircle.html",controller:"circleEnterTheCircle",params:{name:"circle",id:0}}}}).state("tab.circle-chat",{url:"/circle-chat/:name/:id",views:{"tab-circle":{templateUrl:"templates/public/chat.html",controller:"circleChat"}}}).state("tab.circle-circleMembers",{url:"/circle-circleMembers/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-circleMembers.html",controller:"circleCircleMembers"}}}).state("tab.circle-member",{url:"/circle-member/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-member.html",controller:"circleMember"}}}).state("tab.circle-userInfo",{url:"/circle-userInfo/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-userInfo.html",controller:"circleUserInfo"}}}).state("tab.circle-selectContacts",{url:"/circle-selectContacts/:name/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-selectContacts.html",controller:"circleAddressList"}}}).state("tab.circle-addressList",{url:"/circle/circle-addressList",views:{"tab-circle":{templateUrl:"templates/user/user-addressList.html",controller:"circleAddressList"}}}).state("tab.circle-notice",{url:"/circle-notice/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-notice.html",controller:"circleNotice"}}}).state("tab.circle-report",{url:"/circle-report/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-circleReport.html",controller:"circleReport"}}}).state("tab.circle-noticePage",{url:"/circle-noticePage/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-noticePage.html",controller:"circleNoticePage"}}}).state("tab.circle-activity",{url:"/circle-activity/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-activity.html",controller:"circleActivity"}}}).state("tab.circle-selectArea",{url:"/circle/circle-selectArea/:source",views:{"tab-circle":{templateUrl:"templates/public/selectTmp.html",controller:"discoverSelectArea"}}}).state("tab.circle-signUp-detailed",{url:"/circle/circle-signUp-detailed/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-signUp-detailed.html",controller:"discoverSignUpDetailed"}}}).state("tab.circle-signUp-input",{url:"/circle/circle-signUp-input/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-signUp-input.html",controller:"discoverSignUpInput"}}}).state("tab.circle-signUp-activityEvaluation",{url:"/circle/circle-activityEvaluation/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-activityEvaluation.html",controller:"discoverActivityEvaluation"}}}).state("tab.circle-toHire",{url:"/circle/circle-toHire/:id/:source",views:{"tab-circle":{templateUrl:"templates/circle/circle-toHire.html",controller:"discoverToHireMore"}}}).state("tab.circle-toHire-detailed",{url:"/circle/circle-toHire-detailed/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-toHire-detailed.html",controller:"discoverToHireDetailed"}}}).state("tab.circle-user-userIfo",{url:"/circle/circle-toHire-userIfo/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-userInfo.html",controller:"discoverUserIfo"}}}).state("tab.circle-questionnaire",{url:"/circle-questionnaire/:id/:source",views:{"tab-circle":{templateUrl:"templates/circle/circle-investigate.html",controller:"discoverQuestionnaire"}}}).state("tab.circle-questionnaireSurvey",{url:"/circle-questionnaireSurvey/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-questionnaireSurvey.html",controller:"discoverQuestionnaireSurvey"}}}).state("tab.circle-answerDetails",{url:"/circle-answerDetails/:id",views:{"tab-circle":{templateUrl:"templates/discover/discover-answerDetails.html",controller:"discoverAnswerDetails"}}}).state("tab.circle-question",{url:"/circle-question/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-question.html",controller:"discoverQuestion"}}}).state("tab.notice-candidatesUserInfo",{url:"/notice-candidatesUserInfo/:id",views:{"tab-chat":{templateUrl:"templates/user/user-candidatesUserInfo.html",controller:"userCandidatesUserInfo"}}}).state("tab.notice-user-examineAndVerify",{url:"/notice-user-examineAndVerify/:id/:activityName",views:{"tab-chat":{templateUrl:"templates/user/user-examineAndVerify.html",controller:"userExamineAndVerify"}}}).state("tab.chat-signUp-detailed",{url:"/chat/discover-signUp-detailed/:id/:source",views:{"tab-chat":{templateUrl:"templates/discover/discover-signUp-detailed.html",controller:"discoverSignUpDetailed"}}}).state("tab.notice-circle-examineAndVerify",{url:"/notice-circle-examineAndVerify/:id",views:{"tab-chat":{templateUrl:"templates/circle/circle-examineAndVerify.html",controller:"circleExamineAndVerify"}}}).state("tab.circle-information",{url:"/circle-information/:id/:source",views:{"tab-circle":{templateUrl:"templates/circle/circle-information.html",controller:"discoverInformation"}}}).state("tab.circle-information-detailed",{url:"/circle-information-detailed/:id/:source",views:{"tab-circle":{templateUrl:"templates/discover/discover-information-detailed.html",controller:"discoverInformationDetailed"}}}).state("tab.circle-map",{url:"/circle-map/:id/:source/:address",views:{"tab-circle":{templateUrl:"templates/discover/discover-map.html",controller:"discoverMap"}}}).state("tab.circle-manage",{url:"/circle-manage/:name/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-manage.html",controller:"circleManage"},params:{name:"circle",id:0}}}).state("tab.circle-examineAndVerify",{url:"/circle-examineAndVerify/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-examineAndVerify.html",controller:"circleExamineAndVerify"}}}).state("tab.circle-addAContact",{url:"/circle-addAContact/:name/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-addAContact.html",controller:"circleAddAContact"}}}).state("tab.circle-circle-message",{url:"/circle-circle-message/:id",views:{"tab-circle":{templateUrl:"templates/circle/circle-message.html",controller:"circleMessage"}}}).state("tab.user-circle-message",{url:"/user-circle-message/:id",views:{"tab-user":{templateUrl:"templates/circle/circle-message.html",controller:"circleMessage"}}}),e.state("tab.chat-index",{url:"/chat-index",cache:!1,views:{"tab-chat":{templateUrl:"templates/chat/chat-index.html",controller:"chat"}}}).state("tab.message_detail",{url:"/message_detail/:messageId:noReadMessages",views:{"tab-chat":{templateUrl:"templates/chat/message_detail.html",controller:"MessageDetailCtrl"}}}).state("tab.chat-newFriend",{url:"/chat-newFriend",views:{"tab-chat":{templateUrl:"templates/user/user-newFriend.html",controller:"userNewFriend"}}}).state("tab.chat-newCircle",{url:"/chat-newCircle",views:{"tab-chat":{templateUrl:"templates/chat/chat-newCircle.html",controller:"chatNewCircle"}}}).state("tab.chat-addressList",{url:"/chat-user-addressList",views:{"tab-chat":{templateUrl:"templates/chat/user-addressList.html",controller:"userAddressList"}}}).state("tab.chat-sysNotice",{url:"/chat-sysNotice",views:{"tab-chat":{templateUrl:"templates/chat/sysNotice.html",controller:"sysNoticeCtrl"}}}).state("tab.chat-userOtherInfo",{url:"/chat/user-userOtherInfo/:id",views:{"tab-chat":{templateUrl:"templates/user/user-userOtherInfo.html",controller:"chatUserOtherInfo"}}}).state("tab.user-message",{url:"/user-message/:messageId:isFromMe",views:{"tab-user":{templateUrl:"templates/chat/message_detail.html",controller:"MessageDetailCtrl",params:{messageId:"some default",isFromMe:0}}}}).state("tab.member-message",{url:"/member-message/:messageId:isFromMe",views:{"tab-circle":{templateUrl:"templates/chat/message_detail.html",controller:"MessageDetailCtrl",params:{messageId:"some default",isFromMe:0}}}}).state("tab.discover-message",{url:"/discover/message_detail/:messageId:isFromMe",views:{"tab-discover":{templateUrl:"templates/chat/message_detail.html",controller:"MessageDetailCtrl",params:{messageId:"some default",isFromMe:0}}}}),t.otherwise("tab/discover/index")}),angular.module("starter.Services",[]).constant("baseUrl",{url:"http://www.caishangll.com:8081/"}).factory("DataHand",["$http","$q","$ionicLoading",function(e,t,i){return i.show({content:"Loading",animation:"fade-in"}),{Sdata:function(t,r,a,n){var o={},s={};return a&&(o=a),n&&(s=n),"post"==t?e({method:t,url:baseUrl.url+"service",data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{action:r,param:s}}).success(function(){i.hide()}).error(function(){i.hide()}):e({method:t,url:baseUrl.url+"service",params:{action:r,data:o,param:s}}).success(function(){i.hide()}).error(function(){i.hide()})},datajsp:function(t,i){return e.jsonp("",{cache:!1})}}}]).factory("rDataHand",["$http","$q",function(e,t){return{Sdata:function(t,i,r,a){var n={},o={};return r&&(n=r),a&&(o=a),e({method:t,url:baseUrl.url+"service",params:{action:i,data:n,param:o}}).then(function(e){return e.data})},datajsp:function(t,i){return e.jsonp("",{cache:!1})}}}]).factory("localStorageService",[function(){return{get:function(e,t){var i=localStorage.getItem(e);try{i=angular.fromJson(i)}catch(r){i=null}return t&&null===i&&(i=t),i},update:function(e,t){if(t)try{localStorage.setItem(e,angular.toJson(t))}catch(i){alert("您处于无痕浏览，无法为您保存")}},clear:function(e){
localStorage.removeItem(e)}}}]).factory("pickPic",["$timeout","$rootScope","$q","$ionicActionSheet","$cordovaImagePicker","$ionicLoading",function(e,t,i,r,a,n){function o(t){function i(i){if(i){var r,a=(new Date).getTime(),n=i.split(".");r=baseUrl.url+"uploads/"+a+"."+n[n.length-1];var o={name:a,src:i,tsrc:r};t(o),e(function(){c.push(o)},500)}}function r(e){}var a={quality:80,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0};navigator.camera.getPicture(i,r,a)}function s(e){var i={quality:80,maximumImagesCount:5,width:300,height:500,allowEdit:!0};a.getPictures(i).then(function(i){if(i[0]){t.takeImages=i;for(var r=i.length,a=(new Date).getTime(),n=0;n<r;n++){var o,s=a+n,l=i[n].split(".");o=baseUrl.url+"uploads/"+s+"."+l[l.length-1];var u={name:s,src:i[n],tsrc:o};e(u),c.push(u)}}},function(e){alert("Failed:"+e)})}var c=[];return{getPic:function(e,t){if(t=t||function(){},!e)return void alert("没有传递imagesArray对象");c=e;r.show({buttons:[{text:"<b>拍照</b> 上传"},{text:"从 <b>相册</b> 中选"}],titleText:"图片上传",cancelText:"取 消",cancel:function(){},buttonClicked:function(e){return 1==e?s(t):0==e&&o(t),!0}})},upLoad:function(e,t){t=t||function(){};for(var i=baseUrl.url+"upload",r=e instanceof Array?e:c,a=r?r.length:0,o=0;o<a;o++){var s=r[o].name,l="./uploads",u=new FileTransfer,d=new FileUploadOptions;d.fileKey="file",d.fileName="filename.jpg",d.mimeType="image/jpeg",d.chunkedMode=!1,d.params={path:l,filename:s,action:"upload_file"},n.show(),function(e){try{u.upload(r[o].src,encodeURI(i),function(i){n.hide(),t(e)},function(e){n.hide(),console.log("uploaderr:"+i),t(0);var i="err:";for(var r in e)i+=r+":"+e[r]+";";console.log("uploaderr:"+i)},d)}catch(a){console.log("not modified pictures")}}(r[o])}}}}]).factory("WeChat",["$http","$q",function(e,t){return{payment:function(){var e={mch_id:"10000100",prepay_id:"wx201411101639507cbf6ffd8b0779950874",nonce:"1add1a30ac87aa2db72f57a2375d8fec",timestamp:"1439531364",sign:"0CB01533B8C1EF103065174F50BCA001"};return Wechat.sendPaymentRequest(e,function(){},function(e){}),null},auth:function(t){var i="snsapi_userinfo";return Wechat.auth(i,function(i){e({method:"GET",url:"https://api.weixin.qq.com/sns/oauth2/access_token",params:{appid:"wx79bcf8b025734922",secret:"c7dccf003f3603c54f4f8cc252c41656",code:i.code,grant_type:"authorization_code"}}).then(function(i){e({method:"GET",url:"https://api.weixin.qq.com/sns/userinfo",params:{access_token:i.data.access_token,openid:i.data.openid}}).then(function(e){t(e.data)})})},function(e){}),null},check:function(e){return Wechat.isInstalled(function(t){e(t)},function(e){console.log(e)}),null},sharelink:function(e,t,i,r,a){return Wechat.share({message:{title:t,description:i,thumb:r,mediaTagName:"TEST-TAG-001",messageExt:"这是第三方带的测试字段",messageAction:"<action>dotalist</action>",media:{type:Wechat.Type.LINK,webpageUrl:a}},scene:e},function(){},function(e){alert("Failed: "+e)}),null}}}]).factory("ShowM",["$q","$ionicPopup",function(e,t){return{showAlert:function(e,i){var r=t.alert({title:e,template:i});r.then(function(e){})},showConfirm:function(e,i){var r=t.confirm({title:e,template:i});return r.then(function(e){return!!e}),r}}}]).factory("mapGps",function(){return{map:function(e,t){function i(e){var t=function(e){n(e)},i=new BMap.Point(e.coords.longitude,e.coords.latitude);BMap.Convertor.translate(i,0,t)}function r(e){switch(e.code){case 1:alert("您拒绝了使用位置共享服务，请手动输入地址。!");break;default:alert("获取位置失败，请手动输入您的地址。!")}}function a(e){var t=new BMap.Geocoder;t.getPoint(e,function(e){e&&n(e)},"全国")}function n(t){var i;i=new BMap.Map("mapdiv"),i.addControl(new BMap.NavigationControl);var r=new BMap.Geocoder;i.centerAndZoom(t,16),i.addOverlay(new BMap.Marker(t)),i.addEventListener("click",function(t){var a=t.point;r.getLocation(a,function(r){var a=r.addressComponents;i.clearOverlays(),i.addOverlay(new BMap.Marker(t.point)),e.$apply(function(){e.map.address=a.city+a.district+a.street+a.streetNumber})})})}e.map.address>""?a(e.map.address):navigator.geolocation.getCurrentPosition(i,r,{enableHighAccuracy:!0})}}}).factory("Gpsfun",function(){return{getgps:function(e){function t(e){var t=function(e){var t;t=new BMap.Map("mapdiv"),t.addControl(new BMap.NavigationControl);new BMap.Geocoder;t.centerAndZoom(e,16),t.addOverlay(new BMap.Marker(e))},i=new BMap.Point(e.coords.longitude,e.coords.latitude);BMap.Convertor.translate(i,0,t)}function i(e){switch(alert("code: "+e.code+"\nmessage: "+e.message+"\n"),e.code){case 1:alert("您拒绝了使用位置共享服务，请手动输入地址。!");break;default:alert("获取位置失败，请手动输入您的地址。!")}}navigator.geolocation.getCurrentPosition(t,i,{enableHighAccuracy:!0})}}}).factory("rongIM",["$http","$q",function(e,t,i){return{initRong:function(e){i.arrMsgs=[],i.arrCons=[],RongCloudLibPlugin.init({appKey:m7ua80gbu9wcm},function(e,t){e&&console.log("init:"+JSON.stringify(e)),t&&console.log("init error:"+JSON.stringify(t))}),RongCloudLibPlugin.setConnectionStatusListener(function(e,t){e&&(console.log("setConnectionStatusListener:"+JSON.stringify(e)),"KICKED"==e.result.connectionStatus&&(alert("您的帐号已在其他端登录!"),i.hideTabs=!1,$ionicHistory.clearCache(),$state.go("login"))),t&&console.log("setConnectionStatusListener error:"+JSON.stringify(t))}),RongCloudLibPlugin.connect({token:e},function(e,t){e&&(console.log("connect:"+JSON.stringify(e)),i.curUID=e.result.userId,i.$apply(),myUtil.setUserId(e.result.userId),$state.go("tab.friends",{userId:e.result.userId},{reload:!0})),t&&console.log("init error:"+JSON.stringify(t))}),RongCloudLibPlugin.setOnReceiveMessageListener(function(e,t){e&&(console.log("setOnReceiveMessageListener:"+JSON.stringify(e)),i.arrMsgs.push(JSON.stringify(e.result.message)),i.$apply()),t&&console.log("setOnReceiveMessageListener error:"+JSON.stringify(t))})}}}]),angular.module("starter.publishActivityControllers",[]).controller("activity",function(e,t,i,r,a,n,o,s,c,l,u){function d(t){e.fromTemplateUrl(t,{scope:a,animation:"slide-in-up"}).then(function(e){a.modal=e,a.modal.show()})}function p(){n.activityEphemeralData?l.delObj(n.activityEphemeralData):(n.activityEphemeralData={},a.data={},n.activityEphemeralData["活动详情"]=a.data)}function m(){a.source=o.source,a.id=o.id;var e=s.getInfo(o);e?e.success(function(e){l.correspondingKey(s.infoTransform,e,!0),n.activityEphemeralData=JSON.parse(JSON.stringify(e instanceof Object?e:{})),a.data=n.activityEphemeralData["活动详情"],a.data.images=n.activityEphemeralData.images,a.data.images||(a.data.images=n.activityEphemeralData["活动详情"].images)}).error(function(e){u.show({title:"草稿数据获取错误",buttons:[{text:"确认",type:"button-default",onTap:function(){}},{text:"重新获取",type:"button-positive",onTap:m}]}),p()}):p()}n.submitInformation=!0,a.htmlVariable={},a.map={},a.map.address="",a.location=function(){d("templates/modal/mapModal.html"),a.mapIni()},a.mapIni=function(){t.map(a)},a.closeModal=function(){n.activityEphemeralData["线下活动地址"]=a.map.address,a.modal.remove()},"user"==n.pageMarking&&m(),a.data=n.activityEphemeralData=s.template,s.$stateParams=o,s.indexUrl="#"+c.$$url;var f=s.activityKind.getActivityKind();f?f.success(function(e){a.activityKind=e,a.nowSelectData=a.activityKind[0]}):(a.activityKind=["内部","公开"],a.nowSelectData=a.activityKind[0]),a.source=o.source,a.id=o.id,n.pageMarking="circle"==o.source?"publish":o.source,a.toolClick=function(){var e=s.saveInfo(l.newObject(n.activityEphemeralData),o.source,o.id);window.a=n.activityEphemeralData,e?e.success(function(){u.show({title:"信息保存成功",buttons:[{text:"确认",type:"button-positive"}]})}).error(function(){u.show({title:"信息保存失败",buttons:[{text:"确认",type:"button-positive"}]})}):u.show({title:"信息保存未保存",buttons:[{text:"确认",type:"button-positive"}]})}}).controller("activitySelectType",function(e,t,i,r,a){e.title="选择活动类型",e.selectTypeText="选择类型";var n="选择类型";"discover"==t.pageMarking?e.maxSurplus=3:e.maxSurplus=1,t.activityEphemeralData=t.activityEphemeralData?t.activityEphemeralData:{},e.selectData=t.activityEphemeralData[n]?t.activityEphemeralData[n]:[],e.elementShow={};var o=r.activitySelectType.getData();o.success(function(t){e.typeDatas=t}),a.bindNavTool({rightText:"保存",toolClick:function(){t.activityEphemeralData[n]=e.selectData,t.backClick()}},e)}).controller("activityAdditionalRegistration",function(e,t,i){e.title="报名附加信息",e.heardTitle="设置报名附加信息",t.activityEphemeralData["报名附加信息"]&&t.activityEphemeralData["报名附加信息"].length?e.lists=t.activityEphemeralData["报名附加信息"]:e.lists=[{icon:"ion-android-person",text:"姓名",checkBox:!0},{icon:"ion-android-phone-portrait",text:"手机",checkBox:!0},{icon:"ion-android-happy",text:"公司"},{icon:"ion-android-happy",text:"邮箱"}];var r="报名附加信息";i.bindNavTool({rightText:"保存",toolClick:function(){t.activityEphemeralData[r]=e.lists,t.backClick()}},e)}).controller("activitySelectTmp",function(e,t,i,r,a,n,o){console.log("selectTmp");var s=r.$current.name+"-"+e.type;console.log(s);var c=n.selectTmpServices;t.type=s,t.config=c.config[e.type];var l=t.config.title;t.maxSurplus=1,window.$scope=t,console.log(i.activityEphemeralData[l]),i.activityEphemeralData[l],t.selectData=i.activityEphemeralData[l]||[],o.bindNavTool({rightText:"保存",toolClick:function(){i.activityEphemeralData[l]=[],console.log(t.selectData),t.selectData.map(function(e,t){i.activityEphemeralData[l].push(e.city+"-"+e.county)}),i.backClick()}},t)}).controller("activityTeachingSatisfaction",function(e,t,i){e.title="授课满意度评价",e.heardTitle="授课老师满意度评价",t.activityEphemeralData["授课满意度"]&&t.activityEphemeralData["授课满意度"].length?e.lists=t.activityEphemeralData["授课满意度"]:e.lists=[{icon:"ion-android-happy",text:"理论底蕴"},{icon:"ion-android-happy",text:"专业能力"},{icon:"ion-android-happy",text:"实操能力"},{icon:"ion-android-happy",text:"表达能力"},{icon:"ion-android-happy",text:"授课效果"}];var r="授课满意度";i.bindNavTool({rightText:"保存",toolClick:function(){t.activityEphemeralData[r]=e.lists,t.backClick(),console.log(e.lists)}},e)}).controller("activitySatisfaction",function(e,t,i){e.title="活动满意度评价",e.heardTitle="本次活动满意度评价",t.activityEphemeralData["活动满意度评价"]&&t.activityEphemeralData["活动满意度评价"].length?e.lists=t.activityEphemeralData["活动满意度评价"]:e.lists=[{icon:"ion-android-happy",text:"时间安排"},{icon:"ion-android-happy",text:"地点安排"},{icon:"ion-android-happy",text:"主题安排"},{icon:"ion-android-happy",text:"活动内容"},{icon:"ion-android-happy",text:"活动组织"},{icon:"ion-android-happy",text:"活动效果"},{icon:"ion-android-happy",text:"总体评价"}];var r="活动满意度评价";i.bindNavTool({rightText:"保存",toolClick:function(){t.activityEphemeralData[r]=e.lists,t.backClick()}},e)}).controller("activitySaveInfoOk",function(e){}).controller("activityPreview",function(e,t,i,r,a,n,o,s,c){console.log(a.activityEphemeralData),r.publishEvent=function(){if(!r.disabled){r.disabled=!0;var e="",t=!1;if(a.activityEphemeralData["选择类型"]||(e+="活动类型未选择<br>",t=!0),a.activityEphemeralData["活动主题"]||(e+="活动主题未填写！<br>",t=!0),a.activityEphemeralData["线下活动地址"]||a.activityEphemeralData["线上活动"]||(e+="活动方式未选择！<br>",t=!0),a.activityEphemeralData["线上活动"]||a.activityEphemeralData["线下活动地址"]||(e+="线下活动地址填写！<br>",t=!0),isNaN(+a.activityEphemeralData["活动人数上限"])&&(e+="活动人数上限输入有误或未输入！<br>",t=!0),isNaN(+a.activityEphemeralData["活动费用"])&&(e+="活动费用输入有误或未输入！<br>",t=!0),a.activityEphemeralData["活动性质"]||(e+="活动性质未选择！<br>",t=!0),a.activityEphemeralData["报名附加信息"]&&a.activityEphemeralData["报名附加信息"].length>0||(e+="报名附加信息未选择！<br>",t=!0),a.activityEphemeralData["活动详情"].text||(e+="活动详情未填写！<br>",t=!0),+a.activityEphemeralData["活动开始时间"]>+a.activityEphemeralData["活动结束时间"]&&(e+="活动开始时间大于结束时间！<br>",t=!0),+a.activityEphemeralData["活动结束时间"]<+a.activityEphemeralData["报名截止时间"]&&(e+="活动结束时间小于报名截止时间！<br>",t=!0),t)return c.show({title:"页面信息缺省",template:e,buttons:[{text:"确认",type:"button-positive"}]}),void(r.disabled=!1);a.activityEphemeralData.createTime=new Date;var i=o.publishInfo(s.newObject(a.activityEphemeralData),n.source,n.id);i&&(i?i.success(function(){c.show({title:"信息发布成功",buttons:[{text:"确认",type:"button-positive"}]}),r.disabled=!1,a.submitInformation=!1,a.go("tab.discover-index","discover"),s.delObj(a.activityEphemeralData)}).error(function(){c.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})}):c.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]}))}}}),angular.module("starter.publishActivityDirective",[]).directive("formatDate",function(){return{require:"ngModel",link:function(e,t,i,r){r.$formatters.push(function(e){if(e)return new Date(e)}),r.$parsers.push(function(e){if(e)return $filter("date")(e,"yyyy-MM-dd")})}}}).directive("uploadPhotoControl",function(){var e,t='<div class="noeImage" ng-repeat="image in data.images" ng-click="removeFn(image)" name="{{image.name}}"><p class="imageBox"><img src="{{image.src}}" img-auto tsrc="{{image.tsrc}}" onerror="window.imageError(this)"></p><i class="ion-android-close close"></i></div>',i='<div class="upload-photo-control">'+t+'<div class="noeImage" ng-click="selectPicture()"><p class="imageBox" ><img src="./img/othere/addIcon.jpg"></p></div></div>';return window.imageError=function(e){if(!(e.onerrorIndex>3)){e.src;e.onerrorIndex||(e.onerrorIndex=0),e.onerrorIndex++;var t=e.getAttribute("tsrc");e.src=t}},{restrict:"A",template:i,replace:!0,scope:!0,controller:function(t,i,r,a,n,o,s,c){e=i.data||{};var l=document.getElementById("addImage");angular.element(l);i.removeFn=function(e){var t=e.tsrc||e.src,r=o.confirm({title:"确认删除这张图片吗？",template:'<p class="center">你将删除这张图片!</p><br><p class="center ng-hide"><img src="'+t+'"  style="width:64px"></p>'});r.then(function(t){if(t){var r=e.name,a=-1;i.data.images.map(function(e,t){e.name==r&&(a=t)}),a!=-1&&i.data.images.splice(a,1)}i.$apply()})},i.selectPicture=function(){i.data.images=i.data.images||[],t.getPic(i.data.images)}}}}).directive("attachInfo",function(){return{restrict:"A",templateUrl:"./templates/public/attachInfo-directive.html",replace:!1,scope:!0,controller:function(e){e.noeType={icon:"ion-android-happy",text:""},e.removeFn=function(e){e&&e.remove&&(e.removeDom=!0)},e.addFn=function(){e.lists.push({icon:"ion-android-happy",text:e.noeType.text,remove:!0,checkBox:!0}),e.noeType.text="",e.addItemShow=!1}}}}),angular.module("starter.publishActivityServices",[]).factory("publishActivityServices",function(e,t,i,r){var a={};return a.activitySelectType={},a.activitySelectType.getData=function(){return t.httpGet("./testData/activitySelectTypeData.json")},a.activityKind={},a.activityKind.getActivityKind=function(){},a.infoTransform={"选择类型":"type","活动主题":"title","报名截止时间":"applyEndTime","活动开始时间":"activityStartTime","活动结束时间":"activityEndTime","线下活动地址":"address","地区":"location","线上活动":"activeAddress","活动人数上限":"signUpCount","活动费用":"price","活动性质":"eventProperty","报名附加信息":"registrationAdditional","活动满意度评价":"activitySatisfaction","推荐成功奖励":"recommendedSuccess","授课满意度":"courseSatisfaction","活动详情":"eventDetails"},a.template={"选择类型":"","活动主题":"","报名截止时间":"","活动开始时间":"","活动结束时间":"","线上活动地址":"","线下活动":"","活动人数上限":"","活动费用":"","活动性质":"","报名附加信息":"","活动满意度评价":"","推荐成功奖励":"","授课满意度":"","活动详情":""},a.saveInfo=function(r,n,o){if(e.upLoad(r["活动详情"].images||r.images||[]),t.correspondingKey(a.infoTransform,r),(r.images||[]).map(function(e){e.src=e.tsrc}),"circle"==n){var s=o.split("_");return 2==s.length?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,r.type="activities",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):(r.draflag="0",i.Sdata("get","update_publish_item",r,{type:"activities",id:o}))}return""==o||"new"==o?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_activity",r,{})):(r.draflag="0",i.Sdata("get","update_publish_item",r,{type:"activities",id:o}))},a.getInfo=function(e){var t={type:1,title:1,images:1,applyEndTime:1,activityStartTime:1,activityEndTime:1,location:1,address:1,activeAddress:1,signUpCount:1,price:1,eventProperty:1,registrationAdditional:1,activitySatisfaction:1,recommendedSuccess:1,courseSatisfaction:1,eventDetails:1,_id:0},r={id:e.id};return i.Sdata("get","get_activity_edit",t,r)},a.publishInfo=function(r,n,o){if(e.upLoad(r["活动详情"].images||r.images||[]),t.correspondingKey(a.infoTransform,r),(r.images||[]).map(function(e){e.src=e.tsrc}),"circle"==n){var s=o.split("_");return 2==s.length?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,r.type="activities",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"activities",id:o}))}return""==o||"new"==o?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_activity",r,{})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"activities",id:o}))},a}),angular.module("starter.publishInformationControllers",[]).controller("information",function(e,t,i,r,a,n,o,s,c){function l(){r.informationEphemeralData?o.delObj(r.informationEphemeralData):(r.informationEphemeralData={},r.informationEphemeralData.userInfo=window.userInfo,i.data={},r.informationEphemeralData["信息详情"]=i.data)}function u(){var e=a.getInfo(s);e?e.success(function(e){o.correspondingKey(a.infoTransform,e,!0),r.informationEphemeralData=JSON.parse(JSON.stringify(e instanceof Object?e:{})),r.informationEphemeralData.creator={nickname:window.userInfo.nickname,headUrl:window.userInfo.headUrl},i.data=r.informationEphemeralData["信息详情"]}).error(function(e){c.show({title:"数据获取错误",buttons:[{text:"确认",type:"button-default"},{text:"重新获取",type:"button-positive",onTap:u}]}),l()}):l()}i.source=s.source,i.id=s.id,r.pageMarking="circle"==s.source?"publish":s.source,"user"==r.pageMarking&&u(),a.$stateParams=s,a.indexUrl="#"+n.$$url,l(),i.toolClick=function(){var e=a.saveInfo(o.newObject(r.informationEphemeralData),s.source,s.id);e?e.success(function(){c.show({title:"信息保存成功",buttons:[{text:"确认",type:"button-positive"}]})}).error(function(){c.show({title:"信息保存失败",buttons:[{text:"确认",type:"button-positive"}]})}):c.show({title:"信息保存未保存",buttons:[{text:"确认",type:"button-positive"}]})}}).controller("informationSelectType",function(e,t,i,r,a){e.title="选择类型",e.selectTypeText="选择类型",e.selectData=[],e.elementShow={},e.maxSurplus=1;var n="选择类型";e.selectData=t.informationEphemeralData[n]||[];var o=r.informationSelectType.getData();o.success(function(t){e.typeDatas=t}),a.bindNavTool({rightText:"保存",toolClick:function(){t.informationEphemeralData[n]=e.selectData,t.backClick()}},e)}).controller("informationPreview",function(e,t,i,r,a,n,o,s){var c=n.$stateParams;r.publishEvent=function(){if((a.informationEphemeralData["信息详情"].images||[]).length>6)alert("图片数量最多为6张!");else{if(r.disabled)return;r.disabled=!0;var e="",t=!1;if(a.informationEphemeralData["选择类型"]||(e+="没有选择信息类型！<br>",t=!0),a.informationEphemeralData["信息标题"]||(e+="没有填写信息标题！<br>",t=!0),a.informationEphemeralData["信息详情"].text||(e+="没有填写信息详情！<br>",t=!0),t)return s.show({title:"页面信息缺省",template:e,buttons:[{text:"确认",type:"button-positive"}]}),void(r.disabled=!1);a.informationEphemeralData.createTime=new Date;var i=n.publishInfo(o.newObject(a.informationEphemeralData),c.source,c.id);i&&(i?i.success(function(){s.show({title:"信息发布成功",buttons:[{text:"确认",type:"button-positive"}]}),r.disabled=!1,a.submitInformation=!1,o.delObj(a.informationEphemeralData),a.go("tab.discover-index","discover")}).error(function(){s.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})}):s.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})),console.log(a.informationEphemeralData)}}}),angular.module("starter.publishInformationDirective",[]),angular.module("starter.publishInformationServices",[]).factory("publishInformationServices",function(e,t,i,r){var a={};return a.informationSelectType={},a.informationSelectType.getData=function(){return t.httpGet("./data/informationSelectTypeData.json")},a.infoTransform={"选择类型":"type","信息标题":"title","信息详情":"des","信息联系人":"contacts","联系方式":"contactmethod","信息截止时间":"endtime"},a.template={"选择类型":"","信息标题":"","信息详情":"","信息联系人":"","联系方式":"","信息截止时间":""},a.saveInfo=function(r,n,o){t.correspondingKey(a.infoTransform,r);try{e.upLoad(r.des.images||r.images||[])}catch(s){console.log(s)}if((r.des.images||[]).map(function(e){e.src=e.tsrc}),"circle"==n){var c=o.split("_");return 2==c.length?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,r.type="informations",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):i.Sdata("get","update_publish_item",r,{type:"informations",id:o})}return""==o||"new"==o?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_info",r,{})):i.Sdata("get","update_publish_item",r,{type:"informations",id:o})},a.getInfo=function(e){var t={type:1,title:1,des:1,contacts:1,contactmethod:1,endtime:1,_id:0};return i.Sdata("get","get_info_detail",t,{id:e.id})},a.publishInfo=function(r,n,o){t.correspondingKey(a.infoTransform,r),e.upLoad(r.des.images||r.images||[]);try{(r.des.images||[]).map(function(e){e.src=e.tsrc})}catch(s){console.log(s)}if("circle"==n){var c=o.split("_");return 2==c.length?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,r.type="informations",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"informations",id:o}))}return""==o||"new"==o?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_info",r,{})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"informations",id:o}))},a}),angular.module("starter.publishInvestigateControllers",[]).controller("investigate",function(e,t,i,r,a,n,o,s,c,l){function u(){i.investigateEphemeralData?s.delObj(i.investigateEphemeralData):(i.investigateEphemeralData={},i.investigateEphemeralData["问题"]=[],i.investigateEphemeralData["问卷描述"]={placeholder:"亲爱的朋友：您好！随着人们生活水平的提高，外出旅游已经成为一种新的时尚和休闲方式。为了全面了解人们旅游的方式、地点、经费等问题，我们组织了这次调查活动。希望得到您的支持和帮助。本次调查严格按照《统计法》的要求进行，不用填写姓名，所有回答只用于统计分析，各种答案没有正确、错误之分。请您在百忙之中抽出一点时间填写这份调查表。您的回答将代表众多和您一样的朋友，并将对提高旅游质量、服务水平提供帮助。我们将会对您的信息进行必要保护！请在在题目后的括号里填写您的答案。衷心感谢您的支持和协助！祝您生活愉快。"},t.data=i.investigateEphemeralData["问卷描述"])}function d(){var e=r.getInfo(o);e?e.success(function(e){s.correspondingKey(r.infoTransform,e,!0),i.investigateEphemeralData=JSON.parse(JSON.stringify(e instanceof Object?e:{})),t.data=i.investigateEphemeralData["问卷描述"]}).error(function(e){c.show({title:"数据获取错误",buttons:[{text:"确认",type:"button-default"},{text:"重新获取",type:"button-positive",onTap:d}]}),u()}):u()}function p(e){m=i.investigateEphemeralData["问题"],console.log(i.investigateEphemeralData),t.sub=e||0,t.nowData=m[t.sub],t.nowData?t.seekOut=!0:t.nowData={type:"单选",question:"",option:[]}}t.PHR=r.deathData["问卷份数"],t.sub=0,t.authoritys=r.deathData["查看权限"],i.pageMarking=o.source,"user"==i.pageMarking?d():u(),t.source=o.source,t.id=o.id,i.pageMarking="circle"==o.source?"publish":o.source,r.$stateParams=o,r.indexUrl="#"+l.$$url,t.questionScope={},t.nowData={};var m=[];a.fromTemplateUrl("./templates/publish/investigate-subject.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.modal=e}),t.addQuestion=function(e){t.modal.show(),p(e)},t.publishInfo=function(){var e="",a=!1;if(i.investigateEphemeralData["选择类型"]||(e+="你没有选择调查类型！<br>",a=!0),i.investigateEphemeralData["标题"]||(e+="你没有输入标题！<br>",a=!0),i.investigateEphemeralData["截止日期"]||(e+="你没有输入截止日期！<br>",a=!0),i.investigateEphemeralData["问卷份数"]||(e+="你没有选择问卷份数！<br>",a=!0),i.investigateEphemeralData["问卷赏金"]||(e+="你没有填写问卷赏金！<br>",a=!0),i.investigateEphemeralData["问题"].length||(e+="你没有填写任何问题！<br>",a=!0),a)return c.show({title:"页面信息缺省",template:e,buttons:[{text:"确认",type:"button-positive"}]}),void(t.disabled=!1);i.investigateEphemeralData.createTime=new Date;var n=r.publishInfo(s.newObject(i.investigateEphemeralData),o.source,o.id);n&&(n?n.success(function(){c.show({title:"信息发布成功",buttons:[{text:"确认",type:"button-positive"}]}),t.disabled=!1,i.submitInformation=!1,s.delObj(i.investigateEphemeralData),i.go("tab.discover-index","discover")}).error(function(){c.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})}):c.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})),console.log(i.investigateEphemeralData)},t.ck=function(){return t.nowData.question?!(t.nowData.option.length<2&&"问答"!=t.nowData.type)||(c.alert({title:"你的选项小于两个！",template:"请重新输入"}),!1):(c.alert({title:"你没有填写问题！",template:"请重新输入"}),!1)},t.nextQuestion=function(){return!!t.ck()&&(m.indexOf(t.nowData)==-1&&m.push(t.nowData),void t.modal.hide())},t.addOption=function(){return""==t.questionScope.nowOptionText?(t.questionScope.questionScope.nowOptionText="",!1):t.nowData.option.indexOf(t.questionScope.nowOptionText||"")!=-1?(c.alert({title:"已经有了此选项！",template:"请重新输入"}),t.questionScope.nowOptionText="",!1):(t.nowData.option.push(t.questionScope.nowOptionText),void(t.questionScope.nowOptionText=""))},t.removeOption=function(e){var i=t.nowData.option;i.splice(i.indexOf(e),1)},t.deleteQuestion=function(){m[t.sub]&&m.splice(t.sub,1),t.modal.hide()}}).controller("investigateSelectType",function(e,t,i,r){e.title="选择调查类型",e.selectTypeText="选择类型",e.maxSurplus=1;var a="选择类型";e.selectData=t.investigateEphemeralData[a]||[];var n=i.investigateSelectType.getData();n.success(function(t){e.typeDatas=t}),r.bindNavTool({rightText:"保存",toolClick:function(){t.investigateEphemeralData[a]=e.selectData,t.backClick()}},e)}).controller("investigateSubject",function(e,t,i,r,a,n,o,s){}),angular.module("starter.publishInvestigateDirective",[]),angular.module("starter.publishInvestigateServices",[]).factory("publishInvestigateServices",function(e,t,i,r){var a={};return a.investigateSelectType={},a.investigateSelectType.getData=function(){return t.httpGet("./data/investigateSelectTypeData.json")},a.deathData={"问卷份数":["100","200","300","400","500"],"查看权限":["公开结果","非公开结果"]},a.infoTransform={"选择类型":"type","标题":"title","截止日期":"endTime","问卷份数":"maxPortion","问卷赏金":"moneyReward","报告查看权限":"viewauthority","问卷描述":"questdes","问题":"questions"},a.template={"选择类型":"","标题":"","截止日期":"","问卷份数":"","问卷赏金":"","报告查看权限":"","问卷描述":{},"问题":[]},a.saveInfo=function(r,n,o){if(e.upLoad(r["问卷描述"].images||r.images||[]),t.correspondingKey(a.infoTransform,r),(r.questdes.images||[]).map(function(e){e.src=e.tsrc}),"circle"==n){var s=o.split("_");return 2==s.length?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,r.type="investigations",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):(r.draflag="0",i.Sdata("get","update_publish_item",r,{type:"investigations",id:o}))}return""==o||"new"==o?(r.draflag="0",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_invest",r,{})):(r.draflag="0",i.Sdata("get","update_publish_item",r,{type:"investigations",id:o}))},a.getInfo=function(e){var t={type:1,title:1,endTime:1,maxPortion:1,moneyReward:1,viewauthority:1,questdes:1,questions:1,_id:0};return i.Sdata("get","get_invest_model",t,{id:e.id})},a.publishInfo=function(r,n,o){if(e.upLoad(r["问卷描述"].images||r.images||[]),t.correspondingKey(a.infoTransform,r),(r.questdes.images||[]).map(function(e){e.src=e.tsrc}),"circle"==n){var s=o.split("_");return 2==s.length?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,r.type="investigations",i.Sdata("get","update_circle_rRecord",r,{circleId:o})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"investigations",id:o}))}return""==o||"new"==o?(r.draflag="1",r.userId=window.userId,r.creator=window.userInfo,i.Sdata("get","add_invest",r,{})):(r.draflag="1",i.Sdata("get","update_publish_item",r,{type:"investigations",id:o}))},a});var app=angular.module("starter.publishToHireControllers",[]);app.controller("toHire",function(e,t,i,r,a,n,o,s){function c(){r.ephemeralData?o.delObj(r.ephemeralData):r.ephemeralData={}}function l(){e.source=n.source,e.id=n.id;var t=a.getInfo(n);t?t.success(function(e){o.correspondingKey(a.infoTransform,e,!0),r.ephemeralData=JSON.parse(JSON.stringify(e instanceof Object?e:{})),console.log(r.ephemeralData),r.ephemeralData["选择日期"]=new Date(r.ephemeralData["选择日期"])}).error(function(e){s.show({title:"数据获取错误",buttons:[{text:"确认",type:"button-default",onTap:function(){c()}},{text:"重新获取",type:"button-positive",onTap:l}]}),c()}):c()}"user"==r.pageMarking&&l(),r.ephemeralData=a.template,e.source=n.source,e.id=n.id,a.$stateParams=n,a.indexUrl="#"+i.$$url,console.log(n),r.pageMarking="circle"==n.source?"publish":n.source,e.toolClick=function(){var e=a.saveInfo(o.newObject(r.ephemeralData),n.source,n.id);e?e.success(function(){s.show({title:"信息保存成功",buttons:[{text:"确认",type:"button-positive"}]})}).error(function(){s.show({title:"信息保存失败",buttons:[{text:"确认",type:"button-positive"}]})}):s.show({title:"信息保存未保存",buttons:[{text:"确认",type:"button-positive"}]})},console.log(r.ephemeralData,"测试")}).controller("jobDescription",function(e,t,i,r,a,n,o){console.log("jobDescription");var s=r.type,c={describe:"岗位描述",demand:"岗位要求"};e.textareaHeight=window.innerHeight-153,e.text=i.ephemeralData[c[s]]||"",e.maxTextLength=e.text.length,e.config=n.jobDescription.config[r.type];var l=document.getElementById("text"),u=angular.element(l);l.onkeydown=function(t){var i=u.val();e.maxTextLength=i.length},e.keydownEvent=function(){};var d=e.config.title;o.bindNavTool({rightText:"保存",toolClick:function(){i.ephemeralData[d]=u.val(),i.backClick()}},e)}).controller("saveInfoOk",function(e,t,i,r,a){t.title=a.title,t.url=a.url,i.go("tab.discover-index","discover")}).controller("selectTmp",function(e,t,i,r,a,n,o){console.log("selectTmp"),t.maxSurplus=1;var s=r.$current.name+"-"+e.type,c=n.selectTmpServices;t.type=s,t.config=c.config[e.type];var l=t.config.title;window.$scope=t,console.log(i.ephemeralData[l]),i.ephemeralData[l],t.selectData=i.ephemeralData[l]||[],o.bindNavTool({rightText:"保存",toolClick:function(){i.ephemeralData[l]=[],console.log(t.selectData),t.selectData.map(function(e,t){i.ephemeralData[l].push(e.city+"-"+e.county)}),i.backClick()}},t)}).controller("selectTrade",function(e,t,i,r,a,n){console.log("selectTrade");var o=e.$current.name,s="行业";t.selectData=i.ephemeralData[s]||[],t.contentHeight=window.innerHeight-156,t.type=o;var c=r.selectTradeServices.getData();c.then(function(e){t.typeDatas=e.data},function(e){}),n.bindNavTool({rightText:"保存",toolClick:function(){i.ephemeralData[s]=t.selectData,i.backClick()}},t)}).controller("technicalAbility",function(e,t,i,r){console.log("technicalAbility"),i.navRightButtonText="保存",t.surplus=0,t.selectData=[],t.technicalAbilitys=[],t.elementShow={};for(var a=0;a<20;a++)t.technicalAbilitys.push("战略组织"+a);t.removeNoe=function(e){t.selectData.splice(t.selectData.indexOf(e),1),t.elementShow[e]=!1,t.surplus--},t.clickNoe=function(e){t.surplus>=5&&t.selectData.indexOf(e)==-1||(t.elementShow[e]=!t.elementShow[e],t.elementShow[e]?t.selectData.push(e):t.removeNoe(e),t.surplus=t.selectData.length)},i.navButtonEvent=function(){i.ephemeralData[type]={text:t.selectData.toString()},r.goBack()}}).controller("yearlySalary",function(e,t,i,r,a,n){console.log("yearlySalary"),i.navRightButtonText="保存";var o=e.$current.name;t.type=o;var s="年薪",c=a.yearlySalary.getData();c.then(function(e){t.yearlySalarys=e.data,i.ephemeralData[s]&&(t.noeIndex=t.yearlySalarys.indexOf(i.ephemeralData[s]))},function(){}),t.clickNoe=function(e){t.noeIndex=e},n.bindNavTool({rightText:"保存",toolClick:function(){i.ephemeralData[s]=t.yearlySalarys[t.noeIndex],i.backClick()}},t)}).controller("jobCharacteristics",function(e,t,i,r,a,n){console.log("jobCharacteristics"),i.navRightButtonText="保存";var o=(e.$current.name,"岗位特点");t.maxSurplus=5,t.selectData=i.ephemeralData[o]||[];var s=a.jobCharacteristics.getData();s.then(function(e){t.typeDatas=e.data},function(){}),n.bindNavTool({rightText:"保存",toolClick:function(){i.ephemeralData[o]=t.selectData,i.backClick()}},t)}).controller("toHirePreview",function(e,t,i,r,a,n,o){var s=a.$stateParams;r.ephemeralData.postPublisher=window.userInfo,t.publishEvent=function(){var e="",t=!1;if(r.ephemeralData["公司名称"]||(e+="公司名称未输入<br>",t=!0),r.ephemeralData["地区"]||(e+="地区未选择<br>",t=!0),r.ephemeralData["职位"]||(e+="职位未填写<br>",t=!0),r.ephemeralData["行业"]||(e+="行业未选择<br>",t=!0),r.ephemeralData["职能"]||(e+="职能未选择<br>",t=!0),r.ephemeralData["年薪"]||(e+="年薪未选择<br>",t=!0),r.ephemeralData["岗位描述"]||(e+="岗位描述无内容<br>",t=!0),r.ephemeralData["岗位要求"]||(e+="岗位要求无内容<br>",
t=!0),r.ephemeralData["岗位特点"]||(e+="岗位特点未选择<br>",t=!0),r.ephemeralData["岗位性质"]||(e+="岗位性质无内容<br>",t=!0),r.ephemeralData["公司地址"]||(e+="公司地址未输入<br>",t=!0),isNaN(+r.ephemeralData["推荐奖励"])&&(e+="推荐奖励未填写<br>",t=!0),isNaN(+r.ephemeralData["推荐成功奖励"])&&(e+="推荐成功奖励未填写<br>",t=!0),r.ephemeralData["选择日期"]||(e+="日期未选择<br>",t=!0),t)return void o.show({title:"页面信息缺省",template:e,buttons:[{text:"确认",type:"button-positive"}]});r.ephemeralData.createTime=new Date;var i=a.publishInfo(n.newObject(r.ephemeralData),s.source,s.id);i&&(i?i.success(function(){o.show({title:"信息发布成功",buttons:[{text:"确认",type:"button-positive"}]}),r.submitInformation=!1,n.delObj(r.ephemeralData),r.go("tab.discover-index","discover")}).error(function(){o.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})}):o.show({title:"信息发布失败",buttons:[{text:"确认",type:"button-positive"}]})),console.log(r.ephemeralData)},t.postPublisher=window.userInfo});var app=angular.module("starter.publishToHireDirective",[]);app.directive("mailTest",function(){function e(e){var t=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;return t.test(e)}return{restrict:"A",link:function(t,i,r){i.on("focus",function(){i.removeClass("error")}),i.on("blur",function(){e(i.val())||i.addClass("error")})}}}).directive("setIonScrollHeight",function(){return{restrict:"C",link:function(e,t){t.css("height",window.innerHeight-165+"px")}}});var app=angular.module("starter.publishToHireServices",[]);app.factory("publishToHireServices",function(e,t,i,r,a,n){var o,s={};return s.selectTmpServices={},s.get=r.httpGet,o=s.selectTmpServices,o.config={area:{title:"地区",getData:function(){var e=s.get("./data/area.json",{cache:!0}),i=t.defer();return e.then(function(e){var t={};e.data.map(function(e){"请选择"!=e.name&&(t[e.name]=[],e.sub instanceof Array&&e.sub.map(function(i){"请选择"!=i.name&&"其他"!=i.name&&t[e.name].push(i.name)}))}),i.resolve({data:t})},function(e){i.reject(e)}),i.promise}},duty:{title:"职能",getData:function(){return s.get("./data/duty.json",{cache:!0})}}},s.selectTradeServices={},s.selectTradeServices.getData=function(){return s.get("./data/trade.json",{cache:!0})},s.yearlySalary={},s.yearlySalary.getData=function(){return s.get("./data/yearlySalary.json",{cache:!0})},s.jobCharacteristics={},s.jobCharacteristics.getData=function(){return s.get("./data/jobCharacteristics.json",{cache:!0})},s.jobDescription={},s.jobDescription.config={describe:{title:"岗位描述"},demand:{title:"岗位要求"},property:{title:"岗位性质"}},s.infoTransform={"公司名称":"company","地区":"address","职位":"profession","行业":"industry","职能":"responsibility","年薪":"salary","岗位描述":"jobDescription","岗位要求":"jobRequirements","岗位特点":"jobCharacteristics","岗位性质":"jobNature","公司邮箱":"companyMail","公司地址":"companyAddress","推荐奖励":"recommendedAward","推荐成功奖励":"recommendedSuccess","选择日期":"time"},s.template={"公司名称":"","地区":"","职位":"","行业":"","职能":"","年薪":"","岗位描述":"","岗位要求":"","岗位特点":"","岗位性质":"","公司邮箱":"","公司地址":"","推荐奖励":"","推荐成功奖励":"","选择日期":""},s.saveInfo=function(e,t,i){if(r.correspondingKey(s.infoTransform,e),"circle"==t){var n=i.split("_");return 2==n.length?(e.draflag="0",e.userId=window.userId,e.creator=window.userInfo,e.type="hires",a.Sdata("get","update_circle_rRecord",e,{circleId:i})):(e.draflag="0",a.Sdata("get","update_publish_item",e,{type:"hires",id:i}))}return""==i||"new"==i?(e.draflag="0",e.userId=window.userId,e.creator=window.userInfo,a.Sdata("get","add_hire",e,{})):(e.draflag="0",a.Sdata("get","update_publish_item",e,{type:"hires",id:i}))},s.getInfo=function(e){var t={company:1,address:1,industry:1,responsibility:1,profession:1,salary:1,jobDescription:1,jobRequirements:1,jobCharacteristics:1,jobNature:1,companyMail:1,companyAddress:1,recommendedAward:1,recommendedSuccess:1,periodOfValidity:1,time:1,_id:0};return a.Sdata("get","get_hire",t,{id:e.id})},s.publishInfo=function(e,t,i){if(r.correspondingKey(s.infoTransform,e),"circle"==t){var n=i.split("_");return 2==n.length?(e.draflag="1",e.userId=window.userId,e.creator=window.userInfo,e.type="hires",a.Sdata("get","update_circle_rRecord",e,{circleId:i})):(e.draflag="1",a.Sdata("get","update_publish_item",e,{type:"hires",id:i}))}return""==i||"new"==i?(e.draflag="1",e.userId=window.userId,e.creator=window.userInfo,a.Sdata("get","add_hire",e,{})):(e.draflag="1",a.Sdata("get","update_publish_item",e,{type:"hires",id:i}))},s}),angular.module("starter.userControllers",[]).controller("user",function(e,t,i,r,t,a,n,o,s){t.pageMarking="user",r.bindNavTool(),i.myConcealToggle=function(e,t){window.userInfo.config=e,a.updateUserConfig(e,t)},i.sysSettingToggle=function(e){window.userInfo.sysSetting=e,a.updateUserInfo("sysSetting",e)},i.$on("$ionicView.beforeEnter",function(){var e=a.getUserProInfo();e&&e.then(function(e){console.log(e.data),i.userInfo=e.data,i.userInfo.config&&void 0!=i.userInfo.config["扩展信息可见"]||(i.userInfo.config={"手机号码可见":!1,"基本信息可见":!0,"扩展信息可见":!1}),window.userInfo=window.userInfo||{},window.userInfo.config=i.userInfo.config,i.phone=window.userInfo.phone})}),i.doLogOut=function(){n.clear("userId"),n.clear("userInfo"),window.userInfo={},window.userId="",t.messageBadge=0,sysTimer&&e.cancel(sysTimer),o.go("login")}}).controller("userInfo",function(e,t,i,r,a,n){t.uploadHeadPhoto=function(){n.getPic([],function(e){e&&n.upLoad([e],function(e){t.userInfo.headUrl=e.tsrc,i.updateFunction("headUrl",e.tsrc)})})},r.bindNavTool(),t.yerds=[];for(var o=1960;o<(new Date).getFullYear();o++)t.yerds.push(o);var s=i.getUserBasicInfo(window.userId);s.then(function(e){window.userInfo_=e.data,t.userInfo=JSON.parse(JSON.stringify(window.userInfo_))}),t.$watch("userInfo",function(){if(t.userInfo){var e=["heardPhotoUrl","name","nickname","sex","sex","area","area","phone","email","currentCompany","currentTrade","currentFunction","goodSkill","hobbiesAndInterests","workExperience","projectExperience","educationalBackground","linguisticCapacit","selfAssessment","extraMessage"],i=0;for(var r in e)t.userInfo[e[r]]&&i++;t.userInfo.complete=(i/e.length*100).toFixed(0)}}),i.updateFunction=function(e,t){console.log(e,t);var r=i.updateUserInfo(e,t);r?r.success(function(){}).error(function(){a.show({title:"信息更新失败!",buttons:[{text:"再次尝试",type:"button-positive",onTap:function(r){i.updateFunction(e,t)}},{text:"确认",onTap:function(e){}}]})}):a.show({title:"信息更新失败!",buttons:[{text:"再次尝试",type:"button-positive",onTap:function(r){i.updateFunction(e,t)}},{text:"确认",onTap:function(e){}}]})},t.update=i.updateFunction,i.dataExchange=t}).controller("userSelectArea",function(e,t,i,r,a){e.selectData=[],e.config=t.selectTmpServices.config.area,e.selectData=[i.dataExchange.userInfo.area]||[],e.maxSurplus=1,r.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.area=e.selectData[0].city+" - "+e.selectData[0].county,i.updateFunction("area",i.dataExchange.userInfo.area),a.backClick()}},e)}).controller("userTradeSelectType",function(e,t,i,r){e.title="当前行业",e.selectTypeText="选择行业",e.selectData=[],e.typeDatas=[];var a=i.getTrade();a.then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.currentTrade=e.selectData.join(","),i.updateFunction("currentTrade",i.dataExchange.userInfo.currentTrade),r.backClick()}},e)}).controller("userOccupationSelectType",function(e,t,i,r){e.title="当前职能",e.selectTypeText="选择职能",e.selectData=[],e.typeDatas=[];var a=i.getOccupation();a.then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.currentFunction=e.selectData.join(","),i.updateFunction("currentFunction",i.dataExchange.userInfo.currentFunction),r.backClick()}},e)}).controller("userBeGoodAtSelectType",function(e,t,i,r){e.title="擅长技能",e.selectTypeText="选择技能",e.selectData=i.dataExchange.userInfo.goodSkill||[],e.typeDatas=[],e.maxSurplus=3;var a=i.getBeGoodAt();a.then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.goodSkill=e.selectData,i.updateFunction("goodSkill",i.dataExchange.userInfo.goodSkill),r.backClick()}},e)}).controller("userInterestSelectType",function(e,t,i,r){e.title="兴趣爱好",e.selectTypeText="选择兴趣",e.selectData=i.dataExchange.userInfo.hobbiesAndInterests||[],e.typeDatas=[],e.maxSurplus=3;var a=i.getInterest();a.then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.hobbiesAndInterests=e.selectData,i.updateFunction("hobbiesAndInterests",i.dataExchange.userInfo.hobbiesAndInterests),r.backClick()}},e)}).controller("userLanguageSelectType",function(e,t,i,r){e.title="语言能力",e.selectTypeText="选择语言",e.selectData=i.dataExchange.userInfo.linguisticCapacit instanceof Array?i.dataExchange.userInfo.linguisticCapacit:[],e.typeDatas=[],e.maxSurplus=3;var a=i.getLanguage();a.then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){i.dataExchange.userInfo.linguisticCapacit=e.selectData,i.updateFunction("linguisticCapacit",i.dataExchange.userInfo.linguisticCapacit),r.backClick()}},e)}).controller("userWorkExperience",function(e,t,i,r,a,n){var o,s=i.sub;o="new"==s?{}:t.dataExchange.userInfo.workExperience[s],e.workExperience=JSON.parse(JSON.stringify(o)),e.workExperience.startTime=new Date(e.workExperience.startTime),e.workExperience.endTime=new Date(e.workExperience.endTime),r.bindNavTool({rightText:"保存",toolClick:function(){if("new"==s){if(+e.workExperience.startTime>+e.workExperience.endTime)return a.alert({title:"开始时间大于结束时间",okText:"确认"}),!1;t.dataExchange.userInfo.workExperience.push(e.workExperience)}else t.dataExchange.userInfo.workExperience[s]=e.workExperience;t.updateUndergo("workExperience",e.workExperience,s),n.backClick()}},e)}).controller("userProjectExperience",function(e,t,i,r,a,n){var o,s=i.sub;o="new"==s?{}:t.dataExchange.userInfo.projectExperience[s],e.projectExperience=JSON.parse(JSON.stringify(o)),e.projectExperience.startTime=new Date(e.projectExperience.startTime),e.projectExperience.endTime=new Date(e.projectExperience.endTime),r.bindNavTool({rightText:"保存",toolClick:function(){if("new"==s){if(+e.projectExperience.startTime>+e.projectExperience.endTime)return a.alert({title:"开始时间大于结束时间",okText:"确认"}),!1;t.dataExchange.userInfo.projectExperience.push(e.projectExperience)}else t.dataExchange.userInfo.projectExperience[s]=e.projectExperience;t.updateUndergo("projectExperience",e.projectExperience,s),n.backClick()}},e)}).controller("userEducationalBackground",function(e,t,i,r,a,n){var o,s=r.sub;o="new"==s?{}:t.dataExchange.userInfo.educationalBackground[s],e.educationalBackground=JSON.parse(JSON.stringify(o)),e.educationalBackground.startTime=new Date(e.educationalBackground.startTime),e.educationalBackground.endTime=new Date(e.educationalBackground.endTime),t.getSchoolName().then(function(t){e.schoolNames=t.data}),t.getSpecialty().then(function(t){e.specialtys=t.data}),e.educationalBackground.recordOfFormalSchoolings=["中专","大专","本科","硕士","博士","其他"],a.bindNavTool({rightText:"保存",toolClick:function(){if("new"==s){if(+e.educationalBackground.startTime>+e.educationalBackground.endTime)return i.alert({title:"开始时间大于结束时间",okText:"确认"}),!1;t.dataExchange.userInfo.educationalBackground.push(e.educationalBackground)}else t.dataExchange.userInfo.educationalBackground[s]=e.educationalBackground;t.updateUndergo("educationalBackground",e.educationalBackground,s),n.backClick()}},e)}).controller("userMobileVerify",function(e,t,i,r,a,n,o,s,c){i.getPreviousTitle=function(){return e.backTitle()},i.goBack=function(){e.goBack()}}).controller("userAddressList",function(e,t,i,r,a,n,o,s){t.info={},t.userFriends={},t.allUsers={},s.fromTemplateUrl("./templates/user/user-hailFellow.html",{scope:t,animation:"slide-in-up",backdropClickToClose:!1}).then(function(e){t.modal=e}),t.searchMarking="nickname",t.searchData=[],i.getFriends().then(function(e){t.userFriends=e.data;for(var i in t.userFriends)t.searchData=t.searchData.concat(t.userFriends[i])}),t.searchCallBack=function(e){i.getAllUser(e).then(function(e){t.userList=e.data})},t.addFriend=function(e){i.addFriends(window.userInfo,e).then(function(){a.alert({title:"请求已发出,等待对方确认",okText:"确认"})},function(){a.alert({title:"添加失败",okText:"确认"})})},i.getFriendsUrl instanceof Function&&i.getFriendsUrl().then(function(e){t.lists=e.data}),r.bindNavTool({navRightIonicClass:"icon ion-person-add",toolClick:function(){t.modal.show(),i.getAllUser().then(function(e){t.userList=e.data})}},t);var c=i.getFriends();c.then(function(e){t.userFriends=e.data},function(){}),t.deleteFriend=function(e){var r=i.deleteFriend(e.userId);r.then(function(){a.alert({title:"删除成功",okText:"确认"});var i=t.userFriends;i.splice(i.indexOf(e),1)},function(){a.alert({title:"删除失败",okText:"确认"})})},t.defriend=function(e){i.defriend(e.userId).then(function(i){a.alert({title:"拉黑成功",okText:"确认"});var r=t.userFriends;r.splice(r.indexOf(e),1)})}}).controller("userPartake",function(e,t,i,r){function a(){r.show({title:"信息拉取失败",buttons:[{text:"重新拉取",type:"button-positive",onTap:function(t){e.nowTab.click()}},{text:"取消"}]})}t.__partake=!0;var n=i.partake;e.title="我参与的",e.nowData=[],e.heardTabs=[{type:"活动",tmpUrl:"./templates/discover/discover-cateforyTab-activity-tmp.html",click:function(){var t=n.getActivity();t.then(function(t){e.nowData=t.data},a)}},{type:"才聘",tmpUrl:"./templates/discover/discover-cateforyTab-toHire-tmp.html",click:function(){var t=n.getToHire();t.then(function(t){e.nowData=t.data},a)}},{type:"调查",tmpUrl:"./templates/discover/discover-cateforyTab-investigate-tmp.html",click:function(){var t=n.getInvestigate();t.then(function(t){e.nowData=t.data},a)}}]}).controller("userPublish",function(e,t,i,r,a){function n(){r.show({title:"信息拉取失败",buttons:[{text:"重新拉取",onTap:function(t){e.nowTab.click()}},{text:"取消",type:"button-positive"}]})}t.__partake=!1;var o=i.publish;e.title="我发布的",e.nowData=[],e.deleteItem=function(t,n){i.deleteItem(e.type,n).then(function(){a(function(){e.nowData.splice(t,1)},1e3),e.nowData[t]["class"]="rollOut"},function(){r.alert({title:"删除失败",okText:"确认"})})},e.heardTabs=[{type:"活动",tmpUrl:"./templates/discover/discover-cateforyTab-activity-tmp.html",click:function(){e.type=this.type;var t=o.getActivity();t.then(function(t){e.nowData=t.data},n)}},{type:"才聘",tmpUrl:"./templates/discover/discover-cateforyTab-toHire-tmp.html",click:function(){e.type=this.type;var t=o.getToHire();t.then(function(t){e.nowData=t.data},n)}},{type:"调查",tmpUrl:"./templates/discover/discover-cateforyTab-investigate-tmp.html",click:function(){e.type=this.type;var t=o.getInvestigate();t.then(function(t){e.nowData=t.data},n)}},{type:"信息",tmpUrl:"./templates/discover/discover-cateforyTab-information-tmp.html",click:function(){e.type=this.type;var t=o.getInformation();t.then(function(t){e.nowData=t.data},n)}}]}).controller("userCircle",function(e,t,i){e.circles=[],e.promise=t.getCircle("myCircle"),e.title="我的圈子",e.circleUrl="#/tab/user-enterTheCircle",e.promise.then(function(t){e.circles=t.data,e.searchData=t.data})}).controller("userCoupleBack",function(e,t,i,r,a,n){i.getPreviousTitle=function(){return e.backTitle()},i.goBack=function(){e.goBack()},a.bindNavTool({rightText:"提交",toolClick:function(){return isNaN(+i.phone)&&11!=i.phone.length?(n.alert({title:"手机号码格式错误!"}),!1):(r.userCoupleBackSubmit({phone:i.phone,text:i.text}).then(function(e){e?n.alert({title:"提交成功",okText:"确认"}):n.alert({title:"提交失败",okText:"确认"})}),void t.backClick())}},i)}).controller("userOtherInfo",function(e,t,i,r,a,n){i.userInfo={},n.getFellowInfo(r.id).then(function(e){i.userInfo=e.data||{}}),i.newsSend=function(){return i.userInfo.userId==window.userId?void alert("不能给自己发私信"):void a.getToPersonMessage(i.userInfo).then(function(r){i.messageDetails=r.data.message||[],e.checkUserAuthority()&&t.go("tab.user-message",{messageId:r.data.id,isFromMe:r.data[window.userId]},!0)})}}).controller("userUndergo",function(e,t,i,r){var a=i.dataExchange.userInfo,n="";switch(r.type){case"work":e.title="工作经历",e.url="#/tab/user/user-workExperience/",a.workExperience=a.workExperience||[],e.lists=a.workExperience,e.showListKeyName="corporateName",n="work";break;case"education":e.title="教育背景",e.url="#/tab/user/user-educationalBackground/",a.educationalBackground=a.educationalBackground||[],e.lists=a.educationalBackground,e.showListKeyName="schoolName",n="education";break;case"project":e.title="项目经验",e.url="#/tab/user/user-projectExperience/",a.projectExperience=a.projectExperience||[],e.lists=a.projectExperience,e.showListKeyName="projectName",n="project"}e.onDelete=function(t){i.deleteUndergoItem(n,t).then(function(){e.lists.splice(t,1)})}}).controller("userMoreInfo",function(e,t,i,r,a,n){i.userInfo={},a.getUserBasicInfo(window.userId).then(function(e){i.userInfo=e.data,angular.isString(i.userInfo.extraMessage)&&(i.userInfo.extraMessage={}),i.data=i.userInfo.extraMessage,i.data.images=i.userInfo.extraMessage.images||[]});var o=[];i.$on("$ionicView.beforeLeave",function(){angular.copy(i.data.images,o),t.upLoad(o),i.data.images.map(function(e){e.src=e.tsrc}),i.data.text=i.userInfo.extraMessage.text,a.updateUserInfo("extraMessage",i.data)})}).controller("userExamineAndVerify",function(e,t,i){e.activityName=t.activityName,e.heardClick=function(r){e.heardIndex=r,e.lists=[],i.getExamineAndVerify(t.id,r).then(function(t){(t.data.signUpRecord||[]).map(function(e){e.status&&(e.text="1"==e.status?"已同意":"已拒绝")}),e.lists=t.data.signUpRecord},function(){})},e.heardClick(0),e.agree=function(e){i.ask("1",t,e.userId).then(function(){e.text="已同意"})},e.refuse=function(e){i.ask("-1",t,e.userId).then(function(){e.text="已拒绝"})}}).controller("userCandidates",function(e,t,i){t.getCandidates(i.id).then(function(t){e.candidates=t.data})}).controller("userCandidatesUserInfo",function(e,t,i){t.getUserBasicInfo(i.id).then(function(t){e.userInfo=t.data}),e.shareHire=function(){}}).controller("userAnswerDetails",function(e,t,i){t.getAnswerDetails(i.id).then(function(t){var i={};i.singleSelectionData=[];var i={maxPortion:"100",alreadyPortion:"1",singleSelectionData:[{questions:"wenti",answers:[{percentage:11,item:"xx"}]}],multiSelectData:[{questions:"wenti",answers:[{percentage:11,item:"xx"}]}],questionsAndAnswers:[{questions:"问题",answers:["答案1"]}]};e.answerDetails=i})}).controller("userSelectDuty",function(e,t,i,r,a,n){e.maxSurplus=1,e.type=n.type,e.title=e.type,e.config={title:"当前职能",getData:a.selectTmpServices.config.duty.getData},e.selectData=i.dataExchange.userInfo.currentFunction||[],r.bindNavTool({rightText:"保存",toolClick:function(){var r=[];e.selectData.map(function(e,t){r.push(e.city+"-"+e.county)}),i.dataExchange.userInfo.currentFunction=r,i.updateFunction("currentFunction",r),t.backClick()}},e)}).controller("userSelectTrade",function(e,t,i,r,a){e.contentHeight=window.innerHeight-156,e.title="选择行业",e.selectTypeText="选择行业",e.selectData=r.dataExchange.userInfo.currentTrade||[],e.maxSurplus=1,a.selectTradeServices.getData().then(function(t){e.typeDatas=t.data}),t.bindNavTool({rightText:"保存",toolClick:function(){r.dataExchange.userInfo.currentTrade=e.selectData,r.updateFunction("currentTrade",e.selectData),i.backClick()}},e)}).controller("userNewFriend",function(e,t,i,r,a,n){n.getSysNotice("userApplyFriend").then(function(t){e.applyFriends=t.data}),e.agreeFriendApply=function(t,i,r){n.agreeFriendApply(i,1).then(function(i){200==i.status&&(e.applyFriends[t].status=1),r.stopPropagation()})}}).controller("userSignIn",function(e,t,i,r,a,n,o){e.signIn={},n.getSignInPersonnel(i.id).then(function(t){e.signIn=t.data instanceof Object?t.data:{}}),e.change=function(){n.startSignIn(i.id,e.signIn.signIn.startSignIn).then(function(){},function(){r.alert({title:"打开失败",okText:"确认"})})}}).controller("userActivityEvaluate",function(e,t,i,r,a,n,o){n.getActivityEvaluation(i.id).then(function(t){if(t.data){e.evaluationData=t.data instanceof Object?t.data:{};var i=0,r=0;e.evaluationData.activity&&e.evaluationData.activity.map(function(t){var r=t.activityIndex.length,a=t.activityIndex.reduce(function(e,t){return e+t},0);a/=r||1,e.evaluationData.activity[i].activityIndex=a,i++}),e.evaluationData.giveLessons&&e.evaluationData.giveLessons.map(function(t){var i=t.giveLessonsIndex.length,a=t.giveLessonsIndex.reduce(function(e,t){return e+t},0);a/=i||1,e.evaluationData.giveLessons[r].giveLessonsIndex=a,r++})}else e.evaluationData={activity:[],giveLessons:[]}})}),angular.module("starter.userServices",[]).factory("userServices",function(e,t,i,r,a,n,o){function s(e){u.serviceUserInfo=e}function c(){return u.serviceUserInfo}function l(e,t){u.serviceUserInfo[e]=t}var u={};return u.shareUserInfo={setUserInfo:s,getUserInfo:c,updateUserInfo:l},u.findUser=function(e){var t=n.Sdata("get","get_user_basic",{},e);return t},u.addUser=function(e){console.log("config",e);var t=n.Sdata("get","add_user",e,{});return t},u.updateUndergo=function(e,t,i){return console.log(t),t.type=e,"new"==i?a.Sdata("get","updatePush_user_rRecord",t,{userId:window.userId}):a.Sdata("get","update_user_rRecord",t,{userId:window.userId})},u.getUserProInfo=function(){return a.Sdata("get","get_user_profile",{},{userId:window.userId})},u.sendNotification=function(e,t){return alert(e.circleName),a.Sdata("get","new_sysNotice",{type:"circleInvitation",circleId:e.circleId,circleName:e.circleName,from:{userId:userId,nickname:userInfo.nickname},to:{userId:t.userId,nickname:t.nickname},time:new Date,message:userInfo.nickname+" 邀请你加入圈子'"+e.circleName+"'!"},{type:"circleInvitation",circleId:e.circleId,"from.userId":userId,"to.userId":t.userId})},u.getUserBasicInfo=function(e){return e=e||window.userId,a.Sdata("get","get_user_basic",{},{userId:e})},u.deleteFriend=function(e){return a.Sdata("get","delete_friend",{friends:e},{userId:window.userId})},u.inviteMany=function(e,t){for(var i=t.length,r=0;r<i-1;r++)a.Sdata("get","new_sysNotice",{type:"circleInvitation",circleId:e.circleId,from:{userId:userId,nickname:userInfo.nickname},to:t[r],time:new Date,message:userInfo.nickname+" 邀请你加入圈子 '"+e.circleName+"'!"},{type:"circleInvitation",circleId:e.circleId,"from.userId":userId,"to.userId":t[r].userId});return a.Sdata("get","new_sysNotice",{type:"circleInvitation",circleId:e.circleId,from:{userId:userId,nickname:userInfo.nickname},to:t[r],time:new Date,message:userInfo.nickname+" 邀请你加入圈子'"+e.circleName+"'!"},{type:"circleInvitation",circleId:e.circleId,"from.userId":userId,"to.userId":t[i-1].userId})},u.defriend=function(e){return a.Sdata("get","def_friend",{"friends.$.status":"-1"},{userId:window.userId,"friends.userId":e})},u.getTrade=function(){return t.httpGet("./testData/activitySelectTypeData.json")},u.getOccupation=function(){return t.httpGet("./testData/activitySelectTypeData.json")},u.getBeGoodAt=function(){return t.httpGet("./data/beGoodAtSelectTypeData.json")},u.getInterest=function(){return t.httpGet("./data/interestSelectTypeData.json")},u.getLanguage=function(){return t.httpGet("./testData/languageSelectTypeData.json")},u.updateUserConfig=function(e){console.log(e),a.Sdata("get","update_user_info",{config:e},{userId:window.userId})},u.updateUserInfo=function(e,t,i){var r={};if("new"==i)return r[e]=t,a.Sdata("get","updatePush_user_rRecord",r,{userId:window.userId});if(""==i||void 0==i){r[e]=t;try{window.userInfo[e]=t}catch(n){console.log(n)}return a.Sdata("get","update_user_info",r,{userId:window.userId})}return delete t.$$hashKey,e=e+"."+i,r[e]=t,console.log(r[e],e),a.Sdata("get","update_user_rRecord",r,{userId:window.userId})},u.addFriends=function(e,t){return a.Sdata("get","new_sysNotice",{type:"userApplyFriend",from:{userId:window.userId,nickname:window.userInfo.nickname},to:{userId:t.userId,nickname:t.nickname},time:new Date,message:window.userInfo.nickname+" 发出好友申请!"},{type:"userApplyFriend","from.userId":window.userId,"to.userId":t.userId})},u.agreeFriendApply=function(e,t){console.log(e);var i=e.from.userId;return a.Sdata("get","new_sysNotice",{type:"agreeFriendApply",from:{userId:window.userId,nickname:window.userInfo.nickname},to:{userId:i,nickname:""},time:new Date,message:window.userInfo.nickname+" 同意你的申请!"},{type:"agreeFriendApply","from.userId":window.userId,"to.userId":i}),a.Sdata("get","update_a_sysNotice",{status:t},{id:e.id,userId:window.userId}),a.Sdata("get","add_friend",{userId:i},{userId:window.userId})},u.getFriends=function(e){return a.Sdata("get","get_friend",{},{userId:window.userId,"friends.status":{$ne:"-1"}})},u.getAllUser=function(e){var t={};return t=e?{nickname:{$regex:e||"",$options:"i"}}:{userId:window.userId},console.log(userId),a.Sdata("get","get_all_user",{userId:1,sex:1,area:1,nickname:1,headUrl:1},t)},u.partake={getActivity:function(){return a.Sdata("get","get_participate_item",{type:"activities"},{userId:window.userId})},getToHire:function(){return a.Sdata("get","get_participate_item",{type:"hires"},{userId:window.userId})},getInvestigate:function(){return a.Sdata("get","get_participate_item",{type:"investigations"},{userId:window.userId})},getInformation:function(){return a.Sdata("get","get_participate_item",{type:"informations"},{userId:window.userId})}},u.publish={getActivity:function(){return a.Sdata("get","get_u_activity",{},{userId:window.userId})},getToHire:function(){return a.Sdata("get","get_u_hire",{},{userId:window.userId})},getInvestigate:function(){return a.Sdata("get","get_u_invest",{},{userId:window.userId})},getInformation:function(){return a.Sdata("get","get_u_info",{},{userId:window.userId})}},u.getCircle=function(e){return a.Sdata("get","get_circle",{type:e},{userId:window.userId})},u.userCoupleBackSubmit=function(e){return console.log(e),e.userId=userId,e.creator=userInfo,a.Sdata("get","new_inform",e,{})},u.getFellowInfo=function(e){return a.Sdata("get","get_user_basic",{},{userId:e})},u.deleteUndergoItem=function(e,t){return console.log("删除一个"+e+"下标"+t),i({url:""})},u.getPublishData=function(e,t){return i({url:""})},u.deleteItem=function(e,t){return i({url:""})},u.getExamineAndVerify=function(e,t){return a.Sdata("get","get_activity_detail",{signUpRecord:1},{id:e,userId:window.userId})},u.getSignInPersonnel=function(e){return a.Sdata("get","get_activity_item",{type:"signInRecord"},{id:e,userId:window.userId})},u.getActivityEvaluation=function(e){return a.Sdata("get","get_activity_evaluate",{evaluationRecord:1},{id:e,userId:window.userId})},u.delActivity=function(e){return a.Sdata("get","delete_publish_item",{type:"activities"},{id:e.id,userId:window.userId})},u.delToHire=function(e){return a.Sdata("get","delete_publish_item",{type:"hires"},{id:e.id,userId:window.userId})},u.delInvestigate=function(e){return a.Sdata("get","delete_publish_item",{type:"investigations"},{id:e.id,userId:window.userId})},u.delInformation=function(e){return a.Sdata("get","delete_publish_item",{type:"informations"},{id:e.id,userId:window.userId})},u.delCircle=function(e){return a.Sdata("get","delete_publish_item",{type:"circles"},{id:e.id,userId:window.userId})},u.ask=function(e,t,i){var r=t.id,n=t.activityName,o="";return"1"==e?o="通过":"-1"==e&&(o="拒绝"),a.Sdata("get","new_sysNotice",{type:"activityApplyVerify",activityId:r,from:{userId:userId,nickname:userInfo.nickname},to:{userId:i,nickname:""},time:new Date,message:"活动"+n+"发起者"+o+"你的报名申请!"},{type:"activityApplyVerify",activityId:r,"from.userId":userId,"to.userId":i}),a.Sdata("get","update_activity_verify",{"signUpRecord.$.status":e},{id:r,"signUpRecord.userId":i})},u.getCandidates=function(e){return a.Sdata("get","get_hire_candidates",{},{id:e})},u.getpSysNotice=function(e){return a.Sdata("get","get_all_psysNotice",{"sysNotice.$":1},{userId:window.userId,"sysNotice.type":"userApplyFriend"})},u.getSysNotice=function(e){return a.Sdata("get","get_all_sysNotice",{},{"to.userId":window.userId||"undefinedUserFromTina",type:e})},u.getAnswerDetails=function(e){return a.Sdata("get","get_invest_statistics",{record:1,questions:1},{id:e})},u.getSchoolName=function(){return t.httpGet("./data/school.json",{cache:!0})},u.getSpecialty=function(){return t.httpGet("./data/specialty.json",{cache:!0})},u.startSignIn=function(e,t){var i={activityName:""};return a.Sdata("get","start_signIn",{signInStatus:t,type:"startActivitySignIn",activityId:e,from:{userId:userId,nickname:userInfo.nickname},to:{},time:new Date,message:" 你有一个活动开始签到啦 '"+i.activityName+"'!"},{type:"startActivitySignIn",activityId:e,"to.userId":""})},u.getFriendsUrl=function(){return t.httpGet("./testData/addressList.json")},u});